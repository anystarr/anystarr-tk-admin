{"version":3,"sources":["../node_modules/echarts/lib/coord/cartesian/Cartesian2D.js","../node_modules/echarts/lib/coord/cartesian/Cartesian.js","../node_modules/echarts/lib/coord/cartesian/Axis2D.js","../node_modules/echarts/lib/coord/cartesian/GridModel.js","../node_modules/echarts/lib/coord/axisModelCreator.js","../node_modules/echarts/lib/coord/axisDefault.js","../node_modules/echarts/lib/chart/bar/BarSeries.js","../node_modules/echarts/lib/chart/bar/BarView.js","../node_modules/echarts/lib/chart/bar/barItemStyle.js","../node_modules/echarts/lib/util/shape/sausage.js","../node_modules/echarts/lib/component/axis.js","../node_modules/echarts/lib/component/axis/CartesianAxisView.js","../node_modules/echarts/lib/component/axis/axisSplitHelper.js","../node_modules/echarts/lib/component/axisPointer.js","../node_modules/echarts/lib/component/axisPointer/axisTrigger.js","../node_modules/echarts/lib/component/axisPointer/AxisPointerModel.js","../node_modules/echarts/lib/component/axisPointer/AxisPointerView.js","../node_modules/echarts/lib/component/axisPointer/CartesianAxisPointer.js","../node_modules/echarts/lib/component/axisPointer/BaseAxisPointer.js","../node_modules/echarts/lib/component/tooltip/TooltipModel.js","../node_modules/echarts/lib/component/tooltip/TooltipView.js","../node_modules/echarts/lib/component/tooltip/TooltipContent.js","../node_modules/echarts/lib/component/tooltip/TooltipRichContent.js","../node_modules/echarts/lib/component/legend/LegendModel.js","../node_modules/echarts/lib/component/legend/legendAction.js","../node_modules/echarts/lib/component/legend/LegendView.js","../node_modules/echarts/lib/component/helper/listComponent.js","../node_modules/echarts/lib/component/legend/legendFilter.js","../node_modules/echarts/lib/component/tooltip.js","../node_modules/echarts/lib/component/title.js","../node_modules/echarts/lib/component/legend.js","../node_modules/echarts/lib/component/gridSimple.js","../node_modules/echarts/lib/component/axisPointer/modelHelper.js","../node_modules/echarts/lib/coord/cartesian/Grid.js","../node_modules/echarts/lib/chart/bar.js","../node_modules/echarts/lib/coord/cartesian/AxisModel.js","../node_modules/echarts/lib/chart/bar/BaseBarSeries.js","../node_modules/echarts/lib/chart/bar/helper.js","../node_modules/echarts/lib/chart/helper/labelHelper.js","../node_modules/echarts/lib/chart/helper/createClipPathFromCoordSys.js","../node_modules/echarts/lib/component/axis/AxisBuilder.js","../node_modules/echarts/lib/component/axis/AxisView.js","../node_modules/echarts/lib/coord/cartesian/cartesianAxisHelper.js","../node_modules/echarts/lib/component/axisPointer/findPointFromSeries.js","../node_modules/echarts/lib/component/axisPointer/globalListener.js","../node_modules/echarts/lib/component/axisPointer/viewHelper.js","../node_modules/echarts/lib/chart/helper/createListSimply.js","../node_modules/echarts/lib/visual/LegendVisualProvider.js","../node_modules/echarts/lib/visual/dataColor.js","../node_modules/echarts/lib/processor/dataFilter.js"],"names":["zrUtil","require","BoundingRect","Cartesian","Cartesian2D","name","call","this","prototype","constructor","type","dimensions","getBaseAxis","getAxesByScale","getAxis","containPoint","point","axisX","axisY","contain","toLocalCoord","containData","data","dataToPoint","reserved","out","xAxis","yAxis","toGlobalCoord","dataToCoord","clampData","xScale","scale","yScale","xAxisExtent","getExtent","yAxisExtent","x","parse","y","Math","min","max","pointToData","coordToData","getOtherAxis","axis","dim","getArea","xExtent","getGlobalExtent","yExtent","width","height","inherits","_default","module","exports","dimAxisMapper","_axes","_dimList","getAxes","map","scaleType","toLowerCase","filter","addAxis","push","val","_dataCoordConvert","input","method","dimList","output","Array","i","length","Axis","Axis2D","coordExtent","axisType","position","index","getAxesOnZeroOf","model","isHorizontal","asc","ret","reverse","grid","clamp","extend","dependencies","layoutMode","coordinateSystem","defaultOption","show","zlevel","z","left","top","right","bottom","containLabel","backgroundColor","borderWidth","borderColor","axisDefault","ComponentModel","_layout","getLayoutParams","mergeLayoutParam","OrdinalMeta","AXIS_TYPES","axisName","BaseAxisModelClass","axisTypeDefaulter","extraDefaultOption","each","mergeDefaultAndTheme","option","ecModel","inputPositionParams","themeModel","getTheme","merge","get","getDefaultOption","optionUpdated","__ordinalMeta","createByAxisModel","getCategories","rawData","categories","getOrdinalMeta","mergeAll","registerSubTypeDefaulter","curry","inverse","nameLocation","nameRotate","nameTruncate","maxWidth","ellipsis","placeholder","nameTextStyle","nameGap","silent","triggerEvent","tooltip","axisPointer","axisLine","onZero","onZeroAxisIndex","lineStyle","color","symbol","symbolSize","axisTick","inside","axisLabel","rotate","showMinLabel","showMaxLabel","margin","fontSize","splitLine","splitArea","areaStyle","categoryAxis","boundaryGap","deduplication","alignWithLabel","interval","valueAxis","splitNumber","minorTick","minorSplitLine","timeAxis","defaults","logAxis","logBase","brushSelector","getProgressive","getProgressiveThreshold","progressiveThreshold","largeThreshold","clip","roundCap","showBackground","backgroundStyle","borderType","borderRadius","shadowBlur","shadowColor","shadowOffsetX","shadowOffsetY","opacity","__DEV__","echarts","graphic","setLabel","Model","barItemStyle","Path","Group","throttle","createClipPath","Sausage","BAR_BORDER_WIDTH_QUERY","_eventPos","extendChartView","render","seriesModel","api","_updateDrawMode","coordinateSystemType","_isLargeDraw","_renderLarge","_renderNormal","group","incrementalPrepareRender","_clear","incrementalRender","params","_incrementalRenderLarge","isLargeDraw","pipelineContext","large","isHorizontalOrRadial","getData","oldData","_data","coord","baseAxis","animationModel","isAnimationEnabled","needsClip","coordSysClipArea","onBand","expandWidth","getLayout","getClipArea","removeClipPath","drawBackground","backgroundModel","getModel","barBorderRadius","bgEls","oldBgEls","_backgroundEls","createBackground","dataIndex","bgLayout","bgEl","layout","Sector","Rect","shape","createBackgroundShape","z2","createBackgroundEl","useStyle","getBarItemStyle","setShape","diff","add","itemModel","getItemModel","hasValue","remove","el","elementCreator","setItemGraphicEl","updateStyle","update","newIndex","oldIndex","updateProps","getItemGraphicEl","removeRect","removeSector","execute","bgGroup","_backgroundGroup","removeAll","createLarge","clipPath","setClipPath","_removeBackground","dispose","noop","eachItemGraphicEl","mathMax","mathMin","cartesian2d","coordSysBoundingRect","signWidth","signHeight","x2","y2","clipped","polar","signR","r0","r","isUpdate","rect","animateProperty","animateTarget","isRadial","clockwise","startAngle","endAngle","sector","style","text","parent","getItemLayout","fixedLineWidth","rawLayout","lineWidth","isNaN","Number","MAX_VALUE","abs","getLineWidth","signX","signY","cx","cy","isZeroOnPolar","isPolar","getItemVisual","stroke","getVisual","itemStyleModel","hoverStyle","fill","cursorStyle","getShallow","attr","labelPositionOutside","setHoverStyle","LargePath","points","buildPath","ctx","startPoint","__startPoint","baseDimIdx","__baseDimIdx","moveTo","lineTo","incremental","largeDataIndices","barWidth","backgroundStartPoint","__largeDataIndices","__barWidth","itemStyle","getItemStyle","setLargeBackgroundStyle","setLargeStyle","seriesIndex","on","largePathUpdateDataIndex","event","largePath","valueDimIdx","barWidthHalf","startValueVal","pointerBaseVal","pointerValueVal","baseLowerBound","baseUpperBound","len","ii","barBaseVal","barValueVal","largePathFindDataIndex","offsetX","offsetY","coordLayout","getRect","PI","makeStyleMapper","excludes","getBorderLineDash","lineDash","extendShape","dr","rCenter","unitStartX","cos","unitStartY","sin","unitEndX","unitEndY","arc","closePath","AxisBuilder","AxisView","cartesianAxisHelper","_axisSplitHelper","rectCoordAxisBuildSplitArea","rectCoordAxisHandleRemove","axisBuilderAttrs","selfBuilderAttrs","CartesianAxisView","axisPointerClass","axisModel","payload","oldAxisGroup","_axisGroup","gridModel","getCoordSysModel","axisBuilder","getGroup","groupTransition","superCall","_splitLine","isBlank","splitLineModel","lineStyleModel","lineColors","isArray","gridRect","lineCount","ticksCoords","getTicksCoords","tickModel","p1","p2","getLineStyle","tickCoord","colorIndex","tickValue","Line","anid","subPixelOptimize","x1","y1","_minorSplitLine","minorTicksCoords","getMinorTicksCoords","k","_splitArea","axisView","axisGroup","splitAreaModel","areaStyleModel","areaColors","areaColorsLen","lastSplitAreaColors","__splitAreaColors","newSplitAreaColors","createHashMap","cIndex","prev","getAreaStyle","set","axisPointerModelHelper","axisTrigger","registerPreprocessor","link","registerProcessor","PRIORITY","PROCESSOR","STATISTIC","getComponent","coordSysAxesInfo","collect","registerAction","makeInner","modelHelper","findPointFromSeries","inner","processOnAxis","axisInfo","newValue","updaters","dontSnap","outputFinder","involveSeries","payloadInfo","value","snapToValue","payloadBatch","minDist","minDiff","seriesModels","series","idx","seriesNestestValue","dataIndices","dataDim","mapDimension","getAxisTooltipData","result","nestestValue","indicesOfNearest","isFinite","dist","dataIndexInside","getRawIndex","buildPayloadsBySeries","snap","showPointer","showTooltip","showValueMap","key","dataByCoordSys","axisPointerModel","triggerTooltip","coordSysModel","coordSys","coordSysKey","makeKey","coordSysItem","coordSysId","id","coordSysIndex","componentIndex","coordSysType","coordSysMainType","mainType","dataByAxis","list","axisDim","axisIndex","axisId","valueLabelOpt","precision","formatter","seriesDataIndices","slice","makeMapperParam","item","illegalPoint","currTrigger","finder","dispatchAction","bind","isIllegalPoint","inputAxesInfo","axesInfo","shouldHide","coordSysMap","coordSysContainsPoint","inputAxisInfo","findInputAxisInfo","linkTriggers","tarAxisInfo","tarKey","linkGroup","srcAxisInfo","srcKey","srcValItem","mapper","outputAxesInfo","valItem","useHandle","status","updateModelActually","sampleItem","escapeConnect","tooltipOption","dispatchTooltipActually","zr","getZr","lastHighlights","newHighlights","batchItem","toHighlight","toDownplay","batch","dispatchHighDownActually","extendComponentModel","triggerOn","animation","animationDurationUpdate","shadowStyle","label","padding","handle","icon","size","globalListener","AxisPointerView","extendComponentView","globalAxisPointerModel","globalTooltipModel","register","e","indexOf","unregister","superApply","_model","arguments","BaseAxisPointer","viewHelper","CartesianAxisPointer","makeElOption","elOption","axisPointerType","otherExtent","getCartesian","pixelValue","elStyle","buildElStyle","pointerOption","pointerShapeBuilder","graphicKey","pointer","layoutInfo","buildCartesianSingleLabelElOption","getHandleTransform","labelInside","labelMargin","getTransformedPosition","rotation","labelDirection","updateHandleTransform","transform","delta","axisExtent","dimIndex","currPosition","cursorOtherValue","cursorPoint","verticalAlign","align","opt","line","makeLineShape","getAxisDimIndex","shadow","bandWidth","getBandWidth","span","makeRectShape","registerAxisPointerClass","clazzUtil","eventTool","throttleUtil","clone","moveAnimation","props","propsEqual","lastProps","newProps","isObject","equals","lastProp","stopAnimation","updateLabelShowHide","labelEl","getHandleTransProps","trans","updateMandatoryProps","traverse","_group","_lastGraphicKey","_handle","_dragging","_lastValue","_lastStatus","_payloadInfo","animationThreshold","forceRender","_axisModel","_axisPointerModel","_api","hide","clear","_moveAnimation","determineAnimation","doUpdateProps","updatePointerEl","updateLabelEl","createPointerEl","createLabelEl","_renderHandle","isCategoryAxis","useSnap","seriesDataCount","getAxisInfo","pointerEl","setStyle","isInit","handleModel","createIcon","cursor","draggable","onmousemove","stop","onmousedown","_onHandleDragMove","drift","ondragend","_onHandleDragEnd","handleSize","createOrUpdate","_moveHandleToValue","dx","dy","_doDispatchAxisPointer","doClear","buildLabel","xy","wh","xDimIndex","enableClassExtend","showContent","trigger","alwaysShowContent","displayMode","renderMode","confine","showDelay","hideDelay","transitionDuration","enterable","extraCssText","animationEasingUpdate","crossStyle","textStyle","env","TooltipContent","TooltipRichContent","formatUtil","numberUtil","layoutUtil","axisHelper","axisPointerViewHelper","getTooltipRenderMode","parsePercent","proxyRect","init","node","tooltipContent","tooltipModel","_renderMode","getDom","appendToBody","_newLine","_tooltipContent","_tooltipModel","_ecModel","_lastDataByCoordSys","_alwaysShowContent","setEnterable","_initGlobalListener","_keepShow","_tryShow","_hide","_lastX","_lastY","self","clearTimeout","_refreshUpdateTimeout","setTimeout","isDisposed","manuallyShowTip","from","uid","makeDispatchAction","_ticket","target","_manuallyAxisShowTip","pointInfo","findHover","manuallyHideTip","hideLater","getSeriesByIndex","buildTooltipModel","_showAxisTooltip","_showSeriesItemTooltip","_showComponentItemTooltip","_showOrMove","cb","delay","_showTimout","singleDefaultHTML","singleParamsList","singleTooltipModel","newLine","markers","itemCoordSys","axisValue","seriesDefaultHTML","valueLabel","getValueLabel","idxItem","dataParams","getDataParams","getAxisRawValue","axisValueLabel","html","seriesTooltip","formatTooltip","newMarkers","firstLine","join","encodeHTML","positionExpr","_updateContentNotChangedOnAxis","_updatePosition","_showTooltipContent","random","undefined","dataModel","dataType","tooltipTrigger","defaultHtml","asyncTicket","tooltipOpt","content","subTooltipModel","formatTpl","callback","cbTicket","setContent","viewWidth","getWidth","viewHeight","getHeight","contentSize","getSize","vAlign","getBoundingRect","applyTransform","viewSize","layoutRect","getLayoutRect","pos","domWidth","domHeight","rectWidth","rectHeight","calcTooltipPosition","gapH","gapV","getOuterSize","refixTooltipPosition","isCenterAlign","confineTooltipPosition","lastCoordSys","contentNotChanged","lastItemCoordSys","indexCoordSys","lastDataByAxis","thisDataByAxis","lastItem","indexAxis","thisItem","lastIndices","newIndices","lastIdxItem","j","newIdxItem","modelCascade","resultModel","pop","isInstance","zrColor","eventUtil","domUtil","toCamelCase","vendors","assembleCssText","cssText","textStyleModel","duration","transitionText","vendorPrefix","assembleTransition","canvasSupported","toHex","borderName","camelCase","getTextColor","getFont","lineHeight","round","assembleFont","normalizeCssArray","makeStyleCoord","zrX","zrY","zrPainter","painter","zrViewportRoot","getViewportRoot","transformLocalCoord","document","body","viewportRootOffset","getViewportRootOffset","offsetLeft","offsetTop","container","wxa","createElement","domBelongToZr","_zr","_appendToBody","_styleCoord","appendChild","_container","_show","_hideTimeout","onmouseenter","_enterable","_inContent","window","handler","normalizeEvent","dispatch","onmouseleave","_hideDelay","stl","currentStyle","defaultView","getComputedStyle","domStyle","_moveTooltipIfResized","ratioX","ratioY","realX","realY","styleCoord","display","innerHTML","pointerEvents","clientWidth","clientHeight","time","isShow","parentNode","removeChild","parseInt","borderLeftWidth","borderRightWidth","borderTopWidth","borderBottomWidth","Text","graphicUtil","markerRich","startId","endId","substr","textWidth","textHeight","textBorderRadius","textBackgroundColor","textOffset","setTextStyle","rich","textFill","textPadding","textLineHeight","bounding","isNameSpecified","langSelector","legend","selector","defaultSelectorOption","all","title","LegendModel","ignoreSize","parentModel","selected","_updateSelector","mergeOption","isString","_updateData","legendData","hasSelected","isSelected","select","potentialData","availableNames","eachRawSeries","isPotential","seriesName","legendVisualProvider","names","getAllNames","isSeriesFiltered","concat","_availableNames","dataItem","unSelect","toggleSelected","hasOwnProperty","allSelect","inverseSelect","getOrient","orient","itemGap","itemWidth","itemHeight","inactiveColor","inactiveBorderColor","selectedMode","selectorLabel","fontFamily","emphasis","selectorPosition","selectorItemGap","selectorButtonGap","legendSelectActionHandler","methodName","selectedMap","isToggleSelect","eachComponent","legendModel","isItemSelected","createSymbol","makeBackground","newlineDisabled","_contentGroup","_backgroundEl","_selectorGroup","_isFirstRender","getContentGroup","getSelectorGroup","isFirstRender","resetInner","itemAlign","renderInner","positionInfo","getBoxLayoutParams","viewportSize","maxSize","mainRect","layoutInner","contentGroup","legendDrawnMap","selectMode","excludeSeriesId","getSeriesByName","legendSymbolType","symbolType","_createItem","dispatchSelectAction","dispatchHighlightAction","dispatchDownplayAction","provider","containName","indexOfName","newline","_createSelector","selectorGroup","selectorItem","labelText","onclick","labelModel","emphasisLabelModel","setLabelStyle","defaultText","isRectText","createSelectorButton","symbolKeepAspect","legendModelItemStyle","itemGroup","itemIcon","legendGlobalTooltipModel","legendSymbol","setSymbolStyle","legendSymbolCenter","textX","textAlign","replace","textVerticalAlign","hitRect","invisible","formatterParams","componentType","legendIndex","$vars","eachChild","child","__legendDataIndex","box","contentRect","contentPos","selectorRect","selectorPos","orientIdx","hw","yx","dataName","storage","getDisplayList","useHoverLayer","layoutBox","positionElement","componentModel","boxLayoutParams","legendModels","findComponents","filterSeries","windowOpen","subtext","subtarget","fontWeight","subtextStyle","titleModel","subtextStyleModel","retrieve2","textEl","disableBox","textRect","subText","subTextEl","sublink","eventData","groupRect","layoutOption","alignStyle","legendFilter","Component","SERIES_FILTER","checkPropInLink","linkPropValue","axisPropValue","isHandleTrigger","seriesInvolved","linksOption","linkGroups","getCoordinateSystems","axisPointerEnabled","axesInfoInCoordSys","baseTooltipModel","saveTooltipAxisInfo","getTooltipAxes","triggerAxis","cross","tooltipAxes","baseAxes","otherAxes","fromTooltip","axisPointerShow","tooltipAxisPointerModel","volatileOption","field","labelOption","tooltipAxisPointerLabelShow","makeAxisPointerModel","groupIndex","linkOption","getLinkGroupIndex","collectAxesInfo","eachSeries","seriesTooltipTrigger","seriesTooltipShow","count","collectSeriesInfo","fixValue","extent","getAxisPointerModel","_util","retrieve","_axisHelper","createScaleByModel","ifAxisCrossZero","niceScaleExtent","estimateLabelUnionRect","CoordinateSystem","getStackedDimension","isAxisUsedInTheGrid","Grid","_coordsMap","_coordsList","_axesMap","_axesList","_initCartesian","gridProto","fixAxisOnZero","axesMap","otherAxisDim","onZeroRecords","otherAxisOnZeroOf","canOnZeroToAxis","getOnZeroRecordKey","_rect","_updateScale","resize","ignoreContainLabel","axesList","adjustAxes","setExtent","coordBase","axisExtentSum","updateAxisTransform","labelUnionRect","axesMapOnDim","xAxisIndex","yAxisIndex","coordList","getCartesians","convertToPixel","_findConvertTarget","cartesian","convertFromPixel","xAxisModel","getReferringComponents","yAxisModel","coordsList","axisPositionUsed","axesCount","createAxisCreator","axisPosition","isCategory","unionExtent","unionExtentFromData","Infinity","isCartesian2D","axesModels","findAxesModels","otherAxis","axesTypes","create","grids","_barGrid","largeLayout","registerLayout","VISUAL","LAYOUT","PROGRESSIVE_LAYOUT","registerVisual","seriesType","reset","setVisual","axisModelCreator","axisModelCommonMixin","AxisModel","resetRange","restoreData","queryComponents","gridIndex","gridId","getAxisType","extraOption","offset","SeriesModel","createListFromArray","getInitialData","getSource","useEncodeDefaulter","getMarkerPosition","pt","NaN","legendHoverLink","barMinHeight","barMinAngle","progressive","progressiveChunkMode","getDefaultLabel","fixPosition","textPosition","normalStyle","hoverLabelModel","labelFetcher","labelDataIndex","autoColor","retrieveRawValue","labelDims","vals","createGridClipPath","hasAnimation","floor","initProps","createPolarClipPath","sectorArea","_number","isRadianAroundZero","remRadian","matrixUtil","v2ApplyTransform","shouldShowAllLabels","labelOffset","nameDirection","tickDirection","dumbGroup","updateTransform","_transform","_dumbGroup","hasBuilder","builders","matrix","pt1","pt2","lineCap","strokeContainThreshold","arrows","arrowSize","arrowOffset","symbolWidth","symbolHeight","sqrt","axisTickLabel","ticksEls","tickEndCoord","createTicks","buildAxisMajorTicks","labelEls","axisLabelShow","labels","getViewLabels","labelRotation","labelRotate","labelLayout","innerTextLayout","rawCategoryData","isLabelSilent","labelItem","formattedLabel","rawLabel","itemLabelModel","textColor","makeAxisEventDataBase","targetType","decomposeTransform","buildAxisLabel","tickEls","firstLabel","nextLabel","lastLabel","prevLabel","firstTick","nextTick","lastTick","prevTick","ignoreEl","isTwoLabelOverlapped","fixMinMaxLabelShow","minorTickModel","minorTickLineStyle","minorTicksEls","buildAxisMinorTicks","axisNameAvailableWidth","gap","gapSignal","isNameLocationCenter","nameRotation","textRotate","rotationDiff","onLeft","endTextLayout","textFont","truncateOpt","nameTruncateMaxWidth","truncatedText","truncateText","minChar","__fullText","__truncatedText","axisRotation","textRotation","direction","ignore","current","next","firstRect","nextRect","mRotationBack","identity","mul","getLocalTransform","intersect","tickTransform","tickLineStyle","aniid","tickEl","_axisPointer","updateAxisPointer","force","disposeAxisPointer","Clazz","getAxisPointerClass","axisPointerClazz","clazz","rawAxisPosition","rectBound","axisOffset","posBound","onZeroCoord","modelUtil","queryDataIndex","getTooltipPosition","getValues","onLeave","record","doEnter","records","initialized","useHandler","eventType","dis","pendings","showTip","hideTip","pendingList","actuallyPayload","showLen","hideLen","dispatchTooltipFinally","initGlobalListeners","textContain","buildLabelElOption","labelPos","paddings","font","confineInContainer","bgColor","getLabel","axisDimension","seriesData","isFunction","translate","styleModel","textLayout","makeSectorShape","createDimensions","List","nameList","coordDimensions","source","dimensionsInfo","initData","getDataWithEncodedVisual","getRawData","mapArray","getName","getTargetSeries","paletteScope","seiresModelMap","eachSeriesByType","__paletteScope","dataAll","idxMap","rawIdx","filteredIdx","singleDataColor","singleDataBorderColor","getColorFromPalette","setItemVisual","filterSelf"],"mappings":"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","file":"static/js/9.2faa912b.chunk.js","sourcesContent":["\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n\nvar zrUtil = require(\"zrender/lib/core/util\");\n\nvar BoundingRect = require(\"zrender/lib/core/BoundingRect\");\n\nvar Cartesian = require(\"./Cartesian\");\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\nfunction Cartesian2D(name) {\n  Cartesian.call(this, name);\n}\n\nCartesian2D.prototype = {\n  constructor: Cartesian2D,\n  type: 'cartesian2d',\n\n  /**\n   * @type {Array.<string>}\n   * @readOnly\n   */\n  dimensions: ['x', 'y'],\n\n  /**\n   * Base axis will be used on stacking.\n   *\n   * @return {module:echarts/coord/cartesian/Axis2D}\n   */\n  getBaseAxis: function () {\n    return this.getAxesByScale('ordinal')[0] || this.getAxesByScale('time')[0] || this.getAxis('x');\n  },\n\n  /**\n   * If contain point\n   * @param {Array.<number>} point\n   * @return {boolean}\n   */\n  containPoint: function (point) {\n    var axisX = this.getAxis('x');\n    var axisY = this.getAxis('y');\n    return axisX.contain(axisX.toLocalCoord(point[0])) && axisY.contain(axisY.toLocalCoord(point[1]));\n  },\n\n  /**\n   * If contain data\n   * @param {Array.<number>} data\n   * @return {boolean}\n   */\n  containData: function (data) {\n    return this.getAxis('x').containData(data[0]) && this.getAxis('y').containData(data[1]);\n  },\n\n  /**\n   * @param {Array.<number>} data\n   * @param {Array.<number>} out\n   * @return {Array.<number>}\n   */\n  dataToPoint: function (data, reserved, out) {\n    var xAxis = this.getAxis('x');\n    var yAxis = this.getAxis('y');\n    out = out || [];\n    out[0] = xAxis.toGlobalCoord(xAxis.dataToCoord(data[0]));\n    out[1] = yAxis.toGlobalCoord(yAxis.dataToCoord(data[1]));\n    return out;\n  },\n\n  /**\n   * @param {Array.<number>} data\n   * @param {Array.<number>} out\n   * @return {Array.<number>}\n   */\n  clampData: function (data, out) {\n    var xScale = this.getAxis('x').scale;\n    var yScale = this.getAxis('y').scale;\n    var xAxisExtent = xScale.getExtent();\n    var yAxisExtent = yScale.getExtent();\n    var x = xScale.parse(data[0]);\n    var y = yScale.parse(data[1]);\n    out = out || [];\n    out[0] = Math.min(Math.max(Math.min(xAxisExtent[0], xAxisExtent[1]), x), Math.max(xAxisExtent[0], xAxisExtent[1]));\n    out[1] = Math.min(Math.max(Math.min(yAxisExtent[0], yAxisExtent[1]), y), Math.max(yAxisExtent[0], yAxisExtent[1]));\n    return out;\n  },\n\n  /**\n   * @param {Array.<number>} point\n   * @param {Array.<number>} out\n   * @return {Array.<number>}\n   */\n  pointToData: function (point, out) {\n    var xAxis = this.getAxis('x');\n    var yAxis = this.getAxis('y');\n    out = out || [];\n    out[0] = xAxis.coordToData(xAxis.toLocalCoord(point[0]));\n    out[1] = yAxis.coordToData(yAxis.toLocalCoord(point[1]));\n    return out;\n  },\n\n  /**\n   * Get other axis\n   * @param {module:echarts/coord/cartesian/Axis2D} axis\n   */\n  getOtherAxis: function (axis) {\n    return this.getAxis(axis.dim === 'x' ? 'y' : 'x');\n  },\n\n  /**\n   * Get rect area of cartesian.\n   * Area will have a contain function to determine if a point is in the coordinate system.\n   * @return {BoundingRect}\n   */\n  getArea: function () {\n    var xExtent = this.getAxis('x').getGlobalExtent();\n    var yExtent = this.getAxis('y').getGlobalExtent();\n    var x = Math.min(xExtent[0], xExtent[1]);\n    var y = Math.min(yExtent[0], yExtent[1]);\n    var width = Math.max(xExtent[0], xExtent[1]) - x;\n    var height = Math.max(yExtent[0], yExtent[1]) - y;\n    var rect = new BoundingRect(x, y, width, height);\n    return rect;\n  }\n};\nzrUtil.inherits(Cartesian2D, Cartesian);\nvar _default = Cartesian2D;\nmodule.exports = _default;","\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n\nvar zrUtil = require(\"zrender/lib/core/util\");\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n\n/**\n * Cartesian coordinate system\n * @module  echarts/coord/Cartesian\n *\n */\nfunction dimAxisMapper(dim) {\n  return this._axes[dim];\n}\n/**\n * @alias module:echarts/coord/Cartesian\n * @constructor\n */\n\n\nvar Cartesian = function (name) {\n  this._axes = {};\n  this._dimList = [];\n  /**\n   * @type {string}\n   */\n\n  this.name = name || '';\n};\n\nCartesian.prototype = {\n  constructor: Cartesian,\n  type: 'cartesian',\n\n  /**\n   * Get axis\n   * @param  {number|string} dim\n   * @return {module:echarts/coord/Cartesian~Axis}\n   */\n  getAxis: function (dim) {\n    return this._axes[dim];\n  },\n\n  /**\n   * Get axes list\n   * @return {Array.<module:echarts/coord/Cartesian~Axis>}\n   */\n  getAxes: function () {\n    return zrUtil.map(this._dimList, dimAxisMapper, this);\n  },\n\n  /**\n   * Get axes list by given scale type\n   */\n  getAxesByScale: function (scaleType) {\n    scaleType = scaleType.toLowerCase();\n    return zrUtil.filter(this.getAxes(), function (axis) {\n      return axis.scale.type === scaleType;\n    });\n  },\n\n  /**\n   * Add axis\n   * @param {module:echarts/coord/Cartesian.Axis}\n   */\n  addAxis: function (axis) {\n    var dim = axis.dim;\n    this._axes[dim] = axis;\n\n    this._dimList.push(dim);\n  },\n\n  /**\n   * Convert data to coord in nd space\n   * @param {Array.<number>|Object.<string, number>} val\n   * @return {Array.<number>|Object.<string, number>}\n   */\n  dataToCoord: function (val) {\n    return this._dataCoordConvert(val, 'dataToCoord');\n  },\n\n  /**\n   * Convert coord in nd space to data\n   * @param  {Array.<number>|Object.<string, number>} val\n   * @return {Array.<number>|Object.<string, number>}\n   */\n  coordToData: function (val) {\n    return this._dataCoordConvert(val, 'coordToData');\n  },\n  _dataCoordConvert: function (input, method) {\n    var dimList = this._dimList;\n    var output = input instanceof Array ? [] : {};\n\n    for (var i = 0; i < dimList.length; i++) {\n      var dim = dimList[i];\n      var axis = this._axes[dim];\n      output[dim] = axis[method](input[dim]);\n    }\n\n    return output;\n  }\n};\nvar _default = Cartesian;\nmodule.exports = _default;","\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n\nvar zrUtil = require(\"zrender/lib/core/util\");\n\nvar Axis = require(\"../Axis\");\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n\n/**\n * Extend axis 2d\n * @constructor module:echarts/coord/cartesian/Axis2D\n * @extends {module:echarts/coord/cartesian/Axis}\n * @param {string} dim\n * @param {*} scale\n * @param {Array.<number>} coordExtent\n * @param {string} axisType\n * @param {string} position\n */\nvar Axis2D = function (dim, scale, coordExtent, axisType, position) {\n  Axis.call(this, dim, scale, coordExtent);\n  /**\n   * Axis type\n   *  - 'category'\n   *  - 'value'\n   *  - 'time'\n   *  - 'log'\n   * @type {string}\n   */\n\n  this.type = axisType || 'value';\n  /**\n   * Axis position\n   *  - 'top'\n   *  - 'bottom'\n   *  - 'left'\n   *  - 'right'\n   */\n\n  this.position = position || 'bottom';\n};\n\nAxis2D.prototype = {\n  constructor: Axis2D,\n\n  /**\n   * Index of axis, can be used as key\n   */\n  index: 0,\n\n  /**\n   * Implemented in <module:echarts/coord/cartesian/Grid>.\n   * @return {Array.<module:echarts/coord/cartesian/Axis2D>}\n   *         If not on zero of other axis, return null/undefined.\n   *         If no axes, return an empty array.\n   */\n  getAxesOnZeroOf: null,\n\n  /**\n   * Axis model\n   * @param {module:echarts/coord/cartesian/AxisModel}\n   */\n  model: null,\n  isHorizontal: function () {\n    var position = this.position;\n    return position === 'top' || position === 'bottom';\n  },\n\n  /**\n   * Each item cooresponds to this.getExtent(), which\n   * means globalExtent[0] may greater than globalExtent[1],\n   * unless `asc` is input.\n   *\n   * @param {boolean} [asc]\n   * @return {Array.<number>}\n   */\n  getGlobalExtent: function (asc) {\n    var ret = this.getExtent();\n    ret[0] = this.toGlobalCoord(ret[0]);\n    ret[1] = this.toGlobalCoord(ret[1]);\n    asc && ret[0] > ret[1] && ret.reverse();\n    return ret;\n  },\n  getOtherAxis: function () {\n    this.grid.getOtherAxis();\n  },\n\n  /**\n   * @override\n   */\n  pointToData: function (point, clamp) {\n    return this.coordToData(this.toLocalCoord(point[this.dim === 'x' ? 0 : 1]), clamp);\n  },\n\n  /**\n   * Transform global coord to local coord,\n   * i.e. var localCoord = axis.toLocalCoord(80);\n   * designate by module:echarts/coord/cartesian/Grid.\n   * @type {Function}\n   */\n  toLocalCoord: null,\n\n  /**\n   * Transform global coord to local coord,\n   * i.e. var globalCoord = axis.toLocalCoord(40);\n   * designate by module:echarts/coord/cartesian/Grid.\n   * @type {Function}\n   */\n  toGlobalCoord: null\n};\nzrUtil.inherits(Axis2D, Axis);\nvar _default = Axis2D;\nmodule.exports = _default;","\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n\nrequire(\"./AxisModel\");\n\nvar ComponentModel = require(\"../../model/Component\");\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n// Grid 是在有直角坐标系的时候必须要存在的\n// 所以这里也要被 Cartesian2D 依赖\nvar _default = ComponentModel.extend({\n  type: 'grid',\n  dependencies: ['xAxis', 'yAxis'],\n  layoutMode: 'box',\n\n  /**\n   * @type {module:echarts/coord/cartesian/Grid}\n   */\n  coordinateSystem: null,\n  defaultOption: {\n    show: false,\n    zlevel: 0,\n    z: 0,\n    left: '10%',\n    top: 60,\n    right: '10%',\n    bottom: 60,\n    // If grid size contain label\n    containLabel: false,\n    // width: {totalWidth} - left - right,\n    // height: {totalHeight} - top - bottom,\n    backgroundColor: 'rgba(0,0,0,0)',\n    borderWidth: 1,\n    borderColor: '#ccc'\n  }\n});\n\nmodule.exports = _default;","\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n\nvar zrUtil = require(\"zrender/lib/core/util\");\n\nvar axisDefault = require(\"./axisDefault\");\n\nvar ComponentModel = require(\"../model/Component\");\n\nvar _layout = require(\"../util/layout\");\n\nvar getLayoutParams = _layout.getLayoutParams;\nvar mergeLayoutParam = _layout.mergeLayoutParam;\n\nvar OrdinalMeta = require(\"../data/OrdinalMeta\");\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n// FIXME axisType is fixed ?\nvar AXIS_TYPES = ['value', 'category', 'time', 'log'];\n/**\n * Generate sub axis model class\n * @param {string} axisName 'x' 'y' 'radius' 'angle' 'parallel'\n * @param {module:echarts/model/Component} BaseAxisModelClass\n * @param {Function} axisTypeDefaulter\n * @param {Object} [extraDefaultOption]\n */\n\nfunction _default(axisName, BaseAxisModelClass, axisTypeDefaulter, extraDefaultOption) {\n  zrUtil.each(AXIS_TYPES, function (axisType) {\n    BaseAxisModelClass.extend({\n      /**\n       * @readOnly\n       */\n      type: axisName + 'Axis.' + axisType,\n      mergeDefaultAndTheme: function (option, ecModel) {\n        var layoutMode = this.layoutMode;\n        var inputPositionParams = layoutMode ? getLayoutParams(option) : {};\n        var themeModel = ecModel.getTheme();\n        zrUtil.merge(option, themeModel.get(axisType + 'Axis'));\n        zrUtil.merge(option, this.getDefaultOption());\n        option.type = axisTypeDefaulter(axisName, option);\n\n        if (layoutMode) {\n          mergeLayoutParam(option, inputPositionParams, layoutMode);\n        }\n      },\n\n      /**\n       * @override\n       */\n      optionUpdated: function () {\n        var thisOption = this.option;\n\n        if (thisOption.type === 'category') {\n          this.__ordinalMeta = OrdinalMeta.createByAxisModel(this);\n        }\n      },\n\n      /**\n       * Should not be called before all of 'getInitailData' finished.\n       * Because categories are collected during initializing data.\n       */\n      getCategories: function (rawData) {\n        var option = this.option; // FIXME\n        // warning if called before all of 'getInitailData' finished.\n\n        if (option.type === 'category') {\n          if (rawData) {\n            return option.data;\n          }\n\n          return this.__ordinalMeta.categories;\n        }\n      },\n      getOrdinalMeta: function () {\n        return this.__ordinalMeta;\n      },\n      defaultOption: zrUtil.mergeAll([{}, axisDefault[axisType + 'Axis'], extraDefaultOption], true)\n    });\n  });\n  ComponentModel.registerSubTypeDefaulter(axisName + 'Axis', zrUtil.curry(axisTypeDefaulter, axisName));\n}\n\nmodule.exports = _default;","\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n\nvar zrUtil = require(\"zrender/lib/core/util\");\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\nvar defaultOption = {\n  show: true,\n  zlevel: 0,\n  z: 0,\n  // Inverse the axis.\n  inverse: false,\n  // Axis name displayed.\n  name: '',\n  // 'start' | 'middle' | 'end'\n  nameLocation: 'end',\n  // By degree. By default auto rotate by nameLocation.\n  nameRotate: null,\n  nameTruncate: {\n    maxWidth: null,\n    ellipsis: '...',\n    placeholder: '.'\n  },\n  // Use global text style by default.\n  nameTextStyle: {},\n  // The gap between axisName and axisLine.\n  nameGap: 15,\n  // Default `false` to support tooltip.\n  silent: false,\n  // Default `false` to avoid legacy user event listener fail.\n  triggerEvent: false,\n  tooltip: {\n    show: false\n  },\n  axisPointer: {},\n  axisLine: {\n    show: true,\n    onZero: true,\n    onZeroAxisIndex: null,\n    lineStyle: {\n      color: '#333',\n      width: 1,\n      type: 'solid'\n    },\n    // The arrow at both ends the the axis.\n    symbol: ['none', 'none'],\n    symbolSize: [10, 15]\n  },\n  axisTick: {\n    show: true,\n    // Whether axisTick is inside the grid or outside the grid.\n    inside: false,\n    // The length of axisTick.\n    length: 5,\n    lineStyle: {\n      width: 1\n    }\n  },\n  axisLabel: {\n    show: true,\n    // Whether axisLabel is inside the grid or outside the grid.\n    inside: false,\n    rotate: 0,\n    // true | false | null/undefined (auto)\n    showMinLabel: null,\n    // true | false | null/undefined (auto)\n    showMaxLabel: null,\n    margin: 8,\n    // formatter: null,\n    fontSize: 12\n  },\n  splitLine: {\n    show: true,\n    lineStyle: {\n      color: ['#ccc'],\n      width: 1,\n      type: 'solid'\n    }\n  },\n  splitArea: {\n    show: false,\n    areaStyle: {\n      color: ['rgba(250,250,250,0.3)', 'rgba(200,200,200,0.3)']\n    }\n  }\n};\nvar axisDefault = {};\naxisDefault.categoryAxis = zrUtil.merge({\n  // The gap at both ends of the axis. For categoryAxis, boolean.\n  boundaryGap: true,\n  // Set false to faster category collection.\n  // Only usefull in the case like: category is\n  // ['2012-01-01', '2012-01-02', ...], where the input\n  // data has been ensured not duplicate and is large data.\n  // null means \"auto\":\n  // if axis.data provided, do not deduplication,\n  // else do deduplication.\n  deduplication: null,\n  // splitArea: {\n  // show: false\n  // },\n  splitLine: {\n    show: false\n  },\n  axisTick: {\n    // If tick is align with label when boundaryGap is true\n    alignWithLabel: false,\n    interval: 'auto'\n  },\n  axisLabel: {\n    interval: 'auto'\n  }\n}, defaultOption);\naxisDefault.valueAxis = zrUtil.merge({\n  // The gap at both ends of the axis. For value axis, [GAP, GAP], where\n  // `GAP` can be an absolute pixel number (like `35`), or percent (like `'30%'`)\n  boundaryGap: [0, 0],\n  // TODO\n  // min/max: [30, datamin, 60] or [20, datamin] or [datamin, 60]\n  // Min value of the axis. can be:\n  // + a number\n  // + 'dataMin': use the min value in data.\n  // + null/undefined: auto decide min value (consider pretty look and boundaryGap).\n  // min: null,\n  // Max value of the axis. can be:\n  // + a number\n  // + 'dataMax': use the max value in data.\n  // + null/undefined: auto decide max value (consider pretty look and boundaryGap).\n  // max: null,\n  // Readonly prop, specifies start value of the range when using data zoom.\n  // rangeStart: null\n  // Readonly prop, specifies end value of the range when using data zoom.\n  // rangeEnd: null\n  // Optional value can be:\n  // + `false`: always include value 0.\n  // + `true`: the extent do not consider value 0.\n  // scale: false,\n  // AxisTick and axisLabel and splitLine are caculated based on splitNumber.\n  splitNumber: 5,\n  // Interval specifies the span of the ticks is mandatorily.\n  // interval: null\n  // Specify min interval when auto calculate tick interval.\n  // minInterval: null\n  // Specify max interval when auto calculate tick interval.\n  // maxInterval: null\n  minorTick: {\n    // Minor tick, not available for cateogry axis.\n    show: false,\n    // Split number of minor ticks. The value should be in range of (0, 100)\n    splitNumber: 5,\n    // Lenght of minor tick\n    length: 3,\n    // Same inside with axisTick\n    // Line style\n    lineStyle: {// Default to be same with axisTick\n    }\n  },\n  minorSplitLine: {\n    show: false,\n    lineStyle: {\n      color: '#eee',\n      width: 1\n    }\n  }\n}, defaultOption);\naxisDefault.timeAxis = zrUtil.defaults({\n  scale: true,\n  min: 'dataMin',\n  max: 'dataMax'\n}, axisDefault.valueAxis);\naxisDefault.logAxis = zrUtil.defaults({\n  scale: true,\n  logBase: 10\n}, axisDefault.valueAxis);\nvar _default = axisDefault;\nmodule.exports = _default;","\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n\nvar BaseBarSeries = require(\"./BaseBarSeries\");\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\nvar _default = BaseBarSeries.extend({\n  type: 'series.bar',\n  dependencies: ['grid', 'polar'],\n  brushSelector: 'rect',\n\n  /**\n   * @override\n   */\n  getProgressive: function () {\n    // Do not support progressive in normal mode.\n    return this.get('large') ? this.get('progressive') : false;\n  },\n\n  /**\n   * @override\n   */\n  getProgressiveThreshold: function () {\n    // Do not support progressive in normal mode.\n    var progressiveThreshold = this.get('progressiveThreshold');\n    var largeThreshold = this.get('largeThreshold');\n\n    if (largeThreshold > progressiveThreshold) {\n      progressiveThreshold = largeThreshold;\n    }\n\n    return progressiveThreshold;\n  },\n  defaultOption: {\n    // If clipped\n    // Only available on cartesian2d\n    clip: true,\n    // If use caps on two sides of bars\n    // Only available on tangential polar bar\n    roundCap: false,\n    showBackground: false,\n    backgroundStyle: {\n      color: 'rgba(180, 180, 180, 0.2)',\n      borderColor: null,\n      borderWidth: 0,\n      borderType: 'solid',\n      borderRadius: 0,\n      shadowBlur: 0,\n      shadowColor: null,\n      shadowOffsetX: 0,\n      shadowOffsetY: 0,\n      opacity: 1\n    }\n  }\n});\n\nmodule.exports = _default;","\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n\nvar _config = require(\"../../config\");\n\nvar __DEV__ = _config.__DEV__;\n\nvar echarts = require(\"../../echarts\");\n\nvar zrUtil = require(\"zrender/lib/core/util\");\n\nvar graphic = require(\"../../util/graphic\");\n\nvar _helper = require(\"./helper\");\n\nvar setLabel = _helper.setLabel;\n\nvar Model = require(\"../../model/Model\");\n\nvar barItemStyle = require(\"./barItemStyle\");\n\nvar Path = require(\"zrender/lib/graphic/Path\");\n\nvar Group = require(\"zrender/lib/container/Group\");\n\nvar _throttle = require(\"../../util/throttle\");\n\nvar throttle = _throttle.throttle;\n\nvar _createClipPathFromCoordSys = require(\"../helper/createClipPathFromCoordSys\");\n\nvar createClipPath = _createClipPathFromCoordSys.createClipPath;\n\nvar Sausage = require(\"../../util/shape/sausage\");\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\nvar BAR_BORDER_WIDTH_QUERY = ['itemStyle', 'barBorderWidth'];\nvar _eventPos = [0, 0]; // FIXME\n// Just for compatible with ec2.\n\nzrUtil.extend(Model.prototype, barItemStyle);\n\nfunction getClipArea(coord, data) {\n  var coordSysClipArea = coord.getArea && coord.getArea();\n\n  if (coord.type === 'cartesian2d') {\n    var baseAxis = coord.getBaseAxis(); // When boundaryGap is false or using time axis. bar may exceed the grid.\n    // We should not clip this part.\n    // See test/bar2.html\n\n    if (baseAxis.type !== 'category' || !baseAxis.onBand) {\n      var expandWidth = data.getLayout('bandWidth');\n\n      if (baseAxis.isHorizontal()) {\n        coordSysClipArea.x -= expandWidth;\n        coordSysClipArea.width += expandWidth * 2;\n      } else {\n        coordSysClipArea.y -= expandWidth;\n        coordSysClipArea.height += expandWidth * 2;\n      }\n    }\n  }\n\n  return coordSysClipArea;\n}\n\nvar _default = echarts.extendChartView({\n  type: 'bar',\n  render: function (seriesModel, ecModel, api) {\n    this._updateDrawMode(seriesModel);\n\n    var coordinateSystemType = seriesModel.get('coordinateSystem');\n\n    if (coordinateSystemType === 'cartesian2d' || coordinateSystemType === 'polar') {\n      this._isLargeDraw ? this._renderLarge(seriesModel, ecModel, api) : this._renderNormal(seriesModel, ecModel, api);\n    } else {}\n\n    return this.group;\n  },\n  incrementalPrepareRender: function (seriesModel, ecModel, api) {\n    this._clear();\n\n    this._updateDrawMode(seriesModel);\n  },\n  incrementalRender: function (params, seriesModel, ecModel, api) {\n    // Do not support progressive in normal mode.\n    this._incrementalRenderLarge(params, seriesModel);\n  },\n  _updateDrawMode: function (seriesModel) {\n    var isLargeDraw = seriesModel.pipelineContext.large;\n\n    if (this._isLargeDraw == null || isLargeDraw ^ this._isLargeDraw) {\n      this._isLargeDraw = isLargeDraw;\n\n      this._clear();\n    }\n  },\n  _renderNormal: function (seriesModel, ecModel, api) {\n    var group = this.group;\n    var data = seriesModel.getData();\n    var oldData = this._data;\n    var coord = seriesModel.coordinateSystem;\n    var baseAxis = coord.getBaseAxis();\n    var isHorizontalOrRadial;\n\n    if (coord.type === 'cartesian2d') {\n      isHorizontalOrRadial = baseAxis.isHorizontal();\n    } else if (coord.type === 'polar') {\n      isHorizontalOrRadial = baseAxis.dim === 'angle';\n    }\n\n    var animationModel = seriesModel.isAnimationEnabled() ? seriesModel : null;\n    var needsClip = seriesModel.get('clip', true);\n    var coordSysClipArea = getClipArea(coord, data); // If there is clipPath created in large mode. Remove it.\n\n    group.removeClipPath(); // We don't use clipPath in normal mode because we needs a perfect animation\n    // And don't want the label are clipped.\n\n    var roundCap = seriesModel.get('roundCap', true);\n    var drawBackground = seriesModel.get('showBackground', true);\n    var backgroundModel = seriesModel.getModel('backgroundStyle');\n    var barBorderRadius = backgroundModel.get('barBorderRadius') || 0;\n    var bgEls = [];\n    var oldBgEls = this._backgroundEls || [];\n\n    var createBackground = function (dataIndex) {\n      var bgLayout = getLayout[coord.type](data, dataIndex);\n      var bgEl = createBackgroundEl(coord, isHorizontalOrRadial, bgLayout);\n      bgEl.useStyle(backgroundModel.getBarItemStyle()); // Only cartesian2d support borderRadius.\n\n      if (coord.type === 'cartesian2d') {\n        bgEl.setShape('r', barBorderRadius);\n      }\n\n      bgEls[dataIndex] = bgEl;\n      return bgEl;\n    };\n\n    data.diff(oldData).add(function (dataIndex) {\n      var itemModel = data.getItemModel(dataIndex);\n      var layout = getLayout[coord.type](data, dataIndex, itemModel);\n\n      if (drawBackground) {\n        createBackground(dataIndex);\n      } // If dataZoom in filteMode: 'empty', the baseValue can be set as NaN in \"axisProxy\".\n\n\n      if (!data.hasValue(dataIndex)) {\n        return;\n      }\n\n      if (needsClip) {\n        // Clip will modify the layout params.\n        // And return a boolean to determine if the shape are fully clipped.\n        var isClipped = clip[coord.type](coordSysClipArea, layout);\n\n        if (isClipped) {\n          group.remove(el);\n          return;\n        }\n      }\n\n      var el = elementCreator[coord.type](dataIndex, layout, isHorizontalOrRadial, animationModel, false, roundCap);\n      data.setItemGraphicEl(dataIndex, el);\n      group.add(el);\n      updateStyle(el, data, dataIndex, itemModel, layout, seriesModel, isHorizontalOrRadial, coord.type === 'polar');\n    }).update(function (newIndex, oldIndex) {\n      var itemModel = data.getItemModel(newIndex);\n      var layout = getLayout[coord.type](data, newIndex, itemModel);\n\n      if (drawBackground) {\n        var bgEl;\n\n        if (oldBgEls.length === 0) {\n          bgEl = createBackground(oldIndex);\n        } else {\n          bgEl = oldBgEls[oldIndex];\n          bgEl.useStyle(backgroundModel.getBarItemStyle()); // Only cartesian2d support borderRadius.\n\n          if (coord.type === 'cartesian2d') {\n            bgEl.setShape('r', barBorderRadius);\n          }\n\n          bgEls[newIndex] = bgEl;\n        }\n\n        var bgLayout = getLayout[coord.type](data, newIndex);\n        var shape = createBackgroundShape(isHorizontalOrRadial, bgLayout, coord);\n        graphic.updateProps(bgEl, {\n          shape: shape\n        }, animationModel, newIndex);\n      }\n\n      var el = oldData.getItemGraphicEl(oldIndex);\n\n      if (!data.hasValue(newIndex)) {\n        group.remove(el);\n        return;\n      }\n\n      if (needsClip) {\n        var isClipped = clip[coord.type](coordSysClipArea, layout);\n\n        if (isClipped) {\n          group.remove(el);\n          return;\n        }\n      }\n\n      if (el) {\n        graphic.updateProps(el, {\n          shape: layout\n        }, animationModel, newIndex);\n      } else {\n        el = elementCreator[coord.type](newIndex, layout, isHorizontalOrRadial, animationModel, true, roundCap);\n      }\n\n      data.setItemGraphicEl(newIndex, el); // Add back\n\n      group.add(el);\n      updateStyle(el, data, newIndex, itemModel, layout, seriesModel, isHorizontalOrRadial, coord.type === 'polar');\n    }).remove(function (dataIndex) {\n      var el = oldData.getItemGraphicEl(dataIndex);\n\n      if (coord.type === 'cartesian2d') {\n        el && removeRect(dataIndex, animationModel, el);\n      } else {\n        el && removeSector(dataIndex, animationModel, el);\n      }\n    }).execute();\n    var bgGroup = this._backgroundGroup || (this._backgroundGroup = new Group());\n    bgGroup.removeAll();\n\n    for (var i = 0; i < bgEls.length; ++i) {\n      bgGroup.add(bgEls[i]);\n    }\n\n    group.add(bgGroup);\n    this._backgroundEls = bgEls;\n    this._data = data;\n  },\n  _renderLarge: function (seriesModel, ecModel, api) {\n    this._clear();\n\n    createLarge(seriesModel, this.group); // Use clipPath in large mode.\n\n    var clipPath = seriesModel.get('clip', true) ? createClipPath(seriesModel.coordinateSystem, false, seriesModel) : null;\n\n    if (clipPath) {\n      this.group.setClipPath(clipPath);\n    } else {\n      this.group.removeClipPath();\n    }\n  },\n  _incrementalRenderLarge: function (params, seriesModel) {\n    this._removeBackground();\n\n    createLarge(seriesModel, this.group, true);\n  },\n  dispose: zrUtil.noop,\n  remove: function (ecModel) {\n    this._clear(ecModel);\n  },\n  _clear: function (ecModel) {\n    var group = this.group;\n    var data = this._data;\n\n    if (ecModel && ecModel.get('animation') && data && !this._isLargeDraw) {\n      this._removeBackground();\n\n      this._backgroundEls = [];\n      data.eachItemGraphicEl(function (el) {\n        if (el.type === 'sector') {\n          removeSector(el.dataIndex, ecModel, el);\n        } else {\n          removeRect(el.dataIndex, ecModel, el);\n        }\n      });\n    } else {\n      group.removeAll();\n    }\n\n    this._data = null;\n  },\n  _removeBackground: function () {\n    this.group.remove(this._backgroundGroup);\n    this._backgroundGroup = null;\n  }\n});\n\nvar mathMax = Math.max;\nvar mathMin = Math.min;\nvar clip = {\n  cartesian2d: function (coordSysBoundingRect, layout) {\n    var signWidth = layout.width < 0 ? -1 : 1;\n    var signHeight = layout.height < 0 ? -1 : 1; // Needs positive width and height\n\n    if (signWidth < 0) {\n      layout.x += layout.width;\n      layout.width = -layout.width;\n    }\n\n    if (signHeight < 0) {\n      layout.y += layout.height;\n      layout.height = -layout.height;\n    }\n\n    var x = mathMax(layout.x, coordSysBoundingRect.x);\n    var x2 = mathMin(layout.x + layout.width, coordSysBoundingRect.x + coordSysBoundingRect.width);\n    var y = mathMax(layout.y, coordSysBoundingRect.y);\n    var y2 = mathMin(layout.y + layout.height, coordSysBoundingRect.y + coordSysBoundingRect.height);\n    layout.x = x;\n    layout.y = y;\n    layout.width = x2 - x;\n    layout.height = y2 - y;\n    var clipped = layout.width < 0 || layout.height < 0; // Reverse back\n\n    if (signWidth < 0) {\n      layout.x += layout.width;\n      layout.width = -layout.width;\n    }\n\n    if (signHeight < 0) {\n      layout.y += layout.height;\n      layout.height = -layout.height;\n    }\n\n    return clipped;\n  },\n  polar: function (coordSysClipArea, layout) {\n    var signR = layout.r0 <= layout.r ? 1 : -1; // Make sure r is larger than r0\n\n    if (signR < 0) {\n      var r = layout.r;\n      layout.r = layout.r0;\n      layout.r0 = r;\n    }\n\n    var r = mathMin(layout.r, coordSysClipArea.r);\n    var r0 = mathMax(layout.r0, coordSysClipArea.r0);\n    layout.r = r;\n    layout.r0 = r0;\n    var clipped = r - r0 < 0; // Reverse back\n\n    if (signR < 0) {\n      var r = layout.r;\n      layout.r = layout.r0;\n      layout.r0 = r;\n    }\n\n    return clipped;\n  }\n};\nvar elementCreator = {\n  cartesian2d: function (dataIndex, layout, isHorizontal, animationModel, isUpdate) {\n    var rect = new graphic.Rect({\n      shape: zrUtil.extend({}, layout),\n      z2: 1\n    });\n    rect.name = 'item'; // Animation\n\n    if (animationModel) {\n      var rectShape = rect.shape;\n      var animateProperty = isHorizontal ? 'height' : 'width';\n      var animateTarget = {};\n      rectShape[animateProperty] = 0;\n      animateTarget[animateProperty] = layout[animateProperty];\n      graphic[isUpdate ? 'updateProps' : 'initProps'](rect, {\n        shape: animateTarget\n      }, animationModel, dataIndex);\n    }\n\n    return rect;\n  },\n  polar: function (dataIndex, layout, isRadial, animationModel, isUpdate, roundCap) {\n    // Keep the same logic with bar in catesion: use end value to control\n    // direction. Notice that if clockwise is true (by default), the sector\n    // will always draw clockwisely, no matter whether endAngle is greater\n    // or less than startAngle.\n    var clockwise = layout.startAngle < layout.endAngle;\n    var ShapeClass = !isRadial && roundCap ? Sausage : graphic.Sector;\n    var sector = new ShapeClass({\n      shape: zrUtil.defaults({\n        clockwise: clockwise\n      }, layout),\n      z2: 1\n    });\n    sector.name = 'item'; // Animation\n\n    if (animationModel) {\n      var sectorShape = sector.shape;\n      var animateProperty = isRadial ? 'r' : 'endAngle';\n      var animateTarget = {};\n      sectorShape[animateProperty] = isRadial ? 0 : layout.startAngle;\n      animateTarget[animateProperty] = layout[animateProperty];\n      graphic[isUpdate ? 'updateProps' : 'initProps'](sector, {\n        shape: animateTarget\n      }, animationModel, dataIndex);\n    }\n\n    return sector;\n  }\n};\n\nfunction removeRect(dataIndex, animationModel, el) {\n  // Not show text when animating\n  el.style.text = null;\n  graphic.updateProps(el, {\n    shape: {\n      width: 0\n    }\n  }, animationModel, dataIndex, function () {\n    el.parent && el.parent.remove(el);\n  });\n}\n\nfunction removeSector(dataIndex, animationModel, el) {\n  // Not show text when animating\n  el.style.text = null;\n  graphic.updateProps(el, {\n    shape: {\n      r: el.shape.r0\n    }\n  }, animationModel, dataIndex, function () {\n    el.parent && el.parent.remove(el);\n  });\n}\n\nvar getLayout = {\n  // itemModel is only used to get borderWidth, which is not needed\n  // when calculating bar background layout.\n  cartesian2d: function (data, dataIndex, itemModel) {\n    var layout = data.getItemLayout(dataIndex);\n    var fixedLineWidth = itemModel ? getLineWidth(itemModel, layout) : 0; // fix layout with lineWidth\n\n    var signX = layout.width > 0 ? 1 : -1;\n    var signY = layout.height > 0 ? 1 : -1;\n    return {\n      x: layout.x + signX * fixedLineWidth / 2,\n      y: layout.y + signY * fixedLineWidth / 2,\n      width: layout.width - signX * fixedLineWidth,\n      height: layout.height - signY * fixedLineWidth\n    };\n  },\n  polar: function (data, dataIndex, itemModel) {\n    var layout = data.getItemLayout(dataIndex);\n    return {\n      cx: layout.cx,\n      cy: layout.cy,\n      r0: layout.r0,\n      r: layout.r,\n      startAngle: layout.startAngle,\n      endAngle: layout.endAngle\n    };\n  }\n};\n\nfunction isZeroOnPolar(layout) {\n  return layout.startAngle != null && layout.endAngle != null && layout.startAngle === layout.endAngle;\n}\n\nfunction updateStyle(el, data, dataIndex, itemModel, layout, seriesModel, isHorizontal, isPolar) {\n  var color = data.getItemVisual(dataIndex, 'color');\n  var opacity = data.getItemVisual(dataIndex, 'opacity');\n  var stroke = data.getVisual('borderColor');\n  var itemStyleModel = itemModel.getModel('itemStyle');\n  var hoverStyle = itemModel.getModel('emphasis.itemStyle').getBarItemStyle();\n\n  if (!isPolar) {\n    el.setShape('r', itemStyleModel.get('barBorderRadius') || 0);\n  }\n\n  el.useStyle(zrUtil.defaults({\n    stroke: isZeroOnPolar(layout) ? 'none' : stroke,\n    fill: isZeroOnPolar(layout) ? 'none' : color,\n    opacity: opacity\n  }, itemStyleModel.getBarItemStyle()));\n  var cursorStyle = itemModel.getShallow('cursor');\n  cursorStyle && el.attr('cursor', cursorStyle);\n  var labelPositionOutside = isHorizontal ? layout.height > 0 ? 'bottom' : 'top' : layout.width > 0 ? 'left' : 'right';\n\n  if (!isPolar) {\n    setLabel(el.style, hoverStyle, itemModel, color, seriesModel, dataIndex, labelPositionOutside);\n  }\n\n  if (isZeroOnPolar(layout)) {\n    hoverStyle.fill = hoverStyle.stroke = 'none';\n  }\n\n  graphic.setHoverStyle(el, hoverStyle);\n} // In case width or height are too small.\n\n\nfunction getLineWidth(itemModel, rawLayout) {\n  var lineWidth = itemModel.get(BAR_BORDER_WIDTH_QUERY) || 0; // width or height may be NaN for empty data\n\n  var width = isNaN(rawLayout.width) ? Number.MAX_VALUE : Math.abs(rawLayout.width);\n  var height = isNaN(rawLayout.height) ? Number.MAX_VALUE : Math.abs(rawLayout.height);\n  return Math.min(lineWidth, width, height);\n}\n\nvar LargePath = Path.extend({\n  type: 'largeBar',\n  shape: {\n    points: []\n  },\n  buildPath: function (ctx, shape) {\n    // Drawing lines is more efficient than drawing\n    // a whole line or drawing rects.\n    var points = shape.points;\n    var startPoint = this.__startPoint;\n    var baseDimIdx = this.__baseDimIdx;\n\n    for (var i = 0; i < points.length; i += 2) {\n      startPoint[baseDimIdx] = points[i + baseDimIdx];\n      ctx.moveTo(startPoint[0], startPoint[1]);\n      ctx.lineTo(points[i], points[i + 1]);\n    }\n  }\n});\n\nfunction createLarge(seriesModel, group, incremental) {\n  // TODO support polar\n  var data = seriesModel.getData();\n  var startPoint = [];\n  var baseDimIdx = data.getLayout('valueAxisHorizontal') ? 1 : 0;\n  startPoint[1 - baseDimIdx] = data.getLayout('valueAxisStart');\n  var largeDataIndices = data.getLayout('largeDataIndices');\n  var barWidth = data.getLayout('barWidth');\n  var backgroundModel = seriesModel.getModel('backgroundStyle');\n  var drawBackground = seriesModel.get('showBackground', true);\n\n  if (drawBackground) {\n    var points = data.getLayout('largeBackgroundPoints');\n    var backgroundStartPoint = [];\n    backgroundStartPoint[1 - baseDimIdx] = data.getLayout('backgroundStart');\n    var bgEl = new LargePath({\n      shape: {\n        points: points\n      },\n      incremental: !!incremental,\n      __startPoint: backgroundStartPoint,\n      __baseDimIdx: baseDimIdx,\n      __largeDataIndices: largeDataIndices,\n      __barWidth: barWidth,\n      silent: true,\n      z2: 0\n    });\n    setLargeBackgroundStyle(bgEl, backgroundModel, data);\n    group.add(bgEl);\n  }\n\n  var el = new LargePath({\n    shape: {\n      points: data.getLayout('largePoints')\n    },\n    incremental: !!incremental,\n    __startPoint: startPoint,\n    __baseDimIdx: baseDimIdx,\n    __largeDataIndices: largeDataIndices,\n    __barWidth: barWidth\n  });\n  group.add(el);\n  setLargeStyle(el, seriesModel, data); // Enable tooltip and user mouse/touch event handlers.\n\n  el.seriesIndex = seriesModel.seriesIndex;\n\n  if (!seriesModel.get('silent')) {\n    el.on('mousedown', largePathUpdateDataIndex);\n    el.on('mousemove', largePathUpdateDataIndex);\n  }\n} // Use throttle to avoid frequently traverse to find dataIndex.\n\n\nvar largePathUpdateDataIndex = throttle(function (event) {\n  var largePath = this;\n  var dataIndex = largePathFindDataIndex(largePath, event.offsetX, event.offsetY);\n  largePath.dataIndex = dataIndex >= 0 ? dataIndex : null;\n}, 30, false);\n\nfunction largePathFindDataIndex(largePath, x, y) {\n  var baseDimIdx = largePath.__baseDimIdx;\n  var valueDimIdx = 1 - baseDimIdx;\n  var points = largePath.shape.points;\n  var largeDataIndices = largePath.__largeDataIndices;\n  var barWidthHalf = Math.abs(largePath.__barWidth / 2);\n  var startValueVal = largePath.__startPoint[valueDimIdx];\n  _eventPos[0] = x;\n  _eventPos[1] = y;\n  var pointerBaseVal = _eventPos[baseDimIdx];\n  var pointerValueVal = _eventPos[1 - baseDimIdx];\n  var baseLowerBound = pointerBaseVal - barWidthHalf;\n  var baseUpperBound = pointerBaseVal + barWidthHalf;\n\n  for (var i = 0, len = points.length / 2; i < len; i++) {\n    var ii = i * 2;\n    var barBaseVal = points[ii + baseDimIdx];\n    var barValueVal = points[ii + valueDimIdx];\n\n    if (barBaseVal >= baseLowerBound && barBaseVal <= baseUpperBound && (startValueVal <= barValueVal ? pointerValueVal >= startValueVal && pointerValueVal <= barValueVal : pointerValueVal >= barValueVal && pointerValueVal <= startValueVal)) {\n      return largeDataIndices[i];\n    }\n  }\n\n  return -1;\n}\n\nfunction setLargeStyle(el, seriesModel, data) {\n  var borderColor = data.getVisual('borderColor') || data.getVisual('color');\n  var itemStyle = seriesModel.getModel('itemStyle').getItemStyle(['color', 'borderColor']);\n  el.useStyle(itemStyle);\n  el.style.fill = null;\n  el.style.stroke = borderColor;\n  el.style.lineWidth = data.getLayout('barWidth');\n}\n\nfunction setLargeBackgroundStyle(el, backgroundModel, data) {\n  var borderColor = backgroundModel.get('borderColor') || backgroundModel.get('color');\n  var itemStyle = backgroundModel.getItemStyle(['color', 'borderColor']);\n  el.useStyle(itemStyle);\n  el.style.fill = null;\n  el.style.stroke = borderColor;\n  el.style.lineWidth = data.getLayout('barWidth');\n}\n\nfunction createBackgroundShape(isHorizontalOrRadial, layout, coord) {\n  var coordLayout;\n  var isPolar = coord.type === 'polar';\n\n  if (isPolar) {\n    coordLayout = coord.getArea();\n  } else {\n    coordLayout = coord.grid.getRect();\n  }\n\n  if (isPolar) {\n    return {\n      cx: coordLayout.cx,\n      cy: coordLayout.cy,\n      r0: isHorizontalOrRadial ? coordLayout.r0 : layout.r0,\n      r: isHorizontalOrRadial ? coordLayout.r : layout.r,\n      startAngle: isHorizontalOrRadial ? layout.startAngle : 0,\n      endAngle: isHorizontalOrRadial ? layout.endAngle : Math.PI * 2\n    };\n  } else {\n    return {\n      x: isHorizontalOrRadial ? layout.x : coordLayout.x,\n      y: isHorizontalOrRadial ? coordLayout.y : layout.y,\n      width: isHorizontalOrRadial ? layout.width : coordLayout.width,\n      height: isHorizontalOrRadial ? coordLayout.height : layout.height\n    };\n  }\n}\n\nfunction createBackgroundEl(coord, isHorizontalOrRadial, layout) {\n  var ElementClz = coord.type === 'polar' ? graphic.Sector : graphic.Rect;\n  return new ElementClz({\n    shape: createBackgroundShape(isHorizontalOrRadial, layout, coord),\n    silent: true,\n    z2: 0\n  });\n}\n\nmodule.exports = _default;","\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n\nvar makeStyleMapper = require(\"../../model/mixin/makeStyleMapper\");\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\nvar getBarItemStyle = makeStyleMapper([['fill', 'color'], ['stroke', 'borderColor'], ['lineWidth', 'borderWidth'], // Compatitable with 2\n['stroke', 'barBorderColor'], ['lineWidth', 'barBorderWidth'], ['opacity'], ['shadowBlur'], ['shadowOffsetX'], ['shadowOffsetY'], ['shadowColor']]);\nvar _default = {\n  getBarItemStyle: function (excludes) {\n    var style = getBarItemStyle(this, excludes);\n\n    if (this.getBorderLineDash) {\n      var lineDash = this.getBorderLineDash();\n      lineDash && (style.lineDash = lineDash);\n    }\n\n    return style;\n  }\n};\nmodule.exports = _default;","\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n\nvar _graphic = require(\"../graphic\");\n\nvar extendShape = _graphic.extendShape;\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n\n/**\n * Sausage: similar to sector, but have half circle on both sides\n * @public\n */\nvar _default = extendShape({\n  type: 'sausage',\n  shape: {\n    cx: 0,\n    cy: 0,\n    r0: 0,\n    r: 0,\n    startAngle: 0,\n    endAngle: Math.PI * 2,\n    clockwise: true\n  },\n  buildPath: function (ctx, shape) {\n    var x = shape.cx;\n    var y = shape.cy;\n    var r0 = Math.max(shape.r0 || 0, 0);\n    var r = Math.max(shape.r, 0);\n    var dr = (r - r0) * 0.5;\n    var rCenter = r0 + dr;\n    var startAngle = shape.startAngle;\n    var endAngle = shape.endAngle;\n    var clockwise = shape.clockwise;\n    var unitStartX = Math.cos(startAngle);\n    var unitStartY = Math.sin(startAngle);\n    var unitEndX = Math.cos(endAngle);\n    var unitEndY = Math.sin(endAngle);\n    var lessThanCircle = clockwise ? endAngle - startAngle < Math.PI * 2 : startAngle - endAngle < Math.PI * 2;\n\n    if (lessThanCircle) {\n      ctx.moveTo(unitStartX * r0 + x, unitStartY * r0 + y);\n      ctx.arc(unitStartX * rCenter + x, unitStartY * rCenter + y, dr, -Math.PI + startAngle, startAngle, !clockwise);\n    }\n\n    ctx.arc(x, y, r, startAngle, endAngle, !clockwise);\n    ctx.moveTo(unitEndX * r + x, unitEndY * r + y);\n    ctx.arc(unitEndX * rCenter + x, unitEndY * rCenter + y, dr, endAngle - Math.PI * 2, endAngle - Math.PI, !clockwise);\n\n    if (r0 !== 0) {\n      ctx.arc(x, y, r0, endAngle, startAngle, clockwise);\n      ctx.moveTo(unitStartX * r0 + x, unitEndY * r0 + y);\n    }\n\n    ctx.closePath();\n  }\n});\n\nmodule.exports = _default;","\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n\nrequire(\"../coord/cartesian/AxisModel\");\n\nrequire(\"./axis/CartesianAxisView\");","\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n\nvar zrUtil = require(\"zrender/lib/core/util\");\n\nvar graphic = require(\"../../util/graphic\");\n\nvar AxisBuilder = require(\"./AxisBuilder\");\n\nvar AxisView = require(\"./AxisView\");\n\nvar cartesianAxisHelper = require(\"../../coord/cartesian/cartesianAxisHelper\");\n\nvar _axisSplitHelper = require(\"./axisSplitHelper\");\n\nvar rectCoordAxisBuildSplitArea = _axisSplitHelper.rectCoordAxisBuildSplitArea;\nvar rectCoordAxisHandleRemove = _axisSplitHelper.rectCoordAxisHandleRemove;\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\nvar axisBuilderAttrs = ['axisLine', 'axisTickLabel', 'axisName'];\nvar selfBuilderAttrs = ['splitArea', 'splitLine', 'minorSplitLine'];\nvar CartesianAxisView = AxisView.extend({\n  type: 'cartesianAxis',\n  axisPointerClass: 'CartesianAxisPointer',\n\n  /**\n   * @override\n   */\n  render: function (axisModel, ecModel, api, payload) {\n    this.group.removeAll();\n    var oldAxisGroup = this._axisGroup;\n    this._axisGroup = new graphic.Group();\n    this.group.add(this._axisGroup);\n\n    if (!axisModel.get('show')) {\n      return;\n    }\n\n    var gridModel = axisModel.getCoordSysModel();\n    var layout = cartesianAxisHelper.layout(gridModel, axisModel);\n    var axisBuilder = new AxisBuilder(axisModel, layout);\n    zrUtil.each(axisBuilderAttrs, axisBuilder.add, axisBuilder);\n\n    this._axisGroup.add(axisBuilder.getGroup());\n\n    zrUtil.each(selfBuilderAttrs, function (name) {\n      if (axisModel.get(name + '.show')) {\n        this['_' + name](axisModel, gridModel);\n      }\n    }, this);\n    graphic.groupTransition(oldAxisGroup, this._axisGroup, axisModel);\n    CartesianAxisView.superCall(this, 'render', axisModel, ecModel, api, payload);\n  },\n  remove: function () {\n    rectCoordAxisHandleRemove(this);\n  },\n\n  /**\n   * @param {module:echarts/coord/cartesian/AxisModel} axisModel\n   * @param {module:echarts/coord/cartesian/GridModel} gridModel\n   * @private\n   */\n  _splitLine: function (axisModel, gridModel) {\n    var axis = axisModel.axis;\n\n    if (axis.scale.isBlank()) {\n      return;\n    }\n\n    var splitLineModel = axisModel.getModel('splitLine');\n    var lineStyleModel = splitLineModel.getModel('lineStyle');\n    var lineColors = lineStyleModel.get('color');\n    lineColors = zrUtil.isArray(lineColors) ? lineColors : [lineColors];\n    var gridRect = gridModel.coordinateSystem.getRect();\n    var isHorizontal = axis.isHorizontal();\n    var lineCount = 0;\n    var ticksCoords = axis.getTicksCoords({\n      tickModel: splitLineModel\n    });\n    var p1 = [];\n    var p2 = [];\n    var lineStyle = lineStyleModel.getLineStyle();\n\n    for (var i = 0; i < ticksCoords.length; i++) {\n      var tickCoord = axis.toGlobalCoord(ticksCoords[i].coord);\n\n      if (isHorizontal) {\n        p1[0] = tickCoord;\n        p1[1] = gridRect.y;\n        p2[0] = tickCoord;\n        p2[1] = gridRect.y + gridRect.height;\n      } else {\n        p1[0] = gridRect.x;\n        p1[1] = tickCoord;\n        p2[0] = gridRect.x + gridRect.width;\n        p2[1] = tickCoord;\n      }\n\n      var colorIndex = lineCount++ % lineColors.length;\n      var tickValue = ticksCoords[i].tickValue;\n\n      this._axisGroup.add(new graphic.Line({\n        anid: tickValue != null ? 'line_' + ticksCoords[i].tickValue : null,\n        subPixelOptimize: true,\n        shape: {\n          x1: p1[0],\n          y1: p1[1],\n          x2: p2[0],\n          y2: p2[1]\n        },\n        style: zrUtil.defaults({\n          stroke: lineColors[colorIndex]\n        }, lineStyle),\n        silent: true\n      }));\n    }\n  },\n\n  /**\n   * @param {module:echarts/coord/cartesian/AxisModel} axisModel\n   * @param {module:echarts/coord/cartesian/GridModel} gridModel\n   * @private\n   */\n  _minorSplitLine: function (axisModel, gridModel) {\n    var axis = axisModel.axis;\n    var minorSplitLineModel = axisModel.getModel('minorSplitLine');\n    var lineStyleModel = minorSplitLineModel.getModel('lineStyle');\n    var gridRect = gridModel.coordinateSystem.getRect();\n    var isHorizontal = axis.isHorizontal();\n    var minorTicksCoords = axis.getMinorTicksCoords();\n\n    if (!minorTicksCoords.length) {\n      return;\n    }\n\n    var p1 = [];\n    var p2 = [];\n    var lineStyle = lineStyleModel.getLineStyle();\n\n    for (var i = 0; i < minorTicksCoords.length; i++) {\n      for (var k = 0; k < minorTicksCoords[i].length; k++) {\n        var tickCoord = axis.toGlobalCoord(minorTicksCoords[i][k].coord);\n\n        if (isHorizontal) {\n          p1[0] = tickCoord;\n          p1[1] = gridRect.y;\n          p2[0] = tickCoord;\n          p2[1] = gridRect.y + gridRect.height;\n        } else {\n          p1[0] = gridRect.x;\n          p1[1] = tickCoord;\n          p2[0] = gridRect.x + gridRect.width;\n          p2[1] = tickCoord;\n        }\n\n        this._axisGroup.add(new graphic.Line({\n          anid: 'minor_line_' + minorTicksCoords[i][k].tickValue,\n          subPixelOptimize: true,\n          shape: {\n            x1: p1[0],\n            y1: p1[1],\n            x2: p2[0],\n            y2: p2[1]\n          },\n          style: lineStyle,\n          silent: true\n        }));\n      }\n    }\n  },\n\n  /**\n   * @param {module:echarts/coord/cartesian/AxisModel} axisModel\n   * @param {module:echarts/coord/cartesian/GridModel} gridModel\n   * @private\n   */\n  _splitArea: function (axisModel, gridModel) {\n    rectCoordAxisBuildSplitArea(this, this._axisGroup, axisModel, gridModel);\n  }\n});\nCartesianAxisView.extend({\n  type: 'xAxis'\n});\nCartesianAxisView.extend({\n  type: 'yAxis'\n});","\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n\nvar zrUtil = require(\"zrender/lib/core/util\");\n\nvar graphic = require(\"../../util/graphic\");\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\nfunction rectCoordAxisBuildSplitArea(axisView, axisGroup, axisModel, gridModel) {\n  var axis = axisModel.axis;\n\n  if (axis.scale.isBlank()) {\n    return;\n  }\n\n  var splitAreaModel = axisModel.getModel('splitArea');\n  var areaStyleModel = splitAreaModel.getModel('areaStyle');\n  var areaColors = areaStyleModel.get('color');\n  var gridRect = gridModel.coordinateSystem.getRect();\n  var ticksCoords = axis.getTicksCoords({\n    tickModel: splitAreaModel,\n    clamp: true\n  });\n\n  if (!ticksCoords.length) {\n    return;\n  } // For Making appropriate splitArea animation, the color and anid\n  // should be corresponding to previous one if possible.\n\n\n  var areaColorsLen = areaColors.length;\n  var lastSplitAreaColors = axisView.__splitAreaColors;\n  var newSplitAreaColors = zrUtil.createHashMap();\n  var colorIndex = 0;\n\n  if (lastSplitAreaColors) {\n    for (var i = 0; i < ticksCoords.length; i++) {\n      var cIndex = lastSplitAreaColors.get(ticksCoords[i].tickValue);\n\n      if (cIndex != null) {\n        colorIndex = (cIndex + (areaColorsLen - 1) * i) % areaColorsLen;\n        break;\n      }\n    }\n  }\n\n  var prev = axis.toGlobalCoord(ticksCoords[0].coord);\n  var areaStyle = areaStyleModel.getAreaStyle();\n  areaColors = zrUtil.isArray(areaColors) ? areaColors : [areaColors];\n\n  for (var i = 1; i < ticksCoords.length; i++) {\n    var tickCoord = axis.toGlobalCoord(ticksCoords[i].coord);\n    var x;\n    var y;\n    var width;\n    var height;\n\n    if (axis.isHorizontal()) {\n      x = prev;\n      y = gridRect.y;\n      width = tickCoord - x;\n      height = gridRect.height;\n      prev = x + width;\n    } else {\n      x = gridRect.x;\n      y = prev;\n      width = gridRect.width;\n      height = tickCoord - y;\n      prev = y + height;\n    }\n\n    var tickValue = ticksCoords[i - 1].tickValue;\n    tickValue != null && newSplitAreaColors.set(tickValue, colorIndex);\n    axisGroup.add(new graphic.Rect({\n      anid: tickValue != null ? 'area_' + tickValue : null,\n      shape: {\n        x: x,\n        y: y,\n        width: width,\n        height: height\n      },\n      style: zrUtil.defaults({\n        fill: areaColors[colorIndex]\n      }, areaStyle),\n      silent: true\n    }));\n    colorIndex = (colorIndex + 1) % areaColorsLen;\n  }\n\n  axisView.__splitAreaColors = newSplitAreaColors;\n}\n\nfunction rectCoordAxisHandleRemove(axisView) {\n  axisView.__splitAreaColors = null;\n}\n\nexports.rectCoordAxisBuildSplitArea = rectCoordAxisBuildSplitArea;\nexports.rectCoordAxisHandleRemove = rectCoordAxisHandleRemove;","\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n\nvar echarts = require(\"../echarts\");\n\nvar zrUtil = require(\"zrender/lib/core/util\");\n\nvar axisPointerModelHelper = require(\"./axisPointer/modelHelper\");\n\nvar axisTrigger = require(\"./axisPointer/axisTrigger\");\n\nrequire(\"./axisPointer/AxisPointerModel\");\n\nrequire(\"./axisPointer/AxisPointerView\");\n\nrequire(\"./axisPointer/CartesianAxisPointer\");\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n// CartesianAxisPointer is not supposed to be required here. But consider\n// echarts.simple.js and online build tooltip, which only require gridSimple,\n// CartesianAxisPointer should be able to required somewhere.\necharts.registerPreprocessor(function (option) {\n  // Always has a global axisPointerModel for default setting.\n  if (option) {\n    (!option.axisPointer || option.axisPointer.length === 0) && (option.axisPointer = {});\n    var link = option.axisPointer.link; // Normalize to array to avoid object mergin. But if link\n    // is not set, remain null/undefined, otherwise it will\n    // override existent link setting.\n\n    if (link && !zrUtil.isArray(link)) {\n      option.axisPointer.link = [link];\n    }\n  }\n}); // This process should proformed after coordinate systems created\n// and series data processed. So put it on statistic processing stage.\n\necharts.registerProcessor(echarts.PRIORITY.PROCESSOR.STATISTIC, function (ecModel, api) {\n  // Build axisPointerModel, mergin tooltip.axisPointer model for each axis.\n  // allAxesInfo should be updated when setOption performed.\n  ecModel.getComponent('axisPointer').coordSysAxesInfo = axisPointerModelHelper.collect(ecModel, api);\n}); // Broadcast to all views.\n\necharts.registerAction({\n  type: 'updateAxisPointer',\n  event: 'updateAxisPointer',\n  update: ':updateAxisPointer'\n}, axisTrigger);","\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n\nvar zrUtil = require(\"zrender/lib/core/util\");\n\nvar _model = require(\"../../util/model\");\n\nvar makeInner = _model.makeInner;\n\nvar modelHelper = require(\"./modelHelper\");\n\nvar findPointFromSeries = require(\"./findPointFromSeries\");\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\nvar each = zrUtil.each;\nvar curry = zrUtil.curry;\nvar inner = makeInner();\n/**\n * Basic logic: check all axis, if they do not demand show/highlight,\n * then hide/downplay them.\n *\n * @param {Object} coordSysAxesInfo\n * @param {Object} payload\n * @param {string} [payload.currTrigger] 'click' | 'mousemove' | 'leave'\n * @param {Array.<number>} [payload.x] x and y, which are mandatory, specify a point to\n *              trigger axisPointer and tooltip.\n * @param {Array.<number>} [payload.y] x and y, which are mandatory, specify a point to\n *              trigger axisPointer and tooltip.\n * @param {Object} [payload.seriesIndex] finder, optional, restrict target axes.\n * @param {Object} [payload.dataIndex] finder, restrict target axes.\n * @param {Object} [payload.axesInfo] finder, restrict target axes.\n *        [{\n *          axisDim: 'x'|'y'|'angle'|...,\n *          axisIndex: ...,\n *          value: ...\n *        }, ...]\n * @param {Function} [payload.dispatchAction]\n * @param {Object} [payload.tooltipOption]\n * @param {Object|Array.<number>|Function} [payload.position] Tooltip position,\n *        which can be specified in dispatchAction\n * @param {module:echarts/model/Global} ecModel\n * @param {module:echarts/ExtensionAPI} api\n * @return {Object} content of event obj for echarts.connect.\n */\n\nfunction _default(payload, ecModel, api) {\n  var currTrigger = payload.currTrigger;\n  var point = [payload.x, payload.y];\n  var finder = payload;\n  var dispatchAction = payload.dispatchAction || zrUtil.bind(api.dispatchAction, api);\n  var coordSysAxesInfo = ecModel.getComponent('axisPointer').coordSysAxesInfo; // Pending\n  // See #6121. But we are not able to reproduce it yet.\n\n  if (!coordSysAxesInfo) {\n    return;\n  }\n\n  if (illegalPoint(point)) {\n    // Used in the default behavior of `connection`: use the sample seriesIndex\n    // and dataIndex. And also used in the tooltipView trigger.\n    point = findPointFromSeries({\n      seriesIndex: finder.seriesIndex,\n      // Do not use dataIndexInside from other ec instance.\n      // FIXME: auto detect it?\n      dataIndex: finder.dataIndex\n    }, ecModel).point;\n  }\n\n  var isIllegalPoint = illegalPoint(point); // Axis and value can be specified when calling dispatchAction({type: 'updateAxisPointer'}).\n  // Notice: In this case, it is difficult to get the `point` (which is necessary to show\n  // tooltip, so if point is not given, we just use the point found by sample seriesIndex\n  // and dataIndex.\n\n  var inputAxesInfo = finder.axesInfo;\n  var axesInfo = coordSysAxesInfo.axesInfo;\n  var shouldHide = currTrigger === 'leave' || illegalPoint(point);\n  var outputFinder = {};\n  var showValueMap = {};\n  var dataByCoordSys = {\n    list: [],\n    map: {}\n  };\n  var updaters = {\n    showPointer: curry(showPointer, showValueMap),\n    showTooltip: curry(showTooltip, dataByCoordSys)\n  }; // Process for triggered axes.\n\n  each(coordSysAxesInfo.coordSysMap, function (coordSys, coordSysKey) {\n    // If a point given, it must be contained by the coordinate system.\n    var coordSysContainsPoint = isIllegalPoint || coordSys.containPoint(point);\n    each(coordSysAxesInfo.coordSysAxesInfo[coordSysKey], function (axisInfo, key) {\n      var axis = axisInfo.axis;\n      var inputAxisInfo = findInputAxisInfo(inputAxesInfo, axisInfo); // If no inputAxesInfo, no axis is restricted.\n\n      if (!shouldHide && coordSysContainsPoint && (!inputAxesInfo || inputAxisInfo)) {\n        var val = inputAxisInfo && inputAxisInfo.value;\n\n        if (val == null && !isIllegalPoint) {\n          val = axis.pointToData(point);\n        }\n\n        val != null && processOnAxis(axisInfo, val, updaters, false, outputFinder);\n      }\n    });\n  }); // Process for linked axes.\n\n  var linkTriggers = {};\n  each(axesInfo, function (tarAxisInfo, tarKey) {\n    var linkGroup = tarAxisInfo.linkGroup; // If axis has been triggered in the previous stage, it should not be triggered by link.\n\n    if (linkGroup && !showValueMap[tarKey]) {\n      each(linkGroup.axesInfo, function (srcAxisInfo, srcKey) {\n        var srcValItem = showValueMap[srcKey]; // If srcValItem exist, source axis is triggered, so link to target axis.\n\n        if (srcAxisInfo !== tarAxisInfo && srcValItem) {\n          var val = srcValItem.value;\n          linkGroup.mapper && (val = tarAxisInfo.axis.scale.parse(linkGroup.mapper(val, makeMapperParam(srcAxisInfo), makeMapperParam(tarAxisInfo))));\n          linkTriggers[tarAxisInfo.key] = val;\n        }\n      });\n    }\n  });\n  each(linkTriggers, function (val, tarKey) {\n    processOnAxis(axesInfo[tarKey], val, updaters, true, outputFinder);\n  });\n  updateModelActually(showValueMap, axesInfo, outputFinder);\n  dispatchTooltipActually(dataByCoordSys, point, payload, dispatchAction);\n  dispatchHighDownActually(axesInfo, dispatchAction, api);\n  return outputFinder;\n}\n\nfunction processOnAxis(axisInfo, newValue, updaters, dontSnap, outputFinder) {\n  var axis = axisInfo.axis;\n\n  if (axis.scale.isBlank() || !axis.containData(newValue)) {\n    return;\n  }\n\n  if (!axisInfo.involveSeries) {\n    updaters.showPointer(axisInfo, newValue);\n    return;\n  } // Heavy calculation. So put it after axis.containData checking.\n\n\n  var payloadInfo = buildPayloadsBySeries(newValue, axisInfo);\n  var payloadBatch = payloadInfo.payloadBatch;\n  var snapToValue = payloadInfo.snapToValue; // Fill content of event obj for echarts.connect.\n  // By default use the first involved series data as a sample to connect.\n\n  if (payloadBatch[0] && outputFinder.seriesIndex == null) {\n    zrUtil.extend(outputFinder, payloadBatch[0]);\n  } // If no linkSource input, this process is for collecting link\n  // target, where snap should not be accepted.\n\n\n  if (!dontSnap && axisInfo.snap) {\n    if (axis.containData(snapToValue) && snapToValue != null) {\n      newValue = snapToValue;\n    }\n  }\n\n  updaters.showPointer(axisInfo, newValue, payloadBatch, outputFinder); // Tooltip should always be snapToValue, otherwise there will be\n  // incorrect \"axis value ~ series value\" mapping displayed in tooltip.\n\n  updaters.showTooltip(axisInfo, payloadInfo, snapToValue);\n}\n\nfunction buildPayloadsBySeries(value, axisInfo) {\n  var axis = axisInfo.axis;\n  var dim = axis.dim;\n  var snapToValue = value;\n  var payloadBatch = [];\n  var minDist = Number.MAX_VALUE;\n  var minDiff = -1;\n  each(axisInfo.seriesModels, function (series, idx) {\n    var dataDim = series.getData().mapDimension(dim, true);\n    var seriesNestestValue;\n    var dataIndices;\n\n    if (series.getAxisTooltipData) {\n      var result = series.getAxisTooltipData(dataDim, value, axis);\n      dataIndices = result.dataIndices;\n      seriesNestestValue = result.nestestValue;\n    } else {\n      dataIndices = series.getData().indicesOfNearest(dataDim[0], value, // Add a threshold to avoid find the wrong dataIndex\n      // when data length is not same.\n      // false,\n      axis.type === 'category' ? 0.5 : null);\n\n      if (!dataIndices.length) {\n        return;\n      }\n\n      seriesNestestValue = series.getData().get(dataDim[0], dataIndices[0]);\n    }\n\n    if (seriesNestestValue == null || !isFinite(seriesNestestValue)) {\n      return;\n    }\n\n    var diff = value - seriesNestestValue;\n    var dist = Math.abs(diff); // Consider category case\n\n    if (dist <= minDist) {\n      if (dist < minDist || diff >= 0 && minDiff < 0) {\n        minDist = dist;\n        minDiff = diff;\n        snapToValue = seriesNestestValue;\n        payloadBatch.length = 0;\n      }\n\n      each(dataIndices, function (dataIndex) {\n        payloadBatch.push({\n          seriesIndex: series.seriesIndex,\n          dataIndexInside: dataIndex,\n          dataIndex: series.getData().getRawIndex(dataIndex)\n        });\n      });\n    }\n  });\n  return {\n    payloadBatch: payloadBatch,\n    snapToValue: snapToValue\n  };\n}\n\nfunction showPointer(showValueMap, axisInfo, value, payloadBatch) {\n  showValueMap[axisInfo.key] = {\n    value: value,\n    payloadBatch: payloadBatch\n  };\n}\n\nfunction showTooltip(dataByCoordSys, axisInfo, payloadInfo, value) {\n  var payloadBatch = payloadInfo.payloadBatch;\n  var axis = axisInfo.axis;\n  var axisModel = axis.model;\n  var axisPointerModel = axisInfo.axisPointerModel; // If no data, do not create anything in dataByCoordSys,\n  // whose length will be used to judge whether dispatch action.\n\n  if (!axisInfo.triggerTooltip || !payloadBatch.length) {\n    return;\n  }\n\n  var coordSysModel = axisInfo.coordSys.model;\n  var coordSysKey = modelHelper.makeKey(coordSysModel);\n  var coordSysItem = dataByCoordSys.map[coordSysKey];\n\n  if (!coordSysItem) {\n    coordSysItem = dataByCoordSys.map[coordSysKey] = {\n      coordSysId: coordSysModel.id,\n      coordSysIndex: coordSysModel.componentIndex,\n      coordSysType: coordSysModel.type,\n      coordSysMainType: coordSysModel.mainType,\n      dataByAxis: []\n    };\n    dataByCoordSys.list.push(coordSysItem);\n  }\n\n  coordSysItem.dataByAxis.push({\n    axisDim: axis.dim,\n    axisIndex: axisModel.componentIndex,\n    axisType: axisModel.type,\n    axisId: axisModel.id,\n    value: value,\n    // Caustion: viewHelper.getValueLabel is actually on \"view stage\", which\n    // depends that all models have been updated. So it should not be performed\n    // here. Considering axisPointerModel used here is volatile, which is hard\n    // to be retrieve in TooltipView, we prepare parameters here.\n    valueLabelOpt: {\n      precision: axisPointerModel.get('label.precision'),\n      formatter: axisPointerModel.get('label.formatter')\n    },\n    seriesDataIndices: payloadBatch.slice()\n  });\n}\n\nfunction updateModelActually(showValueMap, axesInfo, outputFinder) {\n  var outputAxesInfo = outputFinder.axesInfo = []; // Basic logic: If no 'show' required, 'hide' this axisPointer.\n\n  each(axesInfo, function (axisInfo, key) {\n    var option = axisInfo.axisPointerModel.option;\n    var valItem = showValueMap[key];\n\n    if (valItem) {\n      !axisInfo.useHandle && (option.status = 'show');\n      option.value = valItem.value; // For label formatter param and highlight.\n\n      option.seriesDataIndices = (valItem.payloadBatch || []).slice();\n    } // When always show (e.g., handle used), remain\n    // original value and status.\n    else {\n        // If hide, value still need to be set, consider\n        // click legend to toggle axis blank.\n        !axisInfo.useHandle && (option.status = 'hide');\n      } // If status is 'hide', should be no info in payload.\n\n\n    option.status === 'show' && outputAxesInfo.push({\n      axisDim: axisInfo.axis.dim,\n      axisIndex: axisInfo.axis.model.componentIndex,\n      value: option.value\n    });\n  });\n}\n\nfunction dispatchTooltipActually(dataByCoordSys, point, payload, dispatchAction) {\n  // Basic logic: If no showTip required, hideTip will be dispatched.\n  if (illegalPoint(point) || !dataByCoordSys.list.length) {\n    dispatchAction({\n      type: 'hideTip'\n    });\n    return;\n  } // In most case only one axis (or event one series is used). It is\n  // convinient to fetch payload.seriesIndex and payload.dataIndex\n  // dirtectly. So put the first seriesIndex and dataIndex of the first\n  // axis on the payload.\n\n\n  var sampleItem = ((dataByCoordSys.list[0].dataByAxis[0] || {}).seriesDataIndices || [])[0] || {};\n  dispatchAction({\n    type: 'showTip',\n    escapeConnect: true,\n    x: point[0],\n    y: point[1],\n    tooltipOption: payload.tooltipOption,\n    position: payload.position,\n    dataIndexInside: sampleItem.dataIndexInside,\n    dataIndex: sampleItem.dataIndex,\n    seriesIndex: sampleItem.seriesIndex,\n    dataByCoordSys: dataByCoordSys.list\n  });\n}\n\nfunction dispatchHighDownActually(axesInfo, dispatchAction, api) {\n  // FIXME\n  // highlight status modification shoule be a stage of main process?\n  // (Consider confilct (e.g., legend and axisPointer) and setOption)\n  var zr = api.getZr();\n  var highDownKey = 'axisPointerLastHighlights';\n  var lastHighlights = inner(zr)[highDownKey] || {};\n  var newHighlights = inner(zr)[highDownKey] = {}; // Update highlight/downplay status according to axisPointer model.\n  // Build hash map and remove duplicate incidentally.\n\n  each(axesInfo, function (axisInfo, key) {\n    var option = axisInfo.axisPointerModel.option;\n    option.status === 'show' && each(option.seriesDataIndices, function (batchItem) {\n      var key = batchItem.seriesIndex + ' | ' + batchItem.dataIndex;\n      newHighlights[key] = batchItem;\n    });\n  }); // Diff.\n\n  var toHighlight = [];\n  var toDownplay = [];\n  zrUtil.each(lastHighlights, function (batchItem, key) {\n    !newHighlights[key] && toDownplay.push(batchItem);\n  });\n  zrUtil.each(newHighlights, function (batchItem, key) {\n    !lastHighlights[key] && toHighlight.push(batchItem);\n  });\n  toDownplay.length && api.dispatchAction({\n    type: 'downplay',\n    escapeConnect: true,\n    batch: toDownplay\n  });\n  toHighlight.length && api.dispatchAction({\n    type: 'highlight',\n    escapeConnect: true,\n    batch: toHighlight\n  });\n}\n\nfunction findInputAxisInfo(inputAxesInfo, axisInfo) {\n  for (var i = 0; i < (inputAxesInfo || []).length; i++) {\n    var inputAxisInfo = inputAxesInfo[i];\n\n    if (axisInfo.axis.dim === inputAxisInfo.axisDim && axisInfo.axis.model.componentIndex === inputAxisInfo.axisIndex) {\n      return inputAxisInfo;\n    }\n  }\n}\n\nfunction makeMapperParam(axisInfo) {\n  var axisModel = axisInfo.axis.model;\n  var item = {};\n  var dim = item.axisDim = axisInfo.axis.dim;\n  item.axisIndex = item[dim + 'AxisIndex'] = axisModel.componentIndex;\n  item.axisName = item[dim + 'AxisName'] = axisModel.name;\n  item.axisId = item[dim + 'AxisId'] = axisModel.id;\n  return item;\n}\n\nfunction illegalPoint(point) {\n  return !point || point[0] == null || isNaN(point[0]) || point[1] == null || isNaN(point[1]);\n}\n\nmodule.exports = _default;","\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n\nvar echarts = require(\"../../echarts\");\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\nvar AxisPointerModel = echarts.extendComponentModel({\n  type: 'axisPointer',\n  coordSysAxesInfo: null,\n  defaultOption: {\n    // 'auto' means that show when triggered by tooltip or handle.\n    show: 'auto',\n    // 'click' | 'mousemove' | 'none'\n    triggerOn: null,\n    // set default in AxisPonterView.js\n    zlevel: 0,\n    z: 50,\n    type: 'line',\n    // 'line' 'shadow' 'cross' 'none'.\n    // axispointer triggered by tootip determine snap automatically,\n    // see `modelHelper`.\n    snap: false,\n    triggerTooltip: true,\n    value: null,\n    status: null,\n    // Init value depends on whether handle is used.\n    // [group0, group1, ...]\n    // Each group can be: {\n    //      mapper: function () {},\n    //      singleTooltip: 'multiple',  // 'multiple' or 'single'\n    //      xAxisId: ...,\n    //      yAxisName: ...,\n    //      angleAxisIndex: ...\n    // }\n    // mapper: can be ignored.\n    //      input: {axisInfo, value}\n    //      output: {axisInfo, value}\n    link: [],\n    // Do not set 'auto' here, otherwise global animation: false\n    // will not effect at this axispointer.\n    animation: null,\n    animationDurationUpdate: 200,\n    lineStyle: {\n      color: '#aaa',\n      width: 1,\n      type: 'solid'\n    },\n    shadowStyle: {\n      color: 'rgba(150,150,150,0.3)'\n    },\n    label: {\n      show: true,\n      formatter: null,\n      // string | Function\n      precision: 'auto',\n      // Or a number like 0, 1, 2 ...\n      margin: 3,\n      color: '#fff',\n      padding: [5, 7, 5, 7],\n      backgroundColor: 'auto',\n      // default: axis line color\n      borderColor: null,\n      borderWidth: 0,\n      shadowBlur: 3,\n      shadowColor: '#aaa' // Considering applicability, common style should\n      // better not have shadowOffset.\n      // shadowOffsetX: 0,\n      // shadowOffsetY: 2\n\n    },\n    handle: {\n      show: false,\n\n      /* eslint-disable */\n      icon: 'M10.7,11.9v-1.3H9.3v1.3c-4.9,0.3-8.8,4.4-8.8,9.4c0,5,3.9,9.1,8.8,9.4h1.3c4.9-0.3,8.8-4.4,8.8-9.4C19.5,16.3,15.6,12.2,10.7,11.9z M13.3,24.4H6.7v-1.2h6.6z M13.3,22H6.7v-1.2h6.6z M13.3,19.6H6.7v-1.2h6.6z',\n      // jshint ignore:line\n\n      /* eslint-enable */\n      size: 45,\n      // handle margin is from symbol center to axis, which is stable when circular move.\n      margin: 50,\n      // color: '#1b8bbd'\n      // color: '#2f4554'\n      color: '#333',\n      shadowBlur: 3,\n      shadowColor: '#aaa',\n      shadowOffsetX: 0,\n      shadowOffsetY: 2,\n      // For mobile performance\n      throttle: 40\n    }\n  }\n});\nvar _default = AxisPointerModel;\nmodule.exports = _default;","\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n\nvar echarts = require(\"../../echarts\");\n\nvar globalListener = require(\"./globalListener\");\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\nvar AxisPointerView = echarts.extendComponentView({\n  type: 'axisPointer',\n  render: function (globalAxisPointerModel, ecModel, api) {\n    var globalTooltipModel = ecModel.getComponent('tooltip');\n    var triggerOn = globalAxisPointerModel.get('triggerOn') || globalTooltipModel && globalTooltipModel.get('triggerOn') || 'mousemove|click'; // Register global listener in AxisPointerView to enable\n    // AxisPointerView to be independent to Tooltip.\n\n    globalListener.register('axisPointer', api, function (currTrigger, e, dispatchAction) {\n      // If 'none', it is not controlled by mouse totally.\n      if (triggerOn !== 'none' && (currTrigger === 'leave' || triggerOn.indexOf(currTrigger) >= 0)) {\n        dispatchAction({\n          type: 'updateAxisPointer',\n          currTrigger: currTrigger,\n          x: e && e.offsetX,\n          y: e && e.offsetY\n        });\n      }\n    });\n  },\n\n  /**\n   * @override\n   */\n  remove: function (ecModel, api) {\n    globalListener.unregister(api.getZr(), 'axisPointer');\n    AxisPointerView.superApply(this._model, 'remove', arguments);\n  },\n\n  /**\n   * @override\n   */\n  dispose: function (ecModel, api) {\n    globalListener.unregister('axisPointer', api);\n    AxisPointerView.superApply(this._model, 'dispose', arguments);\n  }\n});\nvar _default = AxisPointerView;\nmodule.exports = _default;","\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n\nvar BaseAxisPointer = require(\"./BaseAxisPointer\");\n\nvar viewHelper = require(\"./viewHelper\");\n\nvar cartesianAxisHelper = require(\"../../coord/cartesian/cartesianAxisHelper\");\n\nvar AxisView = require(\"../axis/AxisView\");\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\nvar CartesianAxisPointer = BaseAxisPointer.extend({\n  /**\n   * @override\n   */\n  makeElOption: function (elOption, value, axisModel, axisPointerModel, api) {\n    var axis = axisModel.axis;\n    var grid = axis.grid;\n    var axisPointerType = axisPointerModel.get('type');\n    var otherExtent = getCartesian(grid, axis).getOtherAxis(axis).getGlobalExtent();\n    var pixelValue = axis.toGlobalCoord(axis.dataToCoord(value, true));\n\n    if (axisPointerType && axisPointerType !== 'none') {\n      var elStyle = viewHelper.buildElStyle(axisPointerModel);\n      var pointerOption = pointerShapeBuilder[axisPointerType](axis, pixelValue, otherExtent);\n      pointerOption.style = elStyle;\n      elOption.graphicKey = pointerOption.type;\n      elOption.pointer = pointerOption;\n    }\n\n    var layoutInfo = cartesianAxisHelper.layout(grid.model, axisModel);\n    viewHelper.buildCartesianSingleLabelElOption(value, elOption, layoutInfo, axisModel, axisPointerModel, api);\n  },\n\n  /**\n   * @override\n   */\n  getHandleTransform: function (value, axisModel, axisPointerModel) {\n    var layoutInfo = cartesianAxisHelper.layout(axisModel.axis.grid.model, axisModel, {\n      labelInside: false\n    });\n    layoutInfo.labelMargin = axisPointerModel.get('handle.margin');\n    return {\n      position: viewHelper.getTransformedPosition(axisModel.axis, value, layoutInfo),\n      rotation: layoutInfo.rotation + (layoutInfo.labelDirection < 0 ? Math.PI : 0)\n    };\n  },\n\n  /**\n   * @override\n   */\n  updateHandleTransform: function (transform, delta, axisModel, axisPointerModel) {\n    var axis = axisModel.axis;\n    var grid = axis.grid;\n    var axisExtent = axis.getGlobalExtent(true);\n    var otherExtent = getCartesian(grid, axis).getOtherAxis(axis).getGlobalExtent();\n    var dimIndex = axis.dim === 'x' ? 0 : 1;\n    var currPosition = transform.position;\n    currPosition[dimIndex] += delta[dimIndex];\n    currPosition[dimIndex] = Math.min(axisExtent[1], currPosition[dimIndex]);\n    currPosition[dimIndex] = Math.max(axisExtent[0], currPosition[dimIndex]);\n    var cursorOtherValue = (otherExtent[1] + otherExtent[0]) / 2;\n    var cursorPoint = [cursorOtherValue, cursorOtherValue];\n    cursorPoint[dimIndex] = currPosition[dimIndex]; // Make tooltip do not overlap axisPointer and in the middle of the grid.\n\n    var tooltipOptions = [{\n      verticalAlign: 'middle'\n    }, {\n      align: 'center'\n    }];\n    return {\n      position: currPosition,\n      rotation: transform.rotation,\n      cursorPoint: cursorPoint,\n      tooltipOption: tooltipOptions[dimIndex]\n    };\n  }\n});\n\nfunction getCartesian(grid, axis) {\n  var opt = {};\n  opt[axis.dim + 'AxisIndex'] = axis.index;\n  return grid.getCartesian(opt);\n}\n\nvar pointerShapeBuilder = {\n  line: function (axis, pixelValue, otherExtent) {\n    var targetShape = viewHelper.makeLineShape([pixelValue, otherExtent[0]], [pixelValue, otherExtent[1]], getAxisDimIndex(axis));\n    return {\n      type: 'Line',\n      subPixelOptimize: true,\n      shape: targetShape\n    };\n  },\n  shadow: function (axis, pixelValue, otherExtent) {\n    var bandWidth = Math.max(1, axis.getBandWidth());\n    var span = otherExtent[1] - otherExtent[0];\n    return {\n      type: 'Rect',\n      shape: viewHelper.makeRectShape([pixelValue - bandWidth / 2, otherExtent[0]], [bandWidth, span], getAxisDimIndex(axis))\n    };\n  }\n};\n\nfunction getAxisDimIndex(axis) {\n  return axis.dim === 'x' ? 0 : 1;\n}\n\nAxisView.registerAxisPointerClass('CartesianAxisPointer', CartesianAxisPointer);\nvar _default = CartesianAxisPointer;\nmodule.exports = _default;","\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n\nvar zrUtil = require(\"zrender/lib/core/util\");\n\nvar clazzUtil = require(\"../../util/clazz\");\n\nvar graphic = require(\"../../util/graphic\");\n\nvar axisPointerModelHelper = require(\"./modelHelper\");\n\nvar eventTool = require(\"zrender/lib/core/event\");\n\nvar throttleUtil = require(\"../../util/throttle\");\n\nvar _model = require(\"../../util/model\");\n\nvar makeInner = _model.makeInner;\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\nvar inner = makeInner();\nvar clone = zrUtil.clone;\nvar bind = zrUtil.bind;\n/**\n * Base axis pointer class in 2D.\n * Implemenents {module:echarts/component/axis/IAxisPointer}.\n */\n\nfunction BaseAxisPointer() {}\n\nBaseAxisPointer.prototype = {\n  /**\n   * @private\n   */\n  _group: null,\n\n  /**\n   * @private\n   */\n  _lastGraphicKey: null,\n\n  /**\n   * @private\n   */\n  _handle: null,\n\n  /**\n   * @private\n   */\n  _dragging: false,\n\n  /**\n   * @private\n   */\n  _lastValue: null,\n\n  /**\n   * @private\n   */\n  _lastStatus: null,\n\n  /**\n   * @private\n   */\n  _payloadInfo: null,\n\n  /**\n   * In px, arbitrary value. Do not set too small,\n   * no animation is ok for most cases.\n   * @protected\n   */\n  animationThreshold: 15,\n\n  /**\n   * @implement\n   */\n  render: function (axisModel, axisPointerModel, api, forceRender) {\n    var value = axisPointerModel.get('value');\n    var status = axisPointerModel.get('status'); // Bind them to `this`, not in closure, otherwise they will not\n    // be replaced when user calling setOption in not merge mode.\n\n    this._axisModel = axisModel;\n    this._axisPointerModel = axisPointerModel;\n    this._api = api; // Optimize: `render` will be called repeatly during mouse move.\n    // So it is power consuming if performing `render` each time,\n    // especially on mobile device.\n\n    if (!forceRender && this._lastValue === value && this._lastStatus === status) {\n      return;\n    }\n\n    this._lastValue = value;\n    this._lastStatus = status;\n    var group = this._group;\n    var handle = this._handle;\n\n    if (!status || status === 'hide') {\n      // Do not clear here, for animation better.\n      group && group.hide();\n      handle && handle.hide();\n      return;\n    }\n\n    group && group.show();\n    handle && handle.show(); // Otherwise status is 'show'\n\n    var elOption = {};\n    this.makeElOption(elOption, value, axisModel, axisPointerModel, api); // Enable change axis pointer type.\n\n    var graphicKey = elOption.graphicKey;\n\n    if (graphicKey !== this._lastGraphicKey) {\n      this.clear(api);\n    }\n\n    this._lastGraphicKey = graphicKey;\n    var moveAnimation = this._moveAnimation = this.determineAnimation(axisModel, axisPointerModel);\n\n    if (!group) {\n      group = this._group = new graphic.Group();\n      this.createPointerEl(group, elOption, axisModel, axisPointerModel);\n      this.createLabelEl(group, elOption, axisModel, axisPointerModel);\n      api.getZr().add(group);\n    } else {\n      var doUpdateProps = zrUtil.curry(updateProps, axisPointerModel, moveAnimation);\n      this.updatePointerEl(group, elOption, doUpdateProps, axisPointerModel);\n      this.updateLabelEl(group, elOption, doUpdateProps, axisPointerModel);\n    }\n\n    updateMandatoryProps(group, axisPointerModel, true);\n\n    this._renderHandle(value);\n  },\n\n  /**\n   * @implement\n   */\n  remove: function (api) {\n    this.clear(api);\n  },\n\n  /**\n   * @implement\n   */\n  dispose: function (api) {\n    this.clear(api);\n  },\n\n  /**\n   * @protected\n   */\n  determineAnimation: function (axisModel, axisPointerModel) {\n    var animation = axisPointerModel.get('animation');\n    var axis = axisModel.axis;\n    var isCategoryAxis = axis.type === 'category';\n    var useSnap = axisPointerModel.get('snap'); // Value axis without snap always do not snap.\n\n    if (!useSnap && !isCategoryAxis) {\n      return false;\n    }\n\n    if (animation === 'auto' || animation == null) {\n      var animationThreshold = this.animationThreshold;\n\n      if (isCategoryAxis && axis.getBandWidth() > animationThreshold) {\n        return true;\n      } // It is important to auto animation when snap used. Consider if there is\n      // a dataZoom, animation will be disabled when too many points exist, while\n      // it will be enabled for better visual effect when little points exist.\n\n\n      if (useSnap) {\n        var seriesDataCount = axisPointerModelHelper.getAxisInfo(axisModel).seriesDataCount;\n        var axisExtent = axis.getExtent(); // Approximate band width\n\n        return Math.abs(axisExtent[0] - axisExtent[1]) / seriesDataCount > animationThreshold;\n      }\n\n      return false;\n    }\n\n    return animation === true;\n  },\n\n  /**\n   * add {pointer, label, graphicKey} to elOption\n   * @protected\n   */\n  makeElOption: function (elOption, value, axisModel, axisPointerModel, api) {// Shoule be implemenented by sub-class.\n  },\n\n  /**\n   * @protected\n   */\n  createPointerEl: function (group, elOption, axisModel, axisPointerModel) {\n    var pointerOption = elOption.pointer;\n\n    if (pointerOption) {\n      var pointerEl = inner(group).pointerEl = new graphic[pointerOption.type](clone(elOption.pointer));\n      group.add(pointerEl);\n    }\n  },\n\n  /**\n   * @protected\n   */\n  createLabelEl: function (group, elOption, axisModel, axisPointerModel) {\n    if (elOption.label) {\n      var labelEl = inner(group).labelEl = new graphic.Rect(clone(elOption.label));\n      group.add(labelEl);\n      updateLabelShowHide(labelEl, axisPointerModel);\n    }\n  },\n\n  /**\n   * @protected\n   */\n  updatePointerEl: function (group, elOption, updateProps) {\n    var pointerEl = inner(group).pointerEl;\n\n    if (pointerEl && elOption.pointer) {\n      pointerEl.setStyle(elOption.pointer.style);\n      updateProps(pointerEl, {\n        shape: elOption.pointer.shape\n      });\n    }\n  },\n\n  /**\n   * @protected\n   */\n  updateLabelEl: function (group, elOption, updateProps, axisPointerModel) {\n    var labelEl = inner(group).labelEl;\n\n    if (labelEl) {\n      labelEl.setStyle(elOption.label.style);\n      updateProps(labelEl, {\n        // Consider text length change in vertical axis, animation should\n        // be used on shape, otherwise the effect will be weird.\n        shape: elOption.label.shape,\n        position: elOption.label.position\n      });\n      updateLabelShowHide(labelEl, axisPointerModel);\n    }\n  },\n\n  /**\n   * @private\n   */\n  _renderHandle: function (value) {\n    if (this._dragging || !this.updateHandleTransform) {\n      return;\n    }\n\n    var axisPointerModel = this._axisPointerModel;\n\n    var zr = this._api.getZr();\n\n    var handle = this._handle;\n    var handleModel = axisPointerModel.getModel('handle');\n    var status = axisPointerModel.get('status');\n\n    if (!handleModel.get('show') || !status || status === 'hide') {\n      handle && zr.remove(handle);\n      this._handle = null;\n      return;\n    }\n\n    var isInit;\n\n    if (!this._handle) {\n      isInit = true;\n      handle = this._handle = graphic.createIcon(handleModel.get('icon'), {\n        cursor: 'move',\n        draggable: true,\n        onmousemove: function (e) {\n          // Fot mobile devicem, prevent screen slider on the button.\n          eventTool.stop(e.event);\n        },\n        onmousedown: bind(this._onHandleDragMove, this, 0, 0),\n        drift: bind(this._onHandleDragMove, this),\n        ondragend: bind(this._onHandleDragEnd, this)\n      });\n      zr.add(handle);\n    }\n\n    updateMandatoryProps(handle, axisPointerModel, false); // update style\n\n    var includeStyles = ['color', 'borderColor', 'borderWidth', 'opacity', 'shadowColor', 'shadowBlur', 'shadowOffsetX', 'shadowOffsetY'];\n    handle.setStyle(handleModel.getItemStyle(null, includeStyles)); // update position\n\n    var handleSize = handleModel.get('size');\n\n    if (!zrUtil.isArray(handleSize)) {\n      handleSize = [handleSize, handleSize];\n    }\n\n    handle.attr('scale', [handleSize[0] / 2, handleSize[1] / 2]);\n    throttleUtil.createOrUpdate(this, '_doDispatchAxisPointer', handleModel.get('throttle') || 0, 'fixRate');\n\n    this._moveHandleToValue(value, isInit);\n  },\n\n  /**\n   * @private\n   */\n  _moveHandleToValue: function (value, isInit) {\n    updateProps(this._axisPointerModel, !isInit && this._moveAnimation, this._handle, getHandleTransProps(this.getHandleTransform(value, this._axisModel, this._axisPointerModel)));\n  },\n\n  /**\n   * @private\n   */\n  _onHandleDragMove: function (dx, dy) {\n    var handle = this._handle;\n\n    if (!handle) {\n      return;\n    }\n\n    this._dragging = true; // Persistent for throttle.\n\n    var trans = this.updateHandleTransform(getHandleTransProps(handle), [dx, dy], this._axisModel, this._axisPointerModel);\n    this._payloadInfo = trans;\n    handle.stopAnimation();\n    handle.attr(getHandleTransProps(trans));\n    inner(handle).lastProp = null;\n\n    this._doDispatchAxisPointer();\n  },\n\n  /**\n   * Throttled method.\n   * @private\n   */\n  _doDispatchAxisPointer: function () {\n    var handle = this._handle;\n\n    if (!handle) {\n      return;\n    }\n\n    var payloadInfo = this._payloadInfo;\n    var axisModel = this._axisModel;\n\n    this._api.dispatchAction({\n      type: 'updateAxisPointer',\n      x: payloadInfo.cursorPoint[0],\n      y: payloadInfo.cursorPoint[1],\n      tooltipOption: payloadInfo.tooltipOption,\n      axesInfo: [{\n        axisDim: axisModel.axis.dim,\n        axisIndex: axisModel.componentIndex\n      }]\n    });\n  },\n\n  /**\n   * @private\n   */\n  _onHandleDragEnd: function (moveAnimation) {\n    this._dragging = false;\n    var handle = this._handle;\n\n    if (!handle) {\n      return;\n    }\n\n    var value = this._axisPointerModel.get('value'); // Consider snap or categroy axis, handle may be not consistent with\n    // axisPointer. So move handle to align the exact value position when\n    // drag ended.\n\n\n    this._moveHandleToValue(value); // For the effect: tooltip will be shown when finger holding on handle\n    // button, and will be hidden after finger left handle button.\n\n\n    this._api.dispatchAction({\n      type: 'hideTip'\n    });\n  },\n\n  /**\n   * Should be implemenented by sub-class if support `handle`.\n   * @protected\n   * @param {number} value\n   * @param {module:echarts/model/Model} axisModel\n   * @param {module:echarts/model/Model} axisPointerModel\n   * @return {Object} {position: [x, y], rotation: 0}\n   */\n  getHandleTransform: null,\n\n  /**\n   * * Should be implemenented by sub-class if support `handle`.\n   * @protected\n   * @param {Object} transform {position, rotation}\n   * @param {Array.<number>} delta [dx, dy]\n   * @param {module:echarts/model/Model} axisModel\n   * @param {module:echarts/model/Model} axisPointerModel\n   * @return {Object} {position: [x, y], rotation: 0, cursorPoint: [x, y]}\n   */\n  updateHandleTransform: null,\n\n  /**\n   * @private\n   */\n  clear: function (api) {\n    this._lastValue = null;\n    this._lastStatus = null;\n    var zr = api.getZr();\n    var group = this._group;\n    var handle = this._handle;\n\n    if (zr && group) {\n      this._lastGraphicKey = null;\n      group && zr.remove(group);\n      handle && zr.remove(handle);\n      this._group = null;\n      this._handle = null;\n      this._payloadInfo = null;\n    }\n  },\n\n  /**\n   * @protected\n   */\n  doClear: function () {// Implemented by sub-class if necessary.\n  },\n\n  /**\n   * @protected\n   * @param {Array.<number>} xy\n   * @param {Array.<number>} wh\n   * @param {number} [xDimIndex=0] or 1\n   */\n  buildLabel: function (xy, wh, xDimIndex) {\n    xDimIndex = xDimIndex || 0;\n    return {\n      x: xy[xDimIndex],\n      y: xy[1 - xDimIndex],\n      width: wh[xDimIndex],\n      height: wh[1 - xDimIndex]\n    };\n  }\n};\nBaseAxisPointer.prototype.constructor = BaseAxisPointer;\n\nfunction updateProps(animationModel, moveAnimation, el, props) {\n  // Animation optimize.\n  if (!propsEqual(inner(el).lastProp, props)) {\n    inner(el).lastProp = props;\n    moveAnimation ? graphic.updateProps(el, props, animationModel) : (el.stopAnimation(), el.attr(props));\n  }\n}\n\nfunction propsEqual(lastProps, newProps) {\n  if (zrUtil.isObject(lastProps) && zrUtil.isObject(newProps)) {\n    var equals = true;\n    zrUtil.each(newProps, function (item, key) {\n      equals = equals && propsEqual(lastProps[key], item);\n    });\n    return !!equals;\n  } else {\n    return lastProps === newProps;\n  }\n}\n\nfunction updateLabelShowHide(labelEl, axisPointerModel) {\n  labelEl[axisPointerModel.get('label.show') ? 'show' : 'hide']();\n}\n\nfunction getHandleTransProps(trans) {\n  return {\n    position: trans.position.slice(),\n    rotation: trans.rotation || 0\n  };\n}\n\nfunction updateMandatoryProps(group, axisPointerModel, silent) {\n  var z = axisPointerModel.get('z');\n  var zlevel = axisPointerModel.get('zlevel');\n  group && group.traverse(function (el) {\n    if (el.type !== 'group') {\n      z != null && (el.z = z);\n      zlevel != null && (el.zlevel = zlevel);\n      el.silent = silent;\n    }\n  });\n}\n\nclazzUtil.enableClassExtend(BaseAxisPointer);\nvar _default = BaseAxisPointer;\nmodule.exports = _default;","\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n\nvar echarts = require(\"../../echarts\");\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\nvar _default = echarts.extendComponentModel({\n  type: 'tooltip',\n  dependencies: ['axisPointer'],\n  defaultOption: {\n    zlevel: 0,\n    z: 60,\n    show: true,\n    // tooltip主体内容\n    showContent: true,\n    // 'trigger' only works on coordinate system.\n    // 'item' | 'axis' | 'none'\n    trigger: 'item',\n    // 'click' | 'mousemove' | 'none'\n    triggerOn: 'mousemove|click',\n    alwaysShowContent: false,\n    displayMode: 'single',\n    // 'single' | 'multipleByCoordSys'\n    renderMode: 'auto',\n    // 'auto' | 'html' | 'richText'\n    // 'auto': use html by default, and use non-html if `document` is not defined\n    // 'html': use html for tooltip\n    // 'richText': use canvas, svg, and etc. for tooltip\n    // 位置 {Array} | {Function}\n    // position: null\n    // Consider triggered from axisPointer handle, verticalAlign should be 'middle'\n    // align: null,\n    // verticalAlign: null,\n    // 是否约束 content 在 viewRect 中。默认 false 是为了兼容以前版本。\n    confine: false,\n    // 内容格式器：{string}（Template） ¦ {Function}\n    // formatter: null\n    showDelay: 0,\n    // 隐藏延迟，单位ms\n    hideDelay: 100,\n    // 动画变换时间，单位s\n    transitionDuration: 0.4,\n    enterable: false,\n    // 提示背景颜色，默认为透明度为0.7的黑色\n    backgroundColor: 'rgba(50,50,50,0.7)',\n    // 提示边框颜色\n    borderColor: '#333',\n    // 提示边框圆角，单位px，默认为4\n    borderRadius: 4,\n    // 提示边框线宽，单位px，默认为0（无边框）\n    borderWidth: 0,\n    // 提示内边距，单位px，默认各方向内边距为5，\n    // 接受数组分别设定上右下左边距，同css\n    padding: 5,\n    // Extra css text\n    extraCssText: '',\n    // 坐标轴指示器，坐标轴触发有效\n    axisPointer: {\n      // 默认为直线\n      // 可选为：'line' | 'shadow' | 'cross'\n      type: 'line',\n      // type 为 line 的时候有效，指定 tooltip line 所在的轴，可选\n      // 可选 'x' | 'y' | 'angle' | 'radius' | 'auto'\n      // 默认 'auto'，会选择类型为 category 的轴，对于双数值轴，笛卡尔坐标系会默认选择 x 轴\n      // 极坐标系会默认选择 angle 轴\n      axis: 'auto',\n      animation: 'auto',\n      animationDurationUpdate: 200,\n      animationEasingUpdate: 'exponentialOut',\n      crossStyle: {\n        color: '#999',\n        width: 1,\n        type: 'dashed',\n        // TODO formatter\n        textStyle: {} // lineStyle and shadowStyle should not be specified here,\n        // otherwise it will always override those styles on option.axisPointer.\n\n      }\n    },\n    textStyle: {\n      color: '#fff',\n      fontSize: 14\n    }\n  }\n});\n\nmodule.exports = _default;","\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n\nvar echarts = require(\"../../echarts\");\n\nvar zrUtil = require(\"zrender/lib/core/util\");\n\nvar env = require(\"zrender/lib/core/env\");\n\nvar TooltipContent = require(\"./TooltipContent\");\n\nvar TooltipRichContent = require(\"./TooltipRichContent\");\n\nvar formatUtil = require(\"../../util/format\");\n\nvar numberUtil = require(\"../../util/number\");\n\nvar graphic = require(\"../../util/graphic\");\n\nvar findPointFromSeries = require(\"../axisPointer/findPointFromSeries\");\n\nvar layoutUtil = require(\"../../util/layout\");\n\nvar Model = require(\"../../model/Model\");\n\nvar globalListener = require(\"../axisPointer/globalListener\");\n\nvar axisHelper = require(\"../../coord/axisHelper\");\n\nvar axisPointerViewHelper = require(\"../axisPointer/viewHelper\");\n\nvar _model = require(\"../../util/model\");\n\nvar getTooltipRenderMode = _model.getTooltipRenderMode;\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\nvar bind = zrUtil.bind;\nvar each = zrUtil.each;\nvar parsePercent = numberUtil.parsePercent;\nvar proxyRect = new graphic.Rect({\n  shape: {\n    x: -1,\n    y: -1,\n    width: 2,\n    height: 2\n  }\n});\n\nvar _default = echarts.extendComponentView({\n  type: 'tooltip',\n  init: function (ecModel, api) {\n    if (env.node) {\n      return;\n    }\n\n    var tooltipModel = ecModel.getComponent('tooltip');\n    var renderMode = tooltipModel.get('renderMode');\n    this._renderMode = getTooltipRenderMode(renderMode);\n    var tooltipContent;\n\n    if (this._renderMode === 'html') {\n      tooltipContent = new TooltipContent(api.getDom(), api, {\n        appendToBody: tooltipModel.get('appendToBody', true)\n      });\n      this._newLine = '<br/>';\n    } else {\n      tooltipContent = new TooltipRichContent(api);\n      this._newLine = '\\n';\n    }\n\n    this._tooltipContent = tooltipContent;\n  },\n  render: function (tooltipModel, ecModel, api) {\n    if (env.node) {\n      return;\n    } // Reset\n\n\n    this.group.removeAll();\n    /**\n     * @private\n     * @type {module:echarts/component/tooltip/TooltipModel}\n     */\n\n    this._tooltipModel = tooltipModel;\n    /**\n     * @private\n     * @type {module:echarts/model/Global}\n     */\n\n    this._ecModel = ecModel;\n    /**\n     * @private\n     * @type {module:echarts/ExtensionAPI}\n     */\n\n    this._api = api;\n    /**\n     * Should be cleaned when render.\n     * @private\n     * @type {Array.<Array.<Object>>}\n     */\n\n    this._lastDataByCoordSys = null;\n    /**\n     * @private\n     * @type {boolean}\n     */\n\n    this._alwaysShowContent = tooltipModel.get('alwaysShowContent');\n    var tooltipContent = this._tooltipContent;\n    tooltipContent.update(tooltipModel);\n    tooltipContent.setEnterable(tooltipModel.get('enterable'));\n\n    this._initGlobalListener();\n\n    this._keepShow();\n  },\n  _initGlobalListener: function () {\n    var tooltipModel = this._tooltipModel;\n    var triggerOn = tooltipModel.get('triggerOn');\n    globalListener.register('itemTooltip', this._api, bind(function (currTrigger, e, dispatchAction) {\n      // If 'none', it is not controlled by mouse totally.\n      if (triggerOn !== 'none') {\n        if (triggerOn.indexOf(currTrigger) >= 0) {\n          this._tryShow(e, dispatchAction);\n        } else if (currTrigger === 'leave') {\n          this._hide(dispatchAction);\n        }\n      }\n    }, this));\n  },\n  _keepShow: function () {\n    var tooltipModel = this._tooltipModel;\n    var ecModel = this._ecModel;\n    var api = this._api; // Try to keep the tooltip show when refreshing\n\n    if (this._lastX != null && this._lastY != null // When user is willing to control tooltip totally using API,\n    // self.manuallyShowTip({x, y}) might cause tooltip hide,\n    // which is not expected.\n    && tooltipModel.get('triggerOn') !== 'none') {\n      var self = this;\n      clearTimeout(this._refreshUpdateTimeout);\n      this._refreshUpdateTimeout = setTimeout(function () {\n        // Show tip next tick after other charts are rendered\n        // In case highlight action has wrong result\n        // FIXME\n        !api.isDisposed() && self.manuallyShowTip(tooltipModel, ecModel, api, {\n          x: self._lastX,\n          y: self._lastY\n        });\n      });\n    }\n  },\n\n  /**\n   * Show tip manually by\n   * dispatchAction({\n   *     type: 'showTip',\n   *     x: 10,\n   *     y: 10\n   * });\n   * Or\n   * dispatchAction({\n   *      type: 'showTip',\n   *      seriesIndex: 0,\n   *      dataIndex or dataIndexInside or name\n   * });\n   *\n   *  TODO Batch\n   */\n  manuallyShowTip: function (tooltipModel, ecModel, api, payload) {\n    if (payload.from === this.uid || env.node) {\n      return;\n    }\n\n    var dispatchAction = makeDispatchAction(payload, api); // Reset ticket\n\n    this._ticket = ''; // When triggered from axisPointer.\n\n    var dataByCoordSys = payload.dataByCoordSys;\n\n    if (payload.tooltip && payload.x != null && payload.y != null) {\n      var el = proxyRect;\n      el.position = [payload.x, payload.y];\n      el.update();\n      el.tooltip = payload.tooltip; // Manually show tooltip while view is not using zrender elements.\n\n      this._tryShow({\n        offsetX: payload.x,\n        offsetY: payload.y,\n        target: el\n      }, dispatchAction);\n    } else if (dataByCoordSys) {\n      this._tryShow({\n        offsetX: payload.x,\n        offsetY: payload.y,\n        position: payload.position,\n        dataByCoordSys: payload.dataByCoordSys,\n        tooltipOption: payload.tooltipOption\n      }, dispatchAction);\n    } else if (payload.seriesIndex != null) {\n      if (this._manuallyAxisShowTip(tooltipModel, ecModel, api, payload)) {\n        return;\n      }\n\n      var pointInfo = findPointFromSeries(payload, ecModel);\n      var cx = pointInfo.point[0];\n      var cy = pointInfo.point[1];\n\n      if (cx != null && cy != null) {\n        this._tryShow({\n          offsetX: cx,\n          offsetY: cy,\n          position: payload.position,\n          target: pointInfo.el\n        }, dispatchAction);\n      }\n    } else if (payload.x != null && payload.y != null) {\n      // FIXME\n      // should wrap dispatchAction like `axisPointer/globalListener` ?\n      api.dispatchAction({\n        type: 'updateAxisPointer',\n        x: payload.x,\n        y: payload.y\n      });\n\n      this._tryShow({\n        offsetX: payload.x,\n        offsetY: payload.y,\n        position: payload.position,\n        target: api.getZr().findHover(payload.x, payload.y).target\n      }, dispatchAction);\n    }\n  },\n  manuallyHideTip: function (tooltipModel, ecModel, api, payload) {\n    var tooltipContent = this._tooltipContent;\n\n    if (!this._alwaysShowContent && this._tooltipModel) {\n      tooltipContent.hideLater(this._tooltipModel.get('hideDelay'));\n    }\n\n    this._lastX = this._lastY = null;\n\n    if (payload.from !== this.uid) {\n      this._hide(makeDispatchAction(payload, api));\n    }\n  },\n  // Be compatible with previous design, that is, when tooltip.type is 'axis' and\n  // dispatchAction 'showTip' with seriesIndex and dataIndex will trigger axis pointer\n  // and tooltip.\n  _manuallyAxisShowTip: function (tooltipModel, ecModel, api, payload) {\n    var seriesIndex = payload.seriesIndex;\n    var dataIndex = payload.dataIndex;\n    var coordSysAxesInfo = ecModel.getComponent('axisPointer').coordSysAxesInfo;\n\n    if (seriesIndex == null || dataIndex == null || coordSysAxesInfo == null) {\n      return;\n    }\n\n    var seriesModel = ecModel.getSeriesByIndex(seriesIndex);\n\n    if (!seriesModel) {\n      return;\n    }\n\n    var data = seriesModel.getData();\n    var tooltipModel = buildTooltipModel([data.getItemModel(dataIndex), seriesModel, (seriesModel.coordinateSystem || {}).model, tooltipModel]);\n\n    if (tooltipModel.get('trigger') !== 'axis') {\n      return;\n    }\n\n    api.dispatchAction({\n      type: 'updateAxisPointer',\n      seriesIndex: seriesIndex,\n      dataIndex: dataIndex,\n      position: payload.position\n    });\n    return true;\n  },\n  _tryShow: function (e, dispatchAction) {\n    var el = e.target;\n    var tooltipModel = this._tooltipModel;\n\n    if (!tooltipModel) {\n      return;\n    } // Save mouse x, mouse y. So we can try to keep showing the tip if chart is refreshed\n\n\n    this._lastX = e.offsetX;\n    this._lastY = e.offsetY;\n    var dataByCoordSys = e.dataByCoordSys;\n\n    if (dataByCoordSys && dataByCoordSys.length) {\n      this._showAxisTooltip(dataByCoordSys, e);\n    } // Always show item tooltip if mouse is on the element with dataIndex\n    else if (el && el.dataIndex != null) {\n        this._lastDataByCoordSys = null;\n\n        this._showSeriesItemTooltip(e, el, dispatchAction);\n      } // Tooltip provided directly. Like legend.\n      else if (el && el.tooltip) {\n          this._lastDataByCoordSys = null;\n\n          this._showComponentItemTooltip(e, el, dispatchAction);\n        } else {\n          this._lastDataByCoordSys = null;\n\n          this._hide(dispatchAction);\n        }\n  },\n  _showOrMove: function (tooltipModel, cb) {\n    // showDelay is used in this case: tooltip.enterable is set\n    // as true. User intent to move mouse into tooltip and click\n    // something. `showDelay` makes it easier to enter the content\n    // but tooltip do not move immediately.\n    var delay = tooltipModel.get('showDelay');\n    cb = zrUtil.bind(cb, this);\n    clearTimeout(this._showTimout);\n    delay > 0 ? this._showTimout = setTimeout(cb, delay) : cb();\n  },\n  _showAxisTooltip: function (dataByCoordSys, e) {\n    var ecModel = this._ecModel;\n    var globalTooltipModel = this._tooltipModel;\n    var point = [e.offsetX, e.offsetY];\n    var singleDefaultHTML = [];\n    var singleParamsList = [];\n    var singleTooltipModel = buildTooltipModel([e.tooltipOption, globalTooltipModel]);\n    var renderMode = this._renderMode;\n    var newLine = this._newLine;\n    var markers = {};\n    each(dataByCoordSys, function (itemCoordSys) {\n      // var coordParamList = [];\n      // var coordDefaultHTML = [];\n      // var coordTooltipModel = buildTooltipModel([\n      //     e.tooltipOption,\n      //     itemCoordSys.tooltipOption,\n      //     ecModel.getComponent(itemCoordSys.coordSysMainType, itemCoordSys.coordSysIndex),\n      //     globalTooltipModel\n      // ]);\n      // var displayMode = coordTooltipModel.get('displayMode');\n      // var paramsList = displayMode === 'single' ? singleParamsList : [];\n      each(itemCoordSys.dataByAxis, function (item) {\n        var axisModel = ecModel.getComponent(item.axisDim + 'Axis', item.axisIndex);\n        var axisValue = item.value;\n        var seriesDefaultHTML = [];\n\n        if (!axisModel || axisValue == null) {\n          return;\n        }\n\n        var valueLabel = axisPointerViewHelper.getValueLabel(axisValue, axisModel.axis, ecModel, item.seriesDataIndices, item.valueLabelOpt);\n        zrUtil.each(item.seriesDataIndices, function (idxItem) {\n          var series = ecModel.getSeriesByIndex(idxItem.seriesIndex);\n          var dataIndex = idxItem.dataIndexInside;\n          var dataParams = series && series.getDataParams(dataIndex);\n          dataParams.axisDim = item.axisDim;\n          dataParams.axisIndex = item.axisIndex;\n          dataParams.axisType = item.axisType;\n          dataParams.axisId = item.axisId;\n          dataParams.axisValue = axisHelper.getAxisRawValue(axisModel.axis, axisValue);\n          dataParams.axisValueLabel = valueLabel;\n\n          if (dataParams) {\n            singleParamsList.push(dataParams);\n            var seriesTooltip = series.formatTooltip(dataIndex, true, null, renderMode);\n            var html;\n\n            if (zrUtil.isObject(seriesTooltip)) {\n              html = seriesTooltip.html;\n              var newMarkers = seriesTooltip.markers;\n              zrUtil.merge(markers, newMarkers);\n            } else {\n              html = seriesTooltip;\n            }\n\n            seriesDefaultHTML.push(html);\n          }\n        }); // Default tooltip content\n        // FIXME\n        // (1) should be the first data which has name?\n        // (2) themeRiver, firstDataIndex is array, and first line is unnecessary.\n\n        var firstLine = valueLabel;\n\n        if (renderMode !== 'html') {\n          singleDefaultHTML.push(seriesDefaultHTML.join(newLine));\n        } else {\n          singleDefaultHTML.push((firstLine ? formatUtil.encodeHTML(firstLine) + newLine : '') + seriesDefaultHTML.join(newLine));\n        }\n      });\n    }, this); // In most case, the second axis is shown upper than the first one.\n\n    singleDefaultHTML.reverse();\n    singleDefaultHTML = singleDefaultHTML.join(this._newLine + this._newLine);\n    var positionExpr = e.position;\n\n    this._showOrMove(singleTooltipModel, function () {\n      if (this._updateContentNotChangedOnAxis(dataByCoordSys)) {\n        this._updatePosition(singleTooltipModel, positionExpr, point[0], point[1], this._tooltipContent, singleParamsList);\n      } else {\n        this._showTooltipContent(singleTooltipModel, singleDefaultHTML, singleParamsList, Math.random(), point[0], point[1], positionExpr, undefined, markers);\n      }\n    }); // Do not trigger events here, because this branch only be entered\n    // from dispatchAction.\n\n  },\n  _showSeriesItemTooltip: function (e, el, dispatchAction) {\n    var ecModel = this._ecModel; // Use dataModel in element if possible\n    // Used when mouseover on a element like markPoint or edge\n    // In which case, the data is not main data in series.\n\n    var seriesIndex = el.seriesIndex;\n    var seriesModel = ecModel.getSeriesByIndex(seriesIndex); // For example, graph link.\n\n    var dataModel = el.dataModel || seriesModel;\n    var dataIndex = el.dataIndex;\n    var dataType = el.dataType;\n    var data = dataModel.getData(dataType);\n    var tooltipModel = buildTooltipModel([data.getItemModel(dataIndex), dataModel, seriesModel && (seriesModel.coordinateSystem || {}).model, this._tooltipModel]);\n    var tooltipTrigger = tooltipModel.get('trigger');\n\n    if (tooltipTrigger != null && tooltipTrigger !== 'item') {\n      return;\n    }\n\n    var params = dataModel.getDataParams(dataIndex, dataType);\n    var seriesTooltip = dataModel.formatTooltip(dataIndex, false, dataType, this._renderMode);\n    var defaultHtml;\n    var markers;\n\n    if (zrUtil.isObject(seriesTooltip)) {\n      defaultHtml = seriesTooltip.html;\n      markers = seriesTooltip.markers;\n    } else {\n      defaultHtml = seriesTooltip;\n      markers = null;\n    }\n\n    var asyncTicket = 'item_' + dataModel.name + '_' + dataIndex;\n\n    this._showOrMove(tooltipModel, function () {\n      this._showTooltipContent(tooltipModel, defaultHtml, params, asyncTicket, e.offsetX, e.offsetY, e.position, e.target, markers);\n    }); // FIXME\n    // duplicated showtip if manuallyShowTip is called from dispatchAction.\n\n\n    dispatchAction({\n      type: 'showTip',\n      dataIndexInside: dataIndex,\n      dataIndex: data.getRawIndex(dataIndex),\n      seriesIndex: seriesIndex,\n      from: this.uid\n    });\n  },\n  _showComponentItemTooltip: function (e, el, dispatchAction) {\n    var tooltipOpt = el.tooltip;\n\n    if (typeof tooltipOpt === 'string') {\n      var content = tooltipOpt;\n      tooltipOpt = {\n        content: content,\n        // Fixed formatter\n        formatter: content\n      };\n    }\n\n    var subTooltipModel = new Model(tooltipOpt, this._tooltipModel, this._ecModel);\n    var defaultHtml = subTooltipModel.get('content');\n    var asyncTicket = Math.random(); // Do not check whether `trigger` is 'none' here, because `trigger`\n    // only works on coordinate system. In fact, we have not found case\n    // that requires setting `trigger` nothing on component yet.\n\n    this._showOrMove(subTooltipModel, function () {\n      this._showTooltipContent(subTooltipModel, defaultHtml, subTooltipModel.get('formatterParams') || {}, asyncTicket, e.offsetX, e.offsetY, e.position, el);\n    }); // If not dispatch showTip, tip may be hide triggered by axis.\n\n\n    dispatchAction({\n      type: 'showTip',\n      from: this.uid\n    });\n  },\n  _showTooltipContent: function (tooltipModel, defaultHtml, params, asyncTicket, x, y, positionExpr, el, markers) {\n    // Reset ticket\n    this._ticket = '';\n\n    if (!tooltipModel.get('showContent') || !tooltipModel.get('show')) {\n      return;\n    }\n\n    var tooltipContent = this._tooltipContent;\n    var formatter = tooltipModel.get('formatter');\n    positionExpr = positionExpr || tooltipModel.get('position');\n    var html = defaultHtml;\n\n    if (formatter && typeof formatter === 'string') {\n      html = formatUtil.formatTpl(formatter, params, true);\n    } else if (typeof formatter === 'function') {\n      var callback = bind(function (cbTicket, html) {\n        if (cbTicket === this._ticket) {\n          tooltipContent.setContent(html, markers, tooltipModel);\n\n          this._updatePosition(tooltipModel, positionExpr, x, y, tooltipContent, params, el);\n        }\n      }, this);\n      this._ticket = asyncTicket;\n      html = formatter(params, asyncTicket, callback);\n    }\n\n    tooltipContent.setContent(html, markers, tooltipModel);\n    tooltipContent.show(tooltipModel);\n\n    this._updatePosition(tooltipModel, positionExpr, x, y, tooltipContent, params, el);\n  },\n\n  /**\n   * @param  {string|Function|Array.<number>|Object} positionExpr\n   * @param  {number} x Mouse x\n   * @param  {number} y Mouse y\n   * @param  {boolean} confine Whether confine tooltip content in view rect.\n   * @param  {Object|<Array.<Object>} params\n   * @param  {module:zrender/Element} el target element\n   * @param  {module:echarts/ExtensionAPI} api\n   * @return {Array.<number>}\n   */\n  _updatePosition: function (tooltipModel, positionExpr, x, y, content, params, el) {\n    var viewWidth = this._api.getWidth();\n\n    var viewHeight = this._api.getHeight();\n\n    positionExpr = positionExpr || tooltipModel.get('position');\n    var contentSize = content.getSize();\n    var align = tooltipModel.get('align');\n    var vAlign = tooltipModel.get('verticalAlign');\n    var rect = el && el.getBoundingRect().clone();\n    el && rect.applyTransform(el.transform);\n\n    if (typeof positionExpr === 'function') {\n      // Callback of position can be an array or a string specify the position\n      positionExpr = positionExpr([x, y], params, content.el, rect, {\n        viewSize: [viewWidth, viewHeight],\n        contentSize: contentSize.slice()\n      });\n    }\n\n    if (zrUtil.isArray(positionExpr)) {\n      x = parsePercent(positionExpr[0], viewWidth);\n      y = parsePercent(positionExpr[1], viewHeight);\n    } else if (zrUtil.isObject(positionExpr)) {\n      positionExpr.width = contentSize[0];\n      positionExpr.height = contentSize[1];\n      var layoutRect = layoutUtil.getLayoutRect(positionExpr, {\n        width: viewWidth,\n        height: viewHeight\n      });\n      x = layoutRect.x;\n      y = layoutRect.y;\n      align = null; // When positionExpr is left/top/right/bottom,\n      // align and verticalAlign will not work.\n\n      vAlign = null;\n    } // Specify tooltip position by string 'top' 'bottom' 'left' 'right' around graphic element\n    else if (typeof positionExpr === 'string' && el) {\n        var pos = calcTooltipPosition(positionExpr, rect, contentSize);\n        x = pos[0];\n        y = pos[1];\n      } else {\n        var pos = refixTooltipPosition(x, y, content, viewWidth, viewHeight, align ? null : 20, vAlign ? null : 20);\n        x = pos[0];\n        y = pos[1];\n      }\n\n    align && (x -= isCenterAlign(align) ? contentSize[0] / 2 : align === 'right' ? contentSize[0] : 0);\n    vAlign && (y -= isCenterAlign(vAlign) ? contentSize[1] / 2 : vAlign === 'bottom' ? contentSize[1] : 0);\n\n    if (tooltipModel.get('confine')) {\n      var pos = confineTooltipPosition(x, y, content, viewWidth, viewHeight);\n      x = pos[0];\n      y = pos[1];\n    }\n\n    content.moveTo(x, y);\n  },\n  // FIXME\n  // Should we remove this but leave this to user?\n  _updateContentNotChangedOnAxis: function (dataByCoordSys) {\n    var lastCoordSys = this._lastDataByCoordSys;\n    var contentNotChanged = !!lastCoordSys && lastCoordSys.length === dataByCoordSys.length;\n    contentNotChanged && each(lastCoordSys, function (lastItemCoordSys, indexCoordSys) {\n      var lastDataByAxis = lastItemCoordSys.dataByAxis || {};\n      var thisItemCoordSys = dataByCoordSys[indexCoordSys] || {};\n      var thisDataByAxis = thisItemCoordSys.dataByAxis || [];\n      contentNotChanged &= lastDataByAxis.length === thisDataByAxis.length;\n      contentNotChanged && each(lastDataByAxis, function (lastItem, indexAxis) {\n        var thisItem = thisDataByAxis[indexAxis] || {};\n        var lastIndices = lastItem.seriesDataIndices || [];\n        var newIndices = thisItem.seriesDataIndices || [];\n        contentNotChanged &= lastItem.value === thisItem.value && lastItem.axisType === thisItem.axisType && lastItem.axisId === thisItem.axisId && lastIndices.length === newIndices.length;\n        contentNotChanged && each(lastIndices, function (lastIdxItem, j) {\n          var newIdxItem = newIndices[j];\n          contentNotChanged &= lastIdxItem.seriesIndex === newIdxItem.seriesIndex && lastIdxItem.dataIndex === newIdxItem.dataIndex;\n        });\n      });\n    });\n    this._lastDataByCoordSys = dataByCoordSys;\n    return !!contentNotChanged;\n  },\n  _hide: function (dispatchAction) {\n    // Do not directly hideLater here, because this behavior may be prevented\n    // in dispatchAction when showTip is dispatched.\n    // FIXME\n    // duplicated hideTip if manuallyHideTip is called from dispatchAction.\n    this._lastDataByCoordSys = null;\n    dispatchAction({\n      type: 'hideTip',\n      from: this.uid\n    });\n  },\n  dispose: function (ecModel, api) {\n    if (env.node) {\n      return;\n    }\n\n    this._tooltipContent.dispose();\n\n    globalListener.unregister('itemTooltip', api);\n  }\n});\n/**\n * @param {Array.<Object|module:echarts/model/Model>} modelCascade\n * From top to bottom. (the last one should be globalTooltipModel);\n */\n\n\nfunction buildTooltipModel(modelCascade) {\n  var resultModel = modelCascade.pop();\n\n  while (modelCascade.length) {\n    var tooltipOpt = modelCascade.pop();\n\n    if (tooltipOpt) {\n      if (Model.isInstance(tooltipOpt)) {\n        tooltipOpt = tooltipOpt.get('tooltip', true);\n      } // In each data item tooltip can be simply write:\n      // {\n      //  value: 10,\n      //  tooltip: 'Something you need to know'\n      // }\n\n\n      if (typeof tooltipOpt === 'string') {\n        tooltipOpt = {\n          formatter: tooltipOpt\n        };\n      }\n\n      resultModel = new Model(tooltipOpt, resultModel, resultModel.ecModel);\n    }\n  }\n\n  return resultModel;\n}\n\nfunction makeDispatchAction(payload, api) {\n  return payload.dispatchAction || zrUtil.bind(api.dispatchAction, api);\n}\n\nfunction refixTooltipPosition(x, y, content, viewWidth, viewHeight, gapH, gapV) {\n  var size = content.getOuterSize();\n  var width = size.width;\n  var height = size.height;\n\n  if (gapH != null) {\n    if (x + width + gapH > viewWidth) {\n      x -= width + gapH;\n    } else {\n      x += gapH;\n    }\n  }\n\n  if (gapV != null) {\n    if (y + height + gapV > viewHeight) {\n      y -= height + gapV;\n    } else {\n      y += gapV;\n    }\n  }\n\n  return [x, y];\n}\n\nfunction confineTooltipPosition(x, y, content, viewWidth, viewHeight) {\n  var size = content.getOuterSize();\n  var width = size.width;\n  var height = size.height;\n  x = Math.min(x + width, viewWidth) - width;\n  y = Math.min(y + height, viewHeight) - height;\n  x = Math.max(x, 0);\n  y = Math.max(y, 0);\n  return [x, y];\n}\n\nfunction calcTooltipPosition(position, rect, contentSize) {\n  var domWidth = contentSize[0];\n  var domHeight = contentSize[1];\n  var gap = 5;\n  var x = 0;\n  var y = 0;\n  var rectWidth = rect.width;\n  var rectHeight = rect.height;\n\n  switch (position) {\n    case 'inside':\n      x = rect.x + rectWidth / 2 - domWidth / 2;\n      y = rect.y + rectHeight / 2 - domHeight / 2;\n      break;\n\n    case 'top':\n      x = rect.x + rectWidth / 2 - domWidth / 2;\n      y = rect.y - domHeight - gap;\n      break;\n\n    case 'bottom':\n      x = rect.x + rectWidth / 2 - domWidth / 2;\n      y = rect.y + rectHeight + gap;\n      break;\n\n    case 'left':\n      x = rect.x - domWidth - gap;\n      y = rect.y + rectHeight / 2 - domHeight / 2;\n      break;\n\n    case 'right':\n      x = rect.x + rectWidth + gap;\n      y = rect.y + rectHeight / 2 - domHeight / 2;\n  }\n\n  return [x, y];\n}\n\nfunction isCenterAlign(align) {\n  return align === 'center' || align === 'middle';\n}\n\nmodule.exports = _default;","\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n\nvar zrUtil = require(\"zrender/lib/core/util\");\n\nvar zrColor = require(\"zrender/lib/tool/color\");\n\nvar eventUtil = require(\"zrender/lib/core/event\");\n\nvar domUtil = require(\"zrender/lib/core/dom\");\n\nvar env = require(\"zrender/lib/core/env\");\n\nvar formatUtil = require(\"../../util/format\");\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\nvar each = zrUtil.each;\nvar toCamelCase = formatUtil.toCamelCase;\nvar vendors = ['', '-webkit-', '-moz-', '-o-'];\nvar gCssText = 'position:absolute;display:block;border-style:solid;white-space:nowrap;z-index:9999999;';\n/**\n * @param {number} duration\n * @return {string}\n * @inner\n */\n\nfunction assembleTransition(duration) {\n  var transitionCurve = 'cubic-bezier(0.23, 1, 0.32, 1)';\n  var transitionText = 'left ' + duration + 's ' + transitionCurve + ',' + 'top ' + duration + 's ' + transitionCurve;\n  return zrUtil.map(vendors, function (vendorPrefix) {\n    return vendorPrefix + 'transition:' + transitionText;\n  }).join(';');\n}\n/**\n * @param {Object} textStyle\n * @return {string}\n * @inner\n */\n\n\nfunction assembleFont(textStyleModel) {\n  var cssText = [];\n  var fontSize = textStyleModel.get('fontSize');\n  var color = textStyleModel.getTextColor();\n  color && cssText.push('color:' + color);\n  cssText.push('font:' + textStyleModel.getFont());\n  var lineHeight = textStyleModel.get('lineHeight');\n\n  if (lineHeight == null) {\n    lineHeight = Math.round(fontSize * 3 / 2);\n  }\n\n  fontSize && cssText.push('line-height:' + lineHeight + 'px');\n  var shadowColor = textStyleModel.get('textShadowColor');\n  var shadowBlur = textStyleModel.get('textShadowBlur') || 0;\n  var shadowOffsetX = textStyleModel.get('textShadowOffsetX') || 0;\n  var shadowOffsetY = textStyleModel.get('textShadowOffsetY') || 0;\n  shadowBlur && cssText.push('text-shadow:' + shadowOffsetX + 'px ' + shadowOffsetY + 'px ' + shadowBlur + 'px ' + shadowColor);\n  each(['decoration', 'align'], function (name) {\n    var val = textStyleModel.get(name);\n    val && cssText.push('text-' + name + ':' + val);\n  });\n  return cssText.join(';');\n}\n/**\n * @param {Object} tooltipModel\n * @return {string}\n * @inner\n */\n\n\nfunction assembleCssText(tooltipModel) {\n  var cssText = [];\n  var transitionDuration = tooltipModel.get('transitionDuration');\n  var backgroundColor = tooltipModel.get('backgroundColor');\n  var textStyleModel = tooltipModel.getModel('textStyle');\n  var padding = tooltipModel.get('padding'); // Animation transition. Do not animate when transitionDuration is 0.\n\n  transitionDuration && cssText.push(assembleTransition(transitionDuration));\n\n  if (backgroundColor) {\n    if (env.canvasSupported) {\n      cssText.push('background-Color:' + backgroundColor);\n    } else {\n      // for ie\n      cssText.push('background-Color:#' + zrColor.toHex(backgroundColor));\n      cssText.push('filter:alpha(opacity=70)');\n    }\n  } // Border style\n\n\n  each(['width', 'color', 'radius'], function (name) {\n    var borderName = 'border-' + name;\n    var camelCase = toCamelCase(borderName);\n    var val = tooltipModel.get(camelCase);\n    val != null && cssText.push(borderName + ':' + val + (name === 'color' ? '' : 'px'));\n  }); // Text style\n\n  cssText.push(assembleFont(textStyleModel)); // Padding\n\n  if (padding != null) {\n    cssText.push('padding:' + formatUtil.normalizeCssArray(padding).join('px ') + 'px');\n  }\n\n  return cssText.join(';') + ';';\n} // If not able to make, do not modify the input `out`.\n\n\nfunction makeStyleCoord(out, zr, appendToBody, zrX, zrY) {\n  var zrPainter = zr && zr.painter;\n\n  if (appendToBody) {\n    var zrViewportRoot = zrPainter && zrPainter.getViewportRoot();\n\n    if (zrViewportRoot) {\n      // Some APPs might use scale on body, so we support CSS transform here.\n      domUtil.transformLocalCoord(out, zrViewportRoot, document.body, zrX, zrY);\n    }\n  } else {\n    out[0] = zrX;\n    out[1] = zrY; // xy should be based on canvas root. But tooltipContent is\n    // the sibling of canvas root. So padding of ec container\n    // should be considered here.\n\n    var viewportRootOffset = zrPainter && zrPainter.getViewportRootOffset();\n\n    if (viewportRootOffset) {\n      out[0] += viewportRootOffset.offsetLeft;\n      out[1] += viewportRootOffset.offsetTop;\n    }\n  }\n\n  out[2] = out[0] / zr.getWidth(); // The ratio of left to width\n\n  out[3] = out[1] / zr.getHeight(); // The ratio of top to height\n}\n/**\n * @alias module:echarts/component/tooltip/TooltipContent\n * @param {HTMLElement} container\n * @param {ExtensionAPI} api\n * @param {Object} [opt]\n * @param {boolean} [opt.appendToBody]\n *        `false`: the DOM element will be inside the container. Default value.\n *        `true`: the DOM element will be appended to HTML body, which avoid\n *                some overflow clip but intrude outside of the container.\n * @constructor\n */\n\n\nfunction TooltipContent(container, api, opt) {\n  if (env.wxa) {\n    return null;\n  }\n\n  var el = document.createElement('div');\n  el.domBelongToZr = true;\n  this.el = el;\n  var zr = this._zr = api.getZr();\n  var appendToBody = this._appendToBody = opt && opt.appendToBody;\n  this._styleCoord = [0, 0, 0, 0]; // [left, top, left/width, top/height]\n\n  makeStyleCoord(this._styleCoord, zr, appendToBody, api.getWidth() / 2, api.getHeight() / 2);\n\n  if (appendToBody) {\n    document.body.appendChild(el);\n  } else {\n    container.appendChild(el);\n  }\n\n  this._container = container;\n  this._show = false;\n  /**\n   * @private\n   */\n\n  this._hideTimeout; // FIXME\n  // Is it needed to trigger zr event manually if\n  // the browser do not support `pointer-events: none`.\n\n  var self = this;\n\n  el.onmouseenter = function () {\n    // clear the timeout in hideLater and keep showing tooltip\n    if (self._enterable) {\n      clearTimeout(self._hideTimeout);\n      self._show = true;\n    }\n\n    self._inContent = true;\n  };\n\n  el.onmousemove = function (e) {\n    e = e || window.event;\n\n    if (!self._enterable) {\n      // `pointer-events: none` is set to tooltip content div\n      // if `enterable` is set as `false`, and `el.onmousemove`\n      // can not be triggered. But in browser that do not\n      // support `pointer-events`, we need to do this:\n      // Try trigger zrender event to avoid mouse\n      // in and out shape too frequently\n      var handler = zr.handler;\n      var zrViewportRoot = zr.painter.getViewportRoot();\n      eventUtil.normalizeEvent(zrViewportRoot, e, true);\n      handler.dispatch('mousemove', e);\n    }\n  };\n\n  el.onmouseleave = function () {\n    if (self._enterable) {\n      if (self._show) {\n        self.hideLater(self._hideDelay);\n      }\n    }\n\n    self._inContent = false;\n  };\n}\n\nTooltipContent.prototype = {\n  constructor: TooltipContent,\n\n  /**\n   * @private\n   * @type {boolean}\n   */\n  _enterable: true,\n\n  /**\n   * Update when tooltip is rendered\n   */\n  update: function (tooltipModel) {\n    // FIXME\n    // Move this logic to ec main?\n    var container = this._container;\n    var stl = container.currentStyle || document.defaultView.getComputedStyle(container);\n    var domStyle = container.style;\n\n    if (domStyle.position !== 'absolute' && stl.position !== 'absolute') {\n      domStyle.position = 'relative';\n    }\n\n    var alwaysShowContent = tooltipModel.get('alwaysShowContent');\n    alwaysShowContent && this._moveTooltipIfResized(); // Hide the tooltip\n    // PENDING\n    // this.hide();\n  },\n\n  /**\n   * when `alwaysShowContent` is true,\n   * we should move the tooltip after chart resized\n   */\n  _moveTooltipIfResized: function () {\n    var ratioX = this._styleCoord[2]; // The ratio of left to width\n\n    var ratioY = this._styleCoord[3]; // The ratio of top to height\n\n    var realX = ratioX * this._zr.getWidth();\n\n    var realY = ratioY * this._zr.getHeight();\n\n    this.moveTo(realX, realY);\n  },\n  show: function (tooltipModel) {\n    clearTimeout(this._hideTimeout);\n    var el = this.el;\n    var styleCoord = this._styleCoord;\n    el.style.cssText = gCssText + assembleCssText(tooltipModel) // Because of the reason described in:\n    // http://stackoverflow.com/questions/21125587/css3-transition-not-working-in-chrome-anymore\n    // we should set initial value to `left` and `top`.\n    + ';left:' + styleCoord[0] + 'px;top:' + styleCoord[1] + 'px;' + (tooltipModel.get('extraCssText') || '');\n    el.style.display = el.innerHTML ? 'block' : 'none'; // If mouse occasionally move over the tooltip, a mouseout event will be\n    // triggered by canvas, and cause some unexpectable result like dragging\n    // stop, \"unfocusAdjacency\". Here `pointer-events: none` is used to solve\n    // it. Although it is not supported by IE8~IE10, fortunately it is a rare\n    // scenario.\n\n    el.style.pointerEvents = this._enterable ? 'auto' : 'none';\n    this._show = true;\n  },\n  setContent: function (content) {\n    this.el.innerHTML = content == null ? '' : content;\n  },\n  setEnterable: function (enterable) {\n    this._enterable = enterable;\n  },\n  getSize: function () {\n    var el = this.el;\n    return [el.clientWidth, el.clientHeight];\n  },\n  moveTo: function (zrX, zrY) {\n    var styleCoord = this._styleCoord;\n    makeStyleCoord(styleCoord, this._zr, this._appendToBody, zrX, zrY);\n    var style = this.el.style;\n    style.left = styleCoord[0] + 'px';\n    style.top = styleCoord[1] + 'px';\n  },\n  hide: function () {\n    this.el.style.display = 'none';\n    this._show = false;\n  },\n  hideLater: function (time) {\n    if (this._show && !(this._inContent && this._enterable)) {\n      if (time) {\n        this._hideDelay = time; // Set show false to avoid invoke hideLater multiple times\n\n        this._show = false;\n        this._hideTimeout = setTimeout(zrUtil.bind(this.hide, this), time);\n      } else {\n        this.hide();\n      }\n    }\n  },\n  isShow: function () {\n    return this._show;\n  },\n  dispose: function () {\n    this.el.parentNode.removeChild(this.el);\n  },\n  getOuterSize: function () {\n    var width = this.el.clientWidth;\n    var height = this.el.clientHeight; // Consider browser compatibility.\n    // IE8 does not support getComputedStyle.\n\n    if (document.defaultView && document.defaultView.getComputedStyle) {\n      var stl = document.defaultView.getComputedStyle(this.el);\n\n      if (stl) {\n        width += parseInt(stl.borderLeftWidth, 10) + parseInt(stl.borderRightWidth, 10);\n        height += parseInt(stl.borderTopWidth, 10) + parseInt(stl.borderBottomWidth, 10);\n      }\n    }\n\n    return {\n      width: width,\n      height: height\n    };\n  }\n};\nvar _default = TooltipContent;\nmodule.exports = _default;","\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n\nvar zrUtil = require(\"zrender/lib/core/util\");\n\nvar Text = require(\"zrender/lib/graphic/Text\");\n\nvar graphicUtil = require(\"../../util/graphic\");\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n// import Group from 'zrender/src/container/Group';\nfunction makeStyleCoord(out, zr, zrX, zrY) {\n  out[0] = zrX;\n  out[1] = zrY;\n  out[2] = out[0] / zr.getWidth(); // The ratio of left to width\n\n  out[3] = out[1] / zr.getHeight(); // The ratio of top to height\n}\n/**\n * @alias module:echarts/component/tooltip/TooltipRichContent\n * @constructor\n */\n\n\nfunction TooltipRichContent(api) {\n  var zr = this._zr = api.getZr();\n  this._styleCoord = [0, 0, 0, 0]; // [left, top, left/width, top/height]\n\n  makeStyleCoord(this._styleCoord, zr, api.getWidth() / 2, api.getHeight() / 2);\n  this._show = false;\n  /**\n   * @private\n   */\n\n  this._hideTimeout;\n}\n\nTooltipRichContent.prototype = {\n  constructor: TooltipRichContent,\n\n  /**\n   * @private\n   * @type {boolean}\n   */\n  _enterable: true,\n\n  /**\n   * Update when tooltip is rendered\n   */\n  update: function (tooltipModel) {\n    var alwaysShowContent = tooltipModel.get('alwaysShowContent');\n    alwaysShowContent && this._moveTooltipIfResized();\n  },\n\n  /**\n   * when `alwaysShowContent` is true,\n   * we should move the tooltip after chart resized\n   */\n  _moveTooltipIfResized: function () {\n    var ratioX = this._styleCoord[2]; // The ratio of left to width\n\n    var ratioY = this._styleCoord[3]; // The ratio of top to height\n\n    var realX = ratioX * this._zr.getWidth();\n\n    var realY = ratioY * this._zr.getHeight();\n\n    this.moveTo(realX, realY);\n  },\n  show: function (tooltipModel) {\n    if (this._hideTimeout) {\n      clearTimeout(this._hideTimeout);\n    }\n\n    this.el.attr('show', true);\n    this._show = true;\n  },\n\n  /**\n   * Set tooltip content\n   *\n   * @param {string} content rich text string of content\n   * @param {Object} markerRich rich text style\n   * @param {Object} tooltipModel tooltip model\n   */\n  setContent: function (content, markerRich, tooltipModel) {\n    if (this.el) {\n      this._zr.remove(this.el);\n    }\n\n    var markers = {};\n    var text = content;\n    var prefix = '{marker';\n    var suffix = '|}';\n    var startId = text.indexOf(prefix);\n\n    while (startId >= 0) {\n      var endId = text.indexOf(suffix);\n      var name = text.substr(startId + prefix.length, endId - startId - prefix.length);\n\n      if (name.indexOf('sub') > -1) {\n        markers['marker' + name] = {\n          textWidth: 4,\n          textHeight: 4,\n          textBorderRadius: 2,\n          textBackgroundColor: markerRich[name],\n          // TODO: textOffset is not implemented for rich text\n          textOffset: [3, 0]\n        };\n      } else {\n        markers['marker' + name] = {\n          textWidth: 10,\n          textHeight: 10,\n          textBorderRadius: 5,\n          textBackgroundColor: markerRich[name]\n        };\n      }\n\n      text = text.substr(endId + 1);\n      startId = text.indexOf('{marker');\n    }\n\n    var textStyleModel = tooltipModel.getModel('textStyle');\n    var fontSize = textStyleModel.get('fontSize');\n    var lineHeight = tooltipModel.get('textLineHeight');\n\n    if (lineHeight == null) {\n      lineHeight = Math.round(fontSize * 3 / 2);\n    }\n\n    this.el = new Text({\n      style: graphicUtil.setTextStyle({}, textStyleModel, {\n        rich: markers,\n        text: content,\n        textBackgroundColor: tooltipModel.get('backgroundColor'),\n        textBorderRadius: tooltipModel.get('borderRadius'),\n        textFill: tooltipModel.get('textStyle.color'),\n        textPadding: tooltipModel.get('padding'),\n        textLineHeight: lineHeight\n      }),\n      z: tooltipModel.get('z')\n    });\n\n    this._zr.add(this.el);\n\n    var self = this;\n    this.el.on('mouseover', function () {\n      // clear the timeout in hideLater and keep showing tooltip\n      if (self._enterable) {\n        clearTimeout(self._hideTimeout);\n        self._show = true;\n      }\n\n      self._inContent = true;\n    });\n    this.el.on('mouseout', function () {\n      if (self._enterable) {\n        if (self._show) {\n          self.hideLater(self._hideDelay);\n        }\n      }\n\n      self._inContent = false;\n    });\n  },\n  setEnterable: function (enterable) {\n    this._enterable = enterable;\n  },\n  getSize: function () {\n    var bounding = this.el.getBoundingRect();\n    return [bounding.width, bounding.height];\n  },\n  moveTo: function (x, y) {\n    if (this.el) {\n      var styleCoord = this._styleCoord;\n      makeStyleCoord(styleCoord, this._zr, x, y);\n      this.el.attr('position', [styleCoord[0], styleCoord[1]]);\n    }\n  },\n  hide: function () {\n    if (this.el) {\n      this.el.hide();\n    }\n\n    this._show = false;\n  },\n  hideLater: function (time) {\n    if (this._show && !(this._inContent && this._enterable)) {\n      if (time) {\n        this._hideDelay = time; // Set show false to avoid invoke hideLater multiple times\n\n        this._show = false;\n        this._hideTimeout = setTimeout(zrUtil.bind(this.hide, this), time);\n      } else {\n        this.hide();\n      }\n    }\n  },\n  isShow: function () {\n    return this._show;\n  },\n  dispose: function () {\n    clearTimeout(this._hideTimeout);\n\n    if (this.el) {\n      this._zr.remove(this.el);\n    }\n  },\n  getOuterSize: function () {\n    var size = this.getSize();\n    return {\n      width: size[0],\n      height: size[1]\n    };\n  }\n};\nvar _default = TooltipRichContent;\nmodule.exports = _default;","\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n\nvar echarts = require(\"../../echarts\");\n\nvar zrUtil = require(\"zrender/lib/core/util\");\n\nvar Model = require(\"../../model/Model\");\n\nvar _model = require(\"../../util/model\");\n\nvar isNameSpecified = _model.isNameSpecified;\n\nvar lang = require(\"../../lang\");\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\nvar langSelector = lang.legend.selector;\nvar defaultSelectorOption = {\n  all: {\n    type: 'all',\n    title: zrUtil.clone(langSelector.all)\n  },\n  inverse: {\n    type: 'inverse',\n    title: zrUtil.clone(langSelector.inverse)\n  }\n};\nvar LegendModel = echarts.extendComponentModel({\n  type: 'legend.plain',\n  dependencies: ['series'],\n  layoutMode: {\n    type: 'box',\n    // legend.width/height are maxWidth/maxHeight actually,\n    // whereas realy width/height is calculated by its content.\n    // (Setting {left: 10, right: 10} does not make sense).\n    // So consider the case:\n    // `setOption({legend: {left: 10});`\n    // then `setOption({legend: {right: 10});`\n    // The previous `left` should be cleared by setting `ignoreSize`.\n    ignoreSize: true\n  },\n  init: function (option, parentModel, ecModel) {\n    this.mergeDefaultAndTheme(option, ecModel);\n    option.selected = option.selected || {};\n\n    this._updateSelector(option);\n  },\n  mergeOption: function (option) {\n    LegendModel.superCall(this, 'mergeOption', option);\n\n    this._updateSelector(option);\n  },\n  _updateSelector: function (option) {\n    var selector = option.selector;\n\n    if (selector === true) {\n      selector = option.selector = ['all', 'inverse'];\n    }\n\n    if (zrUtil.isArray(selector)) {\n      zrUtil.each(selector, function (item, index) {\n        zrUtil.isString(item) && (item = {\n          type: item\n        });\n        selector[index] = zrUtil.merge(item, defaultSelectorOption[item.type]);\n      });\n    }\n  },\n  optionUpdated: function () {\n    this._updateData(this.ecModel);\n\n    var legendData = this._data; // If selectedMode is single, try to select one\n\n    if (legendData[0] && this.get('selectedMode') === 'single') {\n      var hasSelected = false; // If has any selected in option.selected\n\n      for (var i = 0; i < legendData.length; i++) {\n        var name = legendData[i].get('name');\n\n        if (this.isSelected(name)) {\n          // Force to unselect others\n          this.select(name);\n          hasSelected = true;\n          break;\n        }\n      } // Try select the first if selectedMode is single\n\n\n      !hasSelected && this.select(legendData[0].get('name'));\n    }\n  },\n  _updateData: function (ecModel) {\n    var potentialData = [];\n    var availableNames = [];\n    ecModel.eachRawSeries(function (seriesModel) {\n      var seriesName = seriesModel.name;\n      availableNames.push(seriesName);\n      var isPotential;\n\n      if (seriesModel.legendVisualProvider) {\n        var provider = seriesModel.legendVisualProvider;\n        var names = provider.getAllNames();\n\n        if (!ecModel.isSeriesFiltered(seriesModel)) {\n          availableNames = availableNames.concat(names);\n        }\n\n        if (names.length) {\n          potentialData = potentialData.concat(names);\n        } else {\n          isPotential = true;\n        }\n      } else {\n        isPotential = true;\n      }\n\n      if (isPotential && isNameSpecified(seriesModel)) {\n        potentialData.push(seriesModel.name);\n      }\n    });\n    /**\n     * @type {Array.<string>}\n     * @private\n     */\n\n    this._availableNames = availableNames; // If legend.data not specified in option, use availableNames as data,\n    // which is convinient for user preparing option.\n\n    var rawData = this.get('data') || potentialData;\n    var legendData = zrUtil.map(rawData, function (dataItem) {\n      // Can be string or number\n      if (typeof dataItem === 'string' || typeof dataItem === 'number') {\n        dataItem = {\n          name: dataItem\n        };\n      }\n\n      return new Model(dataItem, this, this.ecModel);\n    }, this);\n    /**\n     * @type {Array.<module:echarts/model/Model>}\n     * @private\n     */\n\n    this._data = legendData;\n  },\n\n  /**\n   * @return {Array.<module:echarts/model/Model>}\n   */\n  getData: function () {\n    return this._data;\n  },\n\n  /**\n   * @param {string} name\n   */\n  select: function (name) {\n    var selected = this.option.selected;\n    var selectedMode = this.get('selectedMode');\n\n    if (selectedMode === 'single') {\n      var data = this._data;\n      zrUtil.each(data, function (dataItem) {\n        selected[dataItem.get('name')] = false;\n      });\n    }\n\n    selected[name] = true;\n  },\n\n  /**\n   * @param {string} name\n   */\n  unSelect: function (name) {\n    if (this.get('selectedMode') !== 'single') {\n      this.option.selected[name] = false;\n    }\n  },\n\n  /**\n   * @param {string} name\n   */\n  toggleSelected: function (name) {\n    var selected = this.option.selected; // Default is true\n\n    if (!selected.hasOwnProperty(name)) {\n      selected[name] = true;\n    }\n\n    this[selected[name] ? 'unSelect' : 'select'](name);\n  },\n  allSelect: function () {\n    var data = this._data;\n    var selected = this.option.selected;\n    zrUtil.each(data, function (dataItem) {\n      selected[dataItem.get('name', true)] = true;\n    });\n  },\n  inverseSelect: function () {\n    var data = this._data;\n    var selected = this.option.selected;\n    zrUtil.each(data, function (dataItem) {\n      var name = dataItem.get('name', true); // Initially, default value is true\n\n      if (!selected.hasOwnProperty(name)) {\n        selected[name] = true;\n      }\n\n      selected[name] = !selected[name];\n    });\n  },\n\n  /**\n   * @param {string} name\n   */\n  isSelected: function (name) {\n    var selected = this.option.selected;\n    return !(selected.hasOwnProperty(name) && !selected[name]) && zrUtil.indexOf(this._availableNames, name) >= 0;\n  },\n  getOrient: function () {\n    return this.get('orient') === 'vertical' ? {\n      index: 1,\n      name: 'vertical'\n    } : {\n      index: 0,\n      name: 'horizontal'\n    };\n  },\n  defaultOption: {\n    // 一级层叠\n    zlevel: 0,\n    // 二级层叠\n    z: 4,\n    show: true,\n    // 布局方式，默认为水平布局，可选为：\n    // 'horizontal' | 'vertical'\n    orient: 'horizontal',\n    left: 'center',\n    // right: 'center',\n    top: 0,\n    // bottom: null,\n    // 水平对齐\n    // 'auto' | 'left' | 'right'\n    // 默认为 'auto', 根据 x 的位置判断是左对齐还是右对齐\n    align: 'auto',\n    backgroundColor: 'rgba(0,0,0,0)',\n    // 图例边框颜色\n    borderColor: '#ccc',\n    borderRadius: 0,\n    // 图例边框线宽，单位px，默认为0（无边框）\n    borderWidth: 0,\n    // 图例内边距，单位px，默认各方向内边距为5，\n    // 接受数组分别设定上右下左边距，同css\n    padding: 5,\n    // 各个item之间的间隔，单位px，默认为10，\n    // 横向布局时为水平间隔，纵向布局时为纵向间隔\n    itemGap: 10,\n    // the width of legend symbol\n    itemWidth: 25,\n    // the height of legend symbol\n    itemHeight: 14,\n    // the color of unselected legend symbol\n    inactiveColor: '#ccc',\n    // the borderColor of unselected legend symbol\n    inactiveBorderColor: '#ccc',\n    itemStyle: {\n      // the default borderWidth of legend symbol\n      borderWidth: 0\n    },\n    textStyle: {\n      // 图例文字颜色\n      color: '#333'\n    },\n    // formatter: '',\n    // 选择模式，默认开启图例开关\n    selectedMode: true,\n    // 配置默认选中状态，可配合LEGEND.SELECTED事件做动态数据载入\n    // selected: null,\n    // 图例内容（详见legend.data，数组中每一项代表一个item\n    // data: [],\n    // Usage:\n    // selector: [{type: 'all or inverse', title: xxx}]\n    // or\n    // selector: true\n    // or\n    // selector: ['all', 'inverse']\n    selector: false,\n    selectorLabel: {\n      show: true,\n      borderRadius: 10,\n      padding: [3, 5, 3, 5],\n      fontSize: 12,\n      fontFamily: ' sans-serif',\n      color: '#666',\n      borderWidth: 1,\n      borderColor: '#666'\n    },\n    emphasis: {\n      selectorLabel: {\n        show: true,\n        color: '#eee',\n        backgroundColor: '#666'\n      }\n    },\n    // Value can be 'start' or 'end'\n    selectorPosition: 'auto',\n    selectorItemGap: 7,\n    selectorButtonGap: 10,\n    // Tooltip 相关配置\n    tooltip: {\n      show: false\n    }\n  }\n});\nvar _default = LegendModel;\nmodule.exports = _default;","\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n\nvar echarts = require(\"../../echarts\");\n\nvar zrUtil = require(\"zrender/lib/core/util\");\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\nfunction legendSelectActionHandler(methodName, payload, ecModel) {\n  var selectedMap = {};\n  var isToggleSelect = methodName === 'toggleSelected';\n  var isSelected; // Update all legend components\n\n  ecModel.eachComponent('legend', function (legendModel) {\n    if (isToggleSelect && isSelected != null) {\n      // Force other legend has same selected status\n      // Or the first is toggled to true and other are toggled to false\n      // In the case one legend has some item unSelected in option. And if other legend\n      // doesn't has the item, they will assume it is selected.\n      legendModel[isSelected ? 'select' : 'unSelect'](payload.name);\n    } else if (methodName === 'allSelect' || methodName === 'inverseSelect') {\n      legendModel[methodName]();\n    } else {\n      legendModel[methodName](payload.name);\n      isSelected = legendModel.isSelected(payload.name);\n    }\n\n    var legendData = legendModel.getData();\n    zrUtil.each(legendData, function (model) {\n      var name = model.get('name'); // Wrap element\n\n      if (name === '\\n' || name === '') {\n        return;\n      }\n\n      var isItemSelected = legendModel.isSelected(name);\n\n      if (selectedMap.hasOwnProperty(name)) {\n        // Unselected if any legend is unselected\n        selectedMap[name] = selectedMap[name] && isItemSelected;\n      } else {\n        selectedMap[name] = isItemSelected;\n      }\n    });\n  }); // Return the event explicitly\n\n  return methodName === 'allSelect' || methodName === 'inverseSelect' ? {\n    selected: selectedMap\n  } : {\n    name: payload.name,\n    selected: selectedMap\n  };\n}\n/**\n * @event legendToggleSelect\n * @type {Object}\n * @property {string} type 'legendToggleSelect'\n * @property {string} [from]\n * @property {string} name Series name or data item name\n */\n\n\necharts.registerAction('legendToggleSelect', 'legendselectchanged', zrUtil.curry(legendSelectActionHandler, 'toggleSelected'));\necharts.registerAction('legendAllSelect', 'legendselectall', zrUtil.curry(legendSelectActionHandler, 'allSelect'));\necharts.registerAction('legendInverseSelect', 'legendinverseselect', zrUtil.curry(legendSelectActionHandler, 'inverseSelect'));\n/**\n * @event legendSelect\n * @type {Object}\n * @property {string} type 'legendSelect'\n * @property {string} name Series name or data item name\n */\n\necharts.registerAction('legendSelect', 'legendselected', zrUtil.curry(legendSelectActionHandler, 'select'));\n/**\n * @event legendUnSelect\n * @type {Object}\n * @property {string} type 'legendUnSelect'\n * @property {string} name Series name or data item name\n */\n\necharts.registerAction('legendUnSelect', 'legendunselected', zrUtil.curry(legendSelectActionHandler, 'unSelect'));","\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n\nvar _config = require(\"../../config\");\n\nvar __DEV__ = _config.__DEV__;\n\nvar echarts = require(\"../../echarts\");\n\nvar zrUtil = require(\"zrender/lib/core/util\");\n\nvar _symbol = require(\"../../util/symbol\");\n\nvar createSymbol = _symbol.createSymbol;\n\nvar graphic = require(\"../../util/graphic\");\n\nvar _listComponent = require(\"../helper/listComponent\");\n\nvar makeBackground = _listComponent.makeBackground;\n\nvar layoutUtil = require(\"../../util/layout\");\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\nvar curry = zrUtil.curry;\nvar each = zrUtil.each;\nvar Group = graphic.Group;\n\nvar _default = echarts.extendComponentView({\n  type: 'legend.plain',\n  newlineDisabled: false,\n\n  /**\n   * @override\n   */\n  init: function () {\n    /**\n     * @private\n     * @type {module:zrender/container/Group}\n     */\n    this.group.add(this._contentGroup = new Group());\n    /**\n     * @private\n     * @type {module:zrender/Element}\n     */\n\n    this._backgroundEl;\n    /**\n     * @private\n     * @type {module:zrender/container/Group}\n     */\n\n    this.group.add(this._selectorGroup = new Group());\n    /**\n     * If first rendering, `contentGroup.position` is [0, 0], which\n     * does not make sense and may cause unexepcted animation if adopted.\n     * @private\n     * @type {boolean}\n     */\n\n    this._isFirstRender = true;\n  },\n\n  /**\n   * @protected\n   */\n  getContentGroup: function () {\n    return this._contentGroup;\n  },\n\n  /**\n   * @protected\n   */\n  getSelectorGroup: function () {\n    return this._selectorGroup;\n  },\n\n  /**\n   * @override\n   */\n  render: function (legendModel, ecModel, api) {\n    var isFirstRender = this._isFirstRender;\n    this._isFirstRender = false;\n    this.resetInner();\n\n    if (!legendModel.get('show', true)) {\n      return;\n    }\n\n    var itemAlign = legendModel.get('align');\n    var orient = legendModel.get('orient');\n\n    if (!itemAlign || itemAlign === 'auto') {\n      itemAlign = legendModel.get('left') === 'right' && orient === 'vertical' ? 'right' : 'left';\n    }\n\n    var selector = legendModel.get('selector', true);\n    var selectorPosition = legendModel.get('selectorPosition', true);\n\n    if (selector && (!selectorPosition || selectorPosition === 'auto')) {\n      selectorPosition = orient === 'horizontal' ? 'end' : 'start';\n    }\n\n    this.renderInner(itemAlign, legendModel, ecModel, api, selector, orient, selectorPosition); // Perform layout.\n\n    var positionInfo = legendModel.getBoxLayoutParams();\n    var viewportSize = {\n      width: api.getWidth(),\n      height: api.getHeight()\n    };\n    var padding = legendModel.get('padding');\n    var maxSize = layoutUtil.getLayoutRect(positionInfo, viewportSize, padding);\n    var mainRect = this.layoutInner(legendModel, itemAlign, maxSize, isFirstRender, selector, selectorPosition); // Place mainGroup, based on the calculated `mainRect`.\n\n    var layoutRect = layoutUtil.getLayoutRect(zrUtil.defaults({\n      width: mainRect.width,\n      height: mainRect.height\n    }, positionInfo), viewportSize, padding);\n    this.group.attr('position', [layoutRect.x - mainRect.x, layoutRect.y - mainRect.y]); // Render background after group is layout.\n\n    this.group.add(this._backgroundEl = makeBackground(mainRect, legendModel));\n  },\n\n  /**\n   * @protected\n   */\n  resetInner: function () {\n    this.getContentGroup().removeAll();\n    this._backgroundEl && this.group.remove(this._backgroundEl);\n    this.getSelectorGroup().removeAll();\n  },\n\n  /**\n   * @protected\n   */\n  renderInner: function (itemAlign, legendModel, ecModel, api, selector, orient, selectorPosition) {\n    var contentGroup = this.getContentGroup();\n    var legendDrawnMap = zrUtil.createHashMap();\n    var selectMode = legendModel.get('selectedMode');\n    var excludeSeriesId = [];\n    ecModel.eachRawSeries(function (seriesModel) {\n      !seriesModel.get('legendHoverLink') && excludeSeriesId.push(seriesModel.id);\n    });\n    each(legendModel.getData(), function (itemModel, dataIndex) {\n      var name = itemModel.get('name'); // Use empty string or \\n as a newline string\n\n      if (!this.newlineDisabled && (name === '' || name === '\\n')) {\n        contentGroup.add(new Group({\n          newline: true\n        }));\n        return;\n      } // Representitive series.\n\n\n      var seriesModel = ecModel.getSeriesByName(name)[0];\n\n      if (legendDrawnMap.get(name)) {\n        // Have been drawed\n        return;\n      } // Legend to control series.\n\n\n      if (seriesModel) {\n        var data = seriesModel.getData();\n        var color = data.getVisual('color');\n        var borderColor = data.getVisual('borderColor'); // If color is a callback function\n\n        if (typeof color === 'function') {\n          // Use the first data\n          color = color(seriesModel.getDataParams(0));\n        } // If borderColor is a callback function\n\n\n        if (typeof borderColor === 'function') {\n          // Use the first data\n          borderColor = borderColor(seriesModel.getDataParams(0));\n        } // Using rect symbol defaultly\n\n\n        var legendSymbolType = data.getVisual('legendSymbol') || 'roundRect';\n        var symbolType = data.getVisual('symbol');\n\n        var itemGroup = this._createItem(name, dataIndex, itemModel, legendModel, legendSymbolType, symbolType, itemAlign, color, borderColor, selectMode);\n\n        itemGroup.on('click', curry(dispatchSelectAction, name, null, api, excludeSeriesId)).on('mouseover', curry(dispatchHighlightAction, seriesModel.name, null, api, excludeSeriesId)).on('mouseout', curry(dispatchDownplayAction, seriesModel.name, null, api, excludeSeriesId));\n        legendDrawnMap.set(name, true);\n      } else {\n        // Legend to control data. In pie and funnel.\n        ecModel.eachRawSeries(function (seriesModel) {\n          // In case multiple series has same data name\n          if (legendDrawnMap.get(name)) {\n            return;\n          }\n\n          if (seriesModel.legendVisualProvider) {\n            var provider = seriesModel.legendVisualProvider;\n\n            if (!provider.containName(name)) {\n              return;\n            }\n\n            var idx = provider.indexOfName(name);\n            var color = provider.getItemVisual(idx, 'color');\n            var borderColor = provider.getItemVisual(idx, 'borderColor');\n            var legendSymbolType = 'roundRect';\n\n            var itemGroup = this._createItem(name, dataIndex, itemModel, legendModel, legendSymbolType, null, itemAlign, color, borderColor, selectMode); // FIXME: consider different series has items with the same name.\n\n\n            itemGroup.on('click', curry(dispatchSelectAction, null, name, api, excludeSeriesId)) // Should not specify the series name, consider legend controls\n            // more than one pie series.\n            .on('mouseover', curry(dispatchHighlightAction, null, name, api, excludeSeriesId)).on('mouseout', curry(dispatchDownplayAction, null, name, api, excludeSeriesId));\n            legendDrawnMap.set(name, true);\n          }\n        }, this);\n      }\n    }, this);\n\n    if (selector) {\n      this._createSelector(selector, legendModel, api, orient, selectorPosition);\n    }\n  },\n  _createSelector: function (selector, legendModel, api, orient, selectorPosition) {\n    var selectorGroup = this.getSelectorGroup();\n    each(selector, function (selectorItem) {\n      createSelectorButton(selectorItem);\n    });\n\n    function createSelectorButton(selectorItem) {\n      var type = selectorItem.type;\n      var labelText = new graphic.Text({\n        style: {\n          x: 0,\n          y: 0,\n          align: 'center',\n          verticalAlign: 'middle'\n        },\n        onclick: function () {\n          api.dispatchAction({\n            type: type === 'all' ? 'legendAllSelect' : 'legendInverseSelect'\n          });\n        }\n      });\n      selectorGroup.add(labelText);\n      var labelModel = legendModel.getModel('selectorLabel');\n      var emphasisLabelModel = legendModel.getModel('emphasis.selectorLabel');\n      graphic.setLabelStyle(labelText.style, labelText.hoverStyle = {}, labelModel, emphasisLabelModel, {\n        defaultText: selectorItem.title,\n        isRectText: false\n      });\n      graphic.setHoverStyle(labelText);\n    }\n  },\n  _createItem: function (name, dataIndex, itemModel, legendModel, legendSymbolType, symbolType, itemAlign, color, borderColor, selectMode) {\n    var itemWidth = legendModel.get('itemWidth');\n    var itemHeight = legendModel.get('itemHeight');\n    var inactiveColor = legendModel.get('inactiveColor');\n    var inactiveBorderColor = legendModel.get('inactiveBorderColor');\n    var symbolKeepAspect = legendModel.get('symbolKeepAspect');\n    var legendModelItemStyle = legendModel.getModel('itemStyle');\n    var isSelected = legendModel.isSelected(name);\n    var itemGroup = new Group();\n    var textStyleModel = itemModel.getModel('textStyle');\n    var itemIcon = itemModel.get('icon');\n    var tooltipModel = itemModel.getModel('tooltip');\n    var legendGlobalTooltipModel = tooltipModel.parentModel; // Use user given icon first\n\n    legendSymbolType = itemIcon || legendSymbolType;\n    var legendSymbol = createSymbol(legendSymbolType, 0, 0, itemWidth, itemHeight, isSelected ? color : inactiveColor, // symbolKeepAspect default true for legend\n    symbolKeepAspect == null ? true : symbolKeepAspect);\n    itemGroup.add(setSymbolStyle(legendSymbol, legendSymbolType, legendModelItemStyle, borderColor, inactiveBorderColor, isSelected)); // Compose symbols\n    // PENDING\n\n    if (!itemIcon && symbolType // At least show one symbol, can't be all none\n    && (symbolType !== legendSymbolType || symbolType === 'none')) {\n      var size = itemHeight * 0.8;\n\n      if (symbolType === 'none') {\n        symbolType = 'circle';\n      }\n\n      var legendSymbolCenter = createSymbol(symbolType, (itemWidth - size) / 2, (itemHeight - size) / 2, size, size, isSelected ? color : inactiveColor, // symbolKeepAspect default true for legend\n      symbolKeepAspect == null ? true : symbolKeepAspect); // Put symbol in the center\n\n      itemGroup.add(setSymbolStyle(legendSymbolCenter, symbolType, legendModelItemStyle, borderColor, inactiveBorderColor, isSelected));\n    }\n\n    var textX = itemAlign === 'left' ? itemWidth + 5 : -5;\n    var textAlign = itemAlign;\n    var formatter = legendModel.get('formatter');\n    var content = name;\n\n    if (typeof formatter === 'string' && formatter) {\n      content = formatter.replace('{name}', name != null ? name : '');\n    } else if (typeof formatter === 'function') {\n      content = formatter(name);\n    }\n\n    itemGroup.add(new graphic.Text({\n      style: graphic.setTextStyle({}, textStyleModel, {\n        text: content,\n        x: textX,\n        y: itemHeight / 2,\n        textFill: isSelected ? textStyleModel.getTextColor() : inactiveColor,\n        textAlign: textAlign,\n        textVerticalAlign: 'middle'\n      })\n    })); // Add a invisible rect to increase the area of mouse hover\n\n    var hitRect = new graphic.Rect({\n      shape: itemGroup.getBoundingRect(),\n      invisible: true,\n      tooltip: tooltipModel.get('show') ? zrUtil.extend({\n        content: name,\n        // Defaul formatter\n        formatter: legendGlobalTooltipModel.get('formatter', true) || function () {\n          return name;\n        },\n        formatterParams: {\n          componentType: 'legend',\n          legendIndex: legendModel.componentIndex,\n          name: name,\n          $vars: ['name']\n        }\n      }, tooltipModel.option) : null\n    });\n    itemGroup.add(hitRect);\n    itemGroup.eachChild(function (child) {\n      child.silent = true;\n    });\n    hitRect.silent = !selectMode;\n    this.getContentGroup().add(itemGroup);\n    graphic.setHoverStyle(itemGroup);\n    itemGroup.__legendDataIndex = dataIndex;\n    return itemGroup;\n  },\n\n  /**\n   * @protected\n   */\n  layoutInner: function (legendModel, itemAlign, maxSize, isFirstRender, selector, selectorPosition) {\n    var contentGroup = this.getContentGroup();\n    var selectorGroup = this.getSelectorGroup(); // Place items in contentGroup.\n\n    layoutUtil.box(legendModel.get('orient'), contentGroup, legendModel.get('itemGap'), maxSize.width, maxSize.height);\n    var contentRect = contentGroup.getBoundingRect();\n    var contentPos = [-contentRect.x, -contentRect.y];\n\n    if (selector) {\n      // Place buttons in selectorGroup\n      layoutUtil.box( // Buttons in selectorGroup always layout horizontally\n      'horizontal', selectorGroup, legendModel.get('selectorItemGap', true));\n      var selectorRect = selectorGroup.getBoundingRect();\n      var selectorPos = [-selectorRect.x, -selectorRect.y];\n      var selectorButtonGap = legendModel.get('selectorButtonGap', true);\n      var orientIdx = legendModel.getOrient().index;\n      var wh = orientIdx === 0 ? 'width' : 'height';\n      var hw = orientIdx === 0 ? 'height' : 'width';\n      var yx = orientIdx === 0 ? 'y' : 'x';\n\n      if (selectorPosition === 'end') {\n        selectorPos[orientIdx] += contentRect[wh] + selectorButtonGap;\n      } else {\n        contentPos[orientIdx] += selectorRect[wh] + selectorButtonGap;\n      } //Always align selector to content as 'middle'\n\n\n      selectorPos[1 - orientIdx] += contentRect[hw] / 2 - selectorRect[hw] / 2;\n      selectorGroup.attr('position', selectorPos);\n      contentGroup.attr('position', contentPos);\n      var mainRect = {\n        x: 0,\n        y: 0\n      };\n      mainRect[wh] = contentRect[wh] + selectorButtonGap + selectorRect[wh];\n      mainRect[hw] = Math.max(contentRect[hw], selectorRect[hw]);\n      mainRect[yx] = Math.min(0, selectorRect[yx] + selectorPos[1 - orientIdx]);\n      return mainRect;\n    } else {\n      contentGroup.attr('position', contentPos);\n      return this.group.getBoundingRect();\n    }\n  },\n\n  /**\n   * @protected\n   */\n  remove: function () {\n    this.getContentGroup().removeAll();\n    this._isFirstRender = true;\n  }\n});\n\nfunction setSymbolStyle(symbol, symbolType, legendModelItemStyle, borderColor, inactiveBorderColor, isSelected) {\n  var itemStyle;\n\n  if (symbolType !== 'line' && symbolType.indexOf('empty') < 0) {\n    itemStyle = legendModelItemStyle.getItemStyle();\n    symbol.style.stroke = borderColor;\n\n    if (!isSelected) {\n      itemStyle.stroke = inactiveBorderColor;\n    }\n  } else {\n    itemStyle = legendModelItemStyle.getItemStyle(['borderWidth', 'borderColor']);\n  }\n\n  return symbol.setStyle(itemStyle);\n}\n\nfunction dispatchSelectAction(seriesName, dataName, api, excludeSeriesId) {\n  // downplay before unselect\n  dispatchDownplayAction(seriesName, dataName, api, excludeSeriesId);\n  api.dispatchAction({\n    type: 'legendToggleSelect',\n    name: seriesName != null ? seriesName : dataName\n  }); // highlight after select\n\n  dispatchHighlightAction(seriesName, dataName, api, excludeSeriesId);\n}\n\nfunction dispatchHighlightAction(seriesName, dataName, api, excludeSeriesId) {\n  // If element hover will move to a hoverLayer.\n  var el = api.getZr().storage.getDisplayList()[0];\n\n  if (!(el && el.useHoverLayer)) {\n    api.dispatchAction({\n      type: 'highlight',\n      seriesName: seriesName,\n      name: dataName,\n      excludeSeriesId: excludeSeriesId\n    });\n  }\n}\n\nfunction dispatchDownplayAction(seriesName, dataName, api, excludeSeriesId) {\n  // If element hover will move to a hoverLayer.\n  var el = api.getZr().storage.getDisplayList()[0];\n\n  if (!(el && el.useHoverLayer)) {\n    api.dispatchAction({\n      type: 'downplay',\n      seriesName: seriesName,\n      name: dataName,\n      excludeSeriesId: excludeSeriesId\n    });\n  }\n}\n\nmodule.exports = _default;","\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n\nvar _layout = require(\"../../util/layout\");\n\nvar getLayoutRect = _layout.getLayoutRect;\nvar layoutBox = _layout.box;\nvar positionElement = _layout.positionElement;\n\nvar formatUtil = require(\"../../util/format\");\n\nvar graphic = require(\"../../util/graphic\");\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n\n/**\n * Layout list like component.\n * It will box layout each items in group of component and then position the whole group in the viewport\n * @param {module:zrender/group/Group} group\n * @param {module:echarts/model/Component} componentModel\n * @param {module:echarts/ExtensionAPI}\n */\nfunction layout(group, componentModel, api) {\n  var boxLayoutParams = componentModel.getBoxLayoutParams();\n  var padding = componentModel.get('padding');\n  var viewportSize = {\n    width: api.getWidth(),\n    height: api.getHeight()\n  };\n  var rect = getLayoutRect(boxLayoutParams, viewportSize, padding);\n  layoutBox(componentModel.get('orient'), group, componentModel.get('itemGap'), rect.width, rect.height);\n  positionElement(group, boxLayoutParams, viewportSize, padding);\n}\n\nfunction makeBackground(rect, componentModel) {\n  var padding = formatUtil.normalizeCssArray(componentModel.get('padding'));\n  var style = componentModel.getItemStyle(['color', 'opacity']);\n  style.fill = componentModel.get('backgroundColor');\n  var rect = new graphic.Rect({\n    shape: {\n      x: rect.x - padding[3],\n      y: rect.y - padding[0],\n      width: rect.width + padding[1] + padding[3],\n      height: rect.height + padding[0] + padding[2],\n      r: componentModel.get('borderRadius')\n    },\n    style: style,\n    silent: true,\n    z2: -1\n  }); // FIXME\n  // `subPixelOptimizeRect` may bring some gap between edge of viewpart\n  // and background rect when setting like `left: 0`, `top: 0`.\n  // graphic.subPixelOptimizeRect(rect);\n\n  return rect;\n}\n\nexports.layout = layout;\nexports.makeBackground = makeBackground;","\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\nfunction _default(ecModel) {\n  var legendModels = ecModel.findComponents({\n    mainType: 'legend'\n  });\n\n  if (legendModels && legendModels.length) {\n    ecModel.filterSeries(function (series) {\n      // If in any legend component the status is not selected.\n      // Because in legend series is assumed selected when it is not in the legend data.\n      for (var i = 0; i < legendModels.length; i++) {\n        if (!legendModels[i].isSelected(series.name)) {\n          return false;\n        }\n      }\n\n      return true;\n    });\n  }\n}\n\nmodule.exports = _default;","\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n\nvar echarts = require(\"../echarts\");\n\nrequire(\"./axisPointer\");\n\nrequire(\"./tooltip/TooltipModel\");\n\nrequire(\"./tooltip/TooltipView\");\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n// FIXME Better way to pack data in graphic element\n\n/**\n * @action\n * @property {string} type\n * @property {number} seriesIndex\n * @property {number} dataIndex\n * @property {number} [x]\n * @property {number} [y]\n */\necharts.registerAction({\n  type: 'showTip',\n  event: 'showTip',\n  update: 'tooltip:manuallyShowTip'\n}, // noop\nfunction () {});\necharts.registerAction({\n  type: 'hideTip',\n  event: 'hideTip',\n  update: 'tooltip:manuallyHideTip'\n}, // noop\nfunction () {});","\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n\nvar zrUtil = require(\"zrender/lib/core/util\");\n\nvar echarts = require(\"../echarts\");\n\nvar graphic = require(\"../util/graphic\");\n\nvar _layout = require(\"../util/layout\");\n\nvar getLayoutRect = _layout.getLayoutRect;\n\nvar _format = require(\"../util/format\");\n\nvar windowOpen = _format.windowOpen;\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n// Model\necharts.extendComponentModel({\n  type: 'title',\n  layoutMode: {\n    type: 'box',\n    ignoreSize: true\n  },\n  defaultOption: {\n    // 一级层叠\n    zlevel: 0,\n    // 二级层叠\n    z: 6,\n    show: true,\n    text: '',\n    // 超链接跳转\n    // link: null,\n    // 仅支持self | blank\n    target: 'blank',\n    subtext: '',\n    // 超链接跳转\n    // sublink: null,\n    // 仅支持self | blank\n    subtarget: 'blank',\n    // 'center' ¦ 'left' ¦ 'right'\n    // ¦ {number}（x坐标，单位px）\n    left: 0,\n    // 'top' ¦ 'bottom' ¦ 'center'\n    // ¦ {number}（y坐标，单位px）\n    top: 0,\n    // 水平对齐\n    // 'auto' | 'left' | 'right' | 'center'\n    // 默认根据 left 的位置判断是左对齐还是右对齐\n    // textAlign: null\n    //\n    // 垂直对齐\n    // 'auto' | 'top' | 'bottom' | 'middle'\n    // 默认根据 top 位置判断是上对齐还是下对齐\n    // textVerticalAlign: null\n    // textBaseline: null // The same as textVerticalAlign.\n    backgroundColor: 'rgba(0,0,0,0)',\n    // 标题边框颜色\n    borderColor: '#ccc',\n    // 标题边框线宽，单位px，默认为0（无边框）\n    borderWidth: 0,\n    // 标题内边距，单位px，默认各方向内边距为5，\n    // 接受数组分别设定上右下左边距，同css\n    padding: 5,\n    // 主副标题纵向间隔，单位px，默认为10，\n    itemGap: 10,\n    textStyle: {\n      fontSize: 18,\n      fontWeight: 'bolder',\n      color: '#333'\n    },\n    subtextStyle: {\n      color: '#aaa'\n    }\n  }\n}); // View\n\necharts.extendComponentView({\n  type: 'title',\n  render: function (titleModel, ecModel, api) {\n    this.group.removeAll();\n\n    if (!titleModel.get('show')) {\n      return;\n    }\n\n    var group = this.group;\n    var textStyleModel = titleModel.getModel('textStyle');\n    var subtextStyleModel = titleModel.getModel('subtextStyle');\n    var textAlign = titleModel.get('textAlign');\n    var textVerticalAlign = zrUtil.retrieve2(titleModel.get('textBaseline'), titleModel.get('textVerticalAlign'));\n    var textEl = new graphic.Text({\n      style: graphic.setTextStyle({}, textStyleModel, {\n        text: titleModel.get('text'),\n        textFill: textStyleModel.getTextColor()\n      }, {\n        disableBox: true\n      }),\n      z2: 10\n    });\n    var textRect = textEl.getBoundingRect();\n    var subText = titleModel.get('subtext');\n    var subTextEl = new graphic.Text({\n      style: graphic.setTextStyle({}, subtextStyleModel, {\n        text: subText,\n        textFill: subtextStyleModel.getTextColor(),\n        y: textRect.height + titleModel.get('itemGap'),\n        textVerticalAlign: 'top'\n      }, {\n        disableBox: true\n      }),\n      z2: 10\n    });\n    var link = titleModel.get('link');\n    var sublink = titleModel.get('sublink');\n    var triggerEvent = titleModel.get('triggerEvent', true);\n    textEl.silent = !link && !triggerEvent;\n    subTextEl.silent = !sublink && !triggerEvent;\n\n    if (link) {\n      textEl.on('click', function () {\n        windowOpen(link, '_' + titleModel.get('target'));\n      });\n    }\n\n    if (sublink) {\n      subTextEl.on('click', function () {\n        windowOpen(sublink, '_' + titleModel.get('subtarget'));\n      });\n    }\n\n    textEl.eventData = subTextEl.eventData = triggerEvent ? {\n      componentType: 'title',\n      componentIndex: titleModel.componentIndex\n    } : null;\n    group.add(textEl);\n    subText && group.add(subTextEl); // If no subText, but add subTextEl, there will be an empty line.\n\n    var groupRect = group.getBoundingRect();\n    var layoutOption = titleModel.getBoxLayoutParams();\n    layoutOption.width = groupRect.width;\n    layoutOption.height = groupRect.height;\n    var layoutRect = getLayoutRect(layoutOption, {\n      width: api.getWidth(),\n      height: api.getHeight()\n    }, titleModel.get('padding')); // Adjust text align based on position\n\n    if (!textAlign) {\n      // Align left if title is on the left. center and right is same\n      textAlign = titleModel.get('left') || titleModel.get('right');\n\n      if (textAlign === 'middle') {\n        textAlign = 'center';\n      } // Adjust layout by text align\n\n\n      if (textAlign === 'right') {\n        layoutRect.x += layoutRect.width;\n      } else if (textAlign === 'center') {\n        layoutRect.x += layoutRect.width / 2;\n      }\n    }\n\n    if (!textVerticalAlign) {\n      textVerticalAlign = titleModel.get('top') || titleModel.get('bottom');\n\n      if (textVerticalAlign === 'center') {\n        textVerticalAlign = 'middle';\n      }\n\n      if (textVerticalAlign === 'bottom') {\n        layoutRect.y += layoutRect.height;\n      } else if (textVerticalAlign === 'middle') {\n        layoutRect.y += layoutRect.height / 2;\n      }\n\n      textVerticalAlign = textVerticalAlign || 'top';\n    }\n\n    group.attr('position', [layoutRect.x, layoutRect.y]);\n    var alignStyle = {\n      textAlign: textAlign,\n      textVerticalAlign: textVerticalAlign\n    };\n    textEl.setStyle(alignStyle);\n    subTextEl.setStyle(alignStyle); // Render background\n    // Get groupRect again because textAlign has been changed\n\n    groupRect = group.getBoundingRect();\n    var padding = layoutRect.margin;\n    var style = titleModel.getItemStyle(['color', 'opacity']);\n    style.fill = titleModel.get('backgroundColor');\n    var rect = new graphic.Rect({\n      shape: {\n        x: groupRect.x - padding[3],\n        y: groupRect.y - padding[0],\n        width: groupRect.width + padding[1] + padding[3],\n        height: groupRect.height + padding[0] + padding[2],\n        r: titleModel.get('borderRadius')\n      },\n      style: style,\n      subPixelOptimize: true,\n      silent: true\n    });\n    group.add(rect);\n  }\n});","\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n\nvar echarts = require(\"../echarts\");\n\nrequire(\"./legend/LegendModel\");\n\nrequire(\"./legend/legendAction\");\n\nrequire(\"./legend/LegendView\");\n\nvar legendFilter = require(\"./legend/legendFilter\");\n\nvar Component = require(\"../model/Component\");\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n// Do not contain scrollable legend, for sake of file size.\n// Series Filter\necharts.registerProcessor(echarts.PRIORITY.PROCESSOR.SERIES_FILTER, legendFilter);\nComponent.registerSubTypeDefaulter('legend', function () {\n  // Default 'plain' when no type specified.\n  return 'plain';\n});","\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n\nvar echarts = require(\"../echarts\");\n\nvar zrUtil = require(\"zrender/lib/core/util\");\n\nvar graphic = require(\"../util/graphic\");\n\nrequire(\"../coord/cartesian/Grid\");\n\nrequire(\"./axis\");\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n// Grid view\necharts.extendComponentView({\n  type: 'grid',\n  render: function (gridModel, ecModel) {\n    this.group.removeAll();\n\n    if (gridModel.get('show')) {\n      this.group.add(new graphic.Rect({\n        shape: gridModel.coordinateSystem.getRect(),\n        style: zrUtil.defaults({\n          fill: gridModel.get('backgroundColor')\n        }, gridModel.getItemStyle()),\n        silent: true,\n        z2: -1\n      }));\n    }\n  }\n});\necharts.registerPreprocessor(function (option) {\n  // Only create grid when need\n  if (option.xAxis && option.yAxis && !option.grid) {\n    option.grid = {};\n  }\n});","\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n\nvar zrUtil = require(\"zrender/lib/core/util\");\n\nvar Model = require(\"../../model/Model\");\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\nvar each = zrUtil.each;\nvar curry = zrUtil.curry; // Build axisPointerModel, mergin tooltip.axisPointer model for each axis.\n// allAxesInfo should be updated when setOption performed.\n\nfunction collect(ecModel, api) {\n  var result = {\n    /**\n     * key: makeKey(axis.model)\n     * value: {\n     *      axis,\n     *      coordSys,\n     *      axisPointerModel,\n     *      triggerTooltip,\n     *      involveSeries,\n     *      snap,\n     *      seriesModels,\n     *      seriesDataCount\n     * }\n     */\n    axesInfo: {},\n    seriesInvolved: false,\n\n    /**\n     * key: makeKey(coordSys.model)\n     * value: Object: key makeKey(axis.model), value: axisInfo\n     */\n    coordSysAxesInfo: {},\n    coordSysMap: {}\n  };\n  collectAxesInfo(result, ecModel, api); // Check seriesInvolved for performance, in case too many series in some chart.\n\n  result.seriesInvolved && collectSeriesInfo(result, ecModel);\n  return result;\n}\n\nfunction collectAxesInfo(result, ecModel, api) {\n  var globalTooltipModel = ecModel.getComponent('tooltip');\n  var globalAxisPointerModel = ecModel.getComponent('axisPointer'); // links can only be set on global.\n\n  var linksOption = globalAxisPointerModel.get('link', true) || [];\n  var linkGroups = []; // Collect axes info.\n\n  each(api.getCoordinateSystems(), function (coordSys) {\n    // Some coordinate system do not support axes, like geo.\n    if (!coordSys.axisPointerEnabled) {\n      return;\n    }\n\n    var coordSysKey = makeKey(coordSys.model);\n    var axesInfoInCoordSys = result.coordSysAxesInfo[coordSysKey] = {};\n    result.coordSysMap[coordSysKey] = coordSys; // Set tooltip (like 'cross') is a convienent way to show axisPointer\n    // for user. So we enable seting tooltip on coordSys model.\n\n    var coordSysModel = coordSys.model;\n    var baseTooltipModel = coordSysModel.getModel('tooltip', globalTooltipModel);\n    each(coordSys.getAxes(), curry(saveTooltipAxisInfo, false, null)); // If axis tooltip used, choose tooltip axis for each coordSys.\n    // Notice this case: coordSys is `grid` but not `cartesian2D` here.\n\n    if (coordSys.getTooltipAxes && globalTooltipModel // If tooltip.showContent is set as false, tooltip will not\n    // show but axisPointer will show as normal.\n    && baseTooltipModel.get('show')) {\n      // Compatible with previous logic. But series.tooltip.trigger: 'axis'\n      // or series.data[n].tooltip.trigger: 'axis' are not support any more.\n      var triggerAxis = baseTooltipModel.get('trigger') === 'axis';\n      var cross = baseTooltipModel.get('axisPointer.type') === 'cross';\n      var tooltipAxes = coordSys.getTooltipAxes(baseTooltipModel.get('axisPointer.axis'));\n\n      if (triggerAxis || cross) {\n        each(tooltipAxes.baseAxes, curry(saveTooltipAxisInfo, cross ? 'cross' : true, triggerAxis));\n      }\n\n      if (cross) {\n        each(tooltipAxes.otherAxes, curry(saveTooltipAxisInfo, 'cross', false));\n      }\n    } // fromTooltip: true | false | 'cross'\n    // triggerTooltip: true | false | null\n\n\n    function saveTooltipAxisInfo(fromTooltip, triggerTooltip, axis) {\n      var axisPointerModel = axis.model.getModel('axisPointer', globalAxisPointerModel);\n      var axisPointerShow = axisPointerModel.get('show');\n\n      if (!axisPointerShow || axisPointerShow === 'auto' && !fromTooltip && !isHandleTrigger(axisPointerModel)) {\n        return;\n      }\n\n      if (triggerTooltip == null) {\n        triggerTooltip = axisPointerModel.get('triggerTooltip');\n      }\n\n      axisPointerModel = fromTooltip ? makeAxisPointerModel(axis, baseTooltipModel, globalAxisPointerModel, ecModel, fromTooltip, triggerTooltip) : axisPointerModel;\n      var snap = axisPointerModel.get('snap');\n      var key = makeKey(axis.model);\n      var involveSeries = triggerTooltip || snap || axis.type === 'category'; // If result.axesInfo[key] exist, override it (tooltip has higher priority).\n\n      var axisInfo = result.axesInfo[key] = {\n        key: key,\n        axis: axis,\n        coordSys: coordSys,\n        axisPointerModel: axisPointerModel,\n        triggerTooltip: triggerTooltip,\n        involveSeries: involveSeries,\n        snap: snap,\n        useHandle: isHandleTrigger(axisPointerModel),\n        seriesModels: []\n      };\n      axesInfoInCoordSys[key] = axisInfo;\n      result.seriesInvolved |= involveSeries;\n      var groupIndex = getLinkGroupIndex(linksOption, axis);\n\n      if (groupIndex != null) {\n        var linkGroup = linkGroups[groupIndex] || (linkGroups[groupIndex] = {\n          axesInfo: {}\n        });\n        linkGroup.axesInfo[key] = axisInfo;\n        linkGroup.mapper = linksOption[groupIndex].mapper;\n        axisInfo.linkGroup = linkGroup;\n      }\n    }\n  });\n}\n\nfunction makeAxisPointerModel(axis, baseTooltipModel, globalAxisPointerModel, ecModel, fromTooltip, triggerTooltip) {\n  var tooltipAxisPointerModel = baseTooltipModel.getModel('axisPointer');\n  var volatileOption = {};\n  each(['type', 'snap', 'lineStyle', 'shadowStyle', 'label', 'animation', 'animationDurationUpdate', 'animationEasingUpdate', 'z'], function (field) {\n    volatileOption[field] = zrUtil.clone(tooltipAxisPointerModel.get(field));\n  }); // category axis do not auto snap, otherwise some tick that do not\n  // has value can not be hovered. value/time/log axis default snap if\n  // triggered from tooltip and trigger tooltip.\n\n  volatileOption.snap = axis.type !== 'category' && !!triggerTooltip; // Compatibel with previous behavior, tooltip axis do not show label by default.\n  // Only these properties can be overrided from tooltip to axisPointer.\n\n  if (tooltipAxisPointerModel.get('type') === 'cross') {\n    volatileOption.type = 'line';\n  }\n\n  var labelOption = volatileOption.label || (volatileOption.label = {}); // Follow the convention, do not show label when triggered by tooltip by default.\n\n  labelOption.show == null && (labelOption.show = false);\n\n  if (fromTooltip === 'cross') {\n    // When 'cross', both axes show labels.\n    var tooltipAxisPointerLabelShow = tooltipAxisPointerModel.get('label.show');\n    labelOption.show = tooltipAxisPointerLabelShow != null ? tooltipAxisPointerLabelShow : true; // If triggerTooltip, this is a base axis, which should better not use cross style\n    // (cross style is dashed by default)\n\n    if (!triggerTooltip) {\n      var crossStyle = volatileOption.lineStyle = tooltipAxisPointerModel.get('crossStyle');\n      crossStyle && zrUtil.defaults(labelOption, crossStyle.textStyle);\n    }\n  }\n\n  return axis.model.getModel('axisPointer', new Model(volatileOption, globalAxisPointerModel, ecModel));\n}\n\nfunction collectSeriesInfo(result, ecModel) {\n  // Prepare data for axis trigger\n  ecModel.eachSeries(function (seriesModel) {\n    // Notice this case: this coordSys is `cartesian2D` but not `grid`.\n    var coordSys = seriesModel.coordinateSystem;\n    var seriesTooltipTrigger = seriesModel.get('tooltip.trigger', true);\n    var seriesTooltipShow = seriesModel.get('tooltip.show', true);\n\n    if (!coordSys || seriesTooltipTrigger === 'none' || seriesTooltipTrigger === false || seriesTooltipTrigger === 'item' || seriesTooltipShow === false || seriesModel.get('axisPointer.show', true) === false) {\n      return;\n    }\n\n    each(result.coordSysAxesInfo[makeKey(coordSys.model)], function (axisInfo) {\n      var axis = axisInfo.axis;\n\n      if (coordSys.getAxis(axis.dim) === axis) {\n        axisInfo.seriesModels.push(seriesModel);\n        axisInfo.seriesDataCount == null && (axisInfo.seriesDataCount = 0);\n        axisInfo.seriesDataCount += seriesModel.getData().count();\n      }\n    });\n  }, this);\n}\n/**\n * For example:\n * {\n *     axisPointer: {\n *         links: [{\n *             xAxisIndex: [2, 4],\n *             yAxisIndex: 'all'\n *         }, {\n *             xAxisId: ['a5', 'a7'],\n *             xAxisName: 'xxx'\n *         }]\n *     }\n * }\n */\n\n\nfunction getLinkGroupIndex(linksOption, axis) {\n  var axisModel = axis.model;\n  var dim = axis.dim;\n\n  for (var i = 0; i < linksOption.length; i++) {\n    var linkOption = linksOption[i] || {};\n\n    if (checkPropInLink(linkOption[dim + 'AxisId'], axisModel.id) || checkPropInLink(linkOption[dim + 'AxisIndex'], axisModel.componentIndex) || checkPropInLink(linkOption[dim + 'AxisName'], axisModel.name)) {\n      return i;\n    }\n  }\n}\n\nfunction checkPropInLink(linkPropValue, axisPropValue) {\n  return linkPropValue === 'all' || zrUtil.isArray(linkPropValue) && zrUtil.indexOf(linkPropValue, axisPropValue) >= 0 || linkPropValue === axisPropValue;\n}\n\nfunction fixValue(axisModel) {\n  var axisInfo = getAxisInfo(axisModel);\n\n  if (!axisInfo) {\n    return;\n  }\n\n  var axisPointerModel = axisInfo.axisPointerModel;\n  var scale = axisInfo.axis.scale;\n  var option = axisPointerModel.option;\n  var status = axisPointerModel.get('status');\n  var value = axisPointerModel.get('value'); // Parse init value for category and time axis.\n\n  if (value != null) {\n    value = scale.parse(value);\n  }\n\n  var useHandle = isHandleTrigger(axisPointerModel); // If `handle` used, `axisPointer` will always be displayed, so value\n  // and status should be initialized.\n\n  if (status == null) {\n    option.status = useHandle ? 'show' : 'hide';\n  }\n\n  var extent = scale.getExtent().slice();\n  extent[0] > extent[1] && extent.reverse();\n\n  if ( // Pick a value on axis when initializing.\n  value == null // If both `handle` and `dataZoom` are used, value may be out of axis extent,\n  // where we should re-pick a value to keep `handle` displaying normally.\n  || value > extent[1]) {\n    // Make handle displayed on the end of the axis when init, which looks better.\n    value = extent[1];\n  }\n\n  if (value < extent[0]) {\n    value = extent[0];\n  }\n\n  option.value = value;\n\n  if (useHandle) {\n    option.status = axisInfo.axis.scale.isBlank() ? 'hide' : 'show';\n  }\n}\n\nfunction getAxisInfo(axisModel) {\n  var coordSysAxesInfo = (axisModel.ecModel.getComponent('axisPointer') || {}).coordSysAxesInfo;\n  return coordSysAxesInfo && coordSysAxesInfo.axesInfo[makeKey(axisModel)];\n}\n\nfunction getAxisPointerModel(axisModel) {\n  var axisInfo = getAxisInfo(axisModel);\n  return axisInfo && axisInfo.axisPointerModel;\n}\n\nfunction isHandleTrigger(axisPointerModel) {\n  return !!axisPointerModel.get('handle.show');\n}\n/**\n * @param {module:echarts/model/Model} model\n * @return {string} unique key\n */\n\n\nfunction makeKey(model) {\n  return model.type + '||' + model.id;\n}\n\nexports.collect = collect;\nexports.fixValue = fixValue;\nexports.getAxisInfo = getAxisInfo;\nexports.getAxisPointerModel = getAxisPointerModel;\nexports.makeKey = makeKey;","\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n\nvar _config = require(\"../../config\");\n\nvar __DEV__ = _config.__DEV__;\n\nvar _util = require(\"zrender/lib/core/util\");\n\nvar isObject = _util.isObject;\nvar each = _util.each;\nvar map = _util.map;\nvar indexOf = _util.indexOf;\nvar retrieve = _util.retrieve;\n\nvar _layout = require(\"../../util/layout\");\n\nvar getLayoutRect = _layout.getLayoutRect;\n\nvar _axisHelper = require(\"../../coord/axisHelper\");\n\nvar createScaleByModel = _axisHelper.createScaleByModel;\nvar ifAxisCrossZero = _axisHelper.ifAxisCrossZero;\nvar niceScaleExtent = _axisHelper.niceScaleExtent;\nvar estimateLabelUnionRect = _axisHelper.estimateLabelUnionRect;\n\nvar Cartesian2D = require(\"./Cartesian2D\");\n\nvar Axis2D = require(\"./Axis2D\");\n\nvar CoordinateSystem = require(\"../../CoordinateSystem\");\n\nvar _dataStackHelper = require(\"../../data/helper/dataStackHelper\");\n\nvar getStackedDimension = _dataStackHelper.getStackedDimension;\n\nrequire(\"./GridModel\");\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n\n/**\n * Grid is a region which contains at most 4 cartesian systems\n *\n * TODO Default cartesian\n */\n// Depends on GridModel, AxisModel, which performs preprocess.\n\n/**\n * Check if the axis is used in the specified grid\n * @inner\n */\nfunction isAxisUsedInTheGrid(axisModel, gridModel, ecModel) {\n  return axisModel.getCoordSysModel() === gridModel;\n}\n\nfunction Grid(gridModel, ecModel, api) {\n  /**\n   * @type {Object.<string, module:echarts/coord/cartesian/Cartesian2D>}\n   * @private\n   */\n  this._coordsMap = {};\n  /**\n   * @type {Array.<module:echarts/coord/cartesian/Cartesian>}\n   * @private\n   */\n\n  this._coordsList = [];\n  /**\n   * @type {Object.<string, Array.<module:echarts/coord/cartesian/Axis2D>>}\n   * @private\n   */\n\n  this._axesMap = {};\n  /**\n   * @type {Array.<module:echarts/coord/cartesian/Axis2D>}\n   * @private\n   */\n\n  this._axesList = [];\n\n  this._initCartesian(gridModel, ecModel, api);\n\n  this.model = gridModel;\n}\n\nvar gridProto = Grid.prototype;\ngridProto.type = 'grid';\ngridProto.axisPointerEnabled = true;\n\ngridProto.getRect = function () {\n  return this._rect;\n};\n\ngridProto.update = function (ecModel, api) {\n  var axesMap = this._axesMap;\n\n  this._updateScale(ecModel, this.model);\n\n  each(axesMap.x, function (xAxis) {\n    niceScaleExtent(xAxis.scale, xAxis.model);\n  });\n  each(axesMap.y, function (yAxis) {\n    niceScaleExtent(yAxis.scale, yAxis.model);\n  }); // Key: axisDim_axisIndex, value: boolean, whether onZero target.\n\n  var onZeroRecords = {};\n  each(axesMap.x, function (xAxis) {\n    fixAxisOnZero(axesMap, 'y', xAxis, onZeroRecords);\n  });\n  each(axesMap.y, function (yAxis) {\n    fixAxisOnZero(axesMap, 'x', yAxis, onZeroRecords);\n  }); // Resize again if containLabel is enabled\n  // FIXME It may cause getting wrong grid size in data processing stage\n\n  this.resize(this.model, api);\n};\n\nfunction fixAxisOnZero(axesMap, otherAxisDim, axis, onZeroRecords) {\n  axis.getAxesOnZeroOf = function () {\n    // TODO: onZero of multiple axes.\n    return otherAxisOnZeroOf ? [otherAxisOnZeroOf] : [];\n  }; // onZero can not be enabled in these two situations:\n  // 1. When any other axis is a category axis.\n  // 2. When no axis is cross 0 point.\n\n\n  var otherAxes = axesMap[otherAxisDim];\n  var otherAxisOnZeroOf;\n  var axisModel = axis.model;\n  var onZero = axisModel.get('axisLine.onZero');\n  var onZeroAxisIndex = axisModel.get('axisLine.onZeroAxisIndex');\n\n  if (!onZero) {\n    return;\n  } // If target axis is specified.\n\n\n  if (onZeroAxisIndex != null) {\n    if (canOnZeroToAxis(otherAxes[onZeroAxisIndex])) {\n      otherAxisOnZeroOf = otherAxes[onZeroAxisIndex];\n    }\n  } else {\n    // Find the first available other axis.\n    for (var idx in otherAxes) {\n      if (otherAxes.hasOwnProperty(idx) && canOnZeroToAxis(otherAxes[idx]) // Consider that two Y axes on one value axis,\n      // if both onZero, the two Y axes overlap.\n      && !onZeroRecords[getOnZeroRecordKey(otherAxes[idx])]) {\n        otherAxisOnZeroOf = otherAxes[idx];\n        break;\n      }\n    }\n  }\n\n  if (otherAxisOnZeroOf) {\n    onZeroRecords[getOnZeroRecordKey(otherAxisOnZeroOf)] = true;\n  }\n\n  function getOnZeroRecordKey(axis) {\n    return axis.dim + '_' + axis.index;\n  }\n}\n\nfunction canOnZeroToAxis(axis) {\n  return axis && axis.type !== 'category' && axis.type !== 'time' && ifAxisCrossZero(axis);\n}\n/**\n * Resize the grid\n * @param {module:echarts/coord/cartesian/GridModel} gridModel\n * @param {module:echarts/ExtensionAPI} api\n */\n\n\ngridProto.resize = function (gridModel, api, ignoreContainLabel) {\n  var gridRect = getLayoutRect(gridModel.getBoxLayoutParams(), {\n    width: api.getWidth(),\n    height: api.getHeight()\n  });\n  this._rect = gridRect;\n  var axesList = this._axesList;\n  adjustAxes(); // Minus label size\n\n  if (!ignoreContainLabel && gridModel.get('containLabel')) {\n    each(axesList, function (axis) {\n      if (!axis.model.get('axisLabel.inside')) {\n        var labelUnionRect = estimateLabelUnionRect(axis);\n\n        if (labelUnionRect) {\n          var dim = axis.isHorizontal() ? 'height' : 'width';\n          var margin = axis.model.get('axisLabel.margin');\n          gridRect[dim] -= labelUnionRect[dim] + margin;\n\n          if (axis.position === 'top') {\n            gridRect.y += labelUnionRect.height + margin;\n          } else if (axis.position === 'left') {\n            gridRect.x += labelUnionRect.width + margin;\n          }\n        }\n      }\n    });\n    adjustAxes();\n  }\n\n  function adjustAxes() {\n    each(axesList, function (axis) {\n      var isHorizontal = axis.isHorizontal();\n      var extent = isHorizontal ? [0, gridRect.width] : [0, gridRect.height];\n      var idx = axis.inverse ? 1 : 0;\n      axis.setExtent(extent[idx], extent[1 - idx]);\n      updateAxisTransform(axis, isHorizontal ? gridRect.x : gridRect.y);\n    });\n  }\n};\n/**\n * @param {string} axisType\n * @param {number} [axisIndex]\n */\n\n\ngridProto.getAxis = function (axisType, axisIndex) {\n  var axesMapOnDim = this._axesMap[axisType];\n\n  if (axesMapOnDim != null) {\n    if (axisIndex == null) {\n      // Find first axis\n      for (var name in axesMapOnDim) {\n        if (axesMapOnDim.hasOwnProperty(name)) {\n          return axesMapOnDim[name];\n        }\n      }\n    }\n\n    return axesMapOnDim[axisIndex];\n  }\n};\n/**\n * @return {Array.<module:echarts/coord/Axis>}\n */\n\n\ngridProto.getAxes = function () {\n  return this._axesList.slice();\n};\n/**\n * Usage:\n *      grid.getCartesian(xAxisIndex, yAxisIndex);\n *      grid.getCartesian(xAxisIndex);\n *      grid.getCartesian(null, yAxisIndex);\n *      grid.getCartesian({xAxisIndex: ..., yAxisIndex: ...});\n *\n * @param {number|Object} [xAxisIndex]\n * @param {number} [yAxisIndex]\n */\n\n\ngridProto.getCartesian = function (xAxisIndex, yAxisIndex) {\n  if (xAxisIndex != null && yAxisIndex != null) {\n    var key = 'x' + xAxisIndex + 'y' + yAxisIndex;\n    return this._coordsMap[key];\n  }\n\n  if (isObject(xAxisIndex)) {\n    yAxisIndex = xAxisIndex.yAxisIndex;\n    xAxisIndex = xAxisIndex.xAxisIndex;\n  } // When only xAxisIndex or yAxisIndex given, find its first cartesian.\n\n\n  for (var i = 0, coordList = this._coordsList; i < coordList.length; i++) {\n    if (coordList[i].getAxis('x').index === xAxisIndex || coordList[i].getAxis('y').index === yAxisIndex) {\n      return coordList[i];\n    }\n  }\n};\n\ngridProto.getCartesians = function () {\n  return this._coordsList.slice();\n};\n/**\n * @implements\n * see {module:echarts/CoodinateSystem}\n */\n\n\ngridProto.convertToPixel = function (ecModel, finder, value) {\n  var target = this._findConvertTarget(ecModel, finder);\n\n  return target.cartesian ? target.cartesian.dataToPoint(value) : target.axis ? target.axis.toGlobalCoord(target.axis.dataToCoord(value)) : null;\n};\n/**\n * @implements\n * see {module:echarts/CoodinateSystem}\n */\n\n\ngridProto.convertFromPixel = function (ecModel, finder, value) {\n  var target = this._findConvertTarget(ecModel, finder);\n\n  return target.cartesian ? target.cartesian.pointToData(value) : target.axis ? target.axis.coordToData(target.axis.toLocalCoord(value)) : null;\n};\n/**\n * @inner\n */\n\n\ngridProto._findConvertTarget = function (ecModel, finder) {\n  var seriesModel = finder.seriesModel;\n  var xAxisModel = finder.xAxisModel || seriesModel && seriesModel.getReferringComponents('xAxis')[0];\n  var yAxisModel = finder.yAxisModel || seriesModel && seriesModel.getReferringComponents('yAxis')[0];\n  var gridModel = finder.gridModel;\n  var coordsList = this._coordsList;\n  var cartesian;\n  var axis;\n\n  if (seriesModel) {\n    cartesian = seriesModel.coordinateSystem;\n    indexOf(coordsList, cartesian) < 0 && (cartesian = null);\n  } else if (xAxisModel && yAxisModel) {\n    cartesian = this.getCartesian(xAxisModel.componentIndex, yAxisModel.componentIndex);\n  } else if (xAxisModel) {\n    axis = this.getAxis('x', xAxisModel.componentIndex);\n  } else if (yAxisModel) {\n    axis = this.getAxis('y', yAxisModel.componentIndex);\n  } // Lowest priority.\n  else if (gridModel) {\n      var grid = gridModel.coordinateSystem;\n\n      if (grid === this) {\n        cartesian = this._coordsList[0];\n      }\n    }\n\n  return {\n    cartesian: cartesian,\n    axis: axis\n  };\n};\n/**\n * @implements\n * see {module:echarts/CoodinateSystem}\n */\n\n\ngridProto.containPoint = function (point) {\n  var coord = this._coordsList[0];\n\n  if (coord) {\n    return coord.containPoint(point);\n  }\n};\n/**\n * Initialize cartesian coordinate systems\n * @private\n */\n\n\ngridProto._initCartesian = function (gridModel, ecModel, api) {\n  var axisPositionUsed = {\n    left: false,\n    right: false,\n    top: false,\n    bottom: false\n  };\n  var axesMap = {\n    x: {},\n    y: {}\n  };\n  var axesCount = {\n    x: 0,\n    y: 0\n  }; /// Create axis\n\n  ecModel.eachComponent('xAxis', createAxisCreator('x'), this);\n  ecModel.eachComponent('yAxis', createAxisCreator('y'), this);\n\n  if (!axesCount.x || !axesCount.y) {\n    // Roll back when there no either x or y axis\n    this._axesMap = {};\n    this._axesList = [];\n    return;\n  }\n\n  this._axesMap = axesMap; /// Create cartesian2d\n\n  each(axesMap.x, function (xAxis, xAxisIndex) {\n    each(axesMap.y, function (yAxis, yAxisIndex) {\n      var key = 'x' + xAxisIndex + 'y' + yAxisIndex;\n      var cartesian = new Cartesian2D(key);\n      cartesian.grid = this;\n      cartesian.model = gridModel;\n      this._coordsMap[key] = cartesian;\n\n      this._coordsList.push(cartesian);\n\n      cartesian.addAxis(xAxis);\n      cartesian.addAxis(yAxis);\n    }, this);\n  }, this);\n\n  function createAxisCreator(axisType) {\n    return function (axisModel, idx) {\n      if (!isAxisUsedInTheGrid(axisModel, gridModel, ecModel)) {\n        return;\n      }\n\n      var axisPosition = axisModel.get('position');\n\n      if (axisType === 'x') {\n        // Fix position\n        if (axisPosition !== 'top' && axisPosition !== 'bottom') {\n          // Default bottom of X\n          axisPosition = axisPositionUsed.bottom ? 'top' : 'bottom';\n        }\n      } else {\n        // Fix position\n        if (axisPosition !== 'left' && axisPosition !== 'right') {\n          // Default left of Y\n          axisPosition = axisPositionUsed.left ? 'right' : 'left';\n        }\n      }\n\n      axisPositionUsed[axisPosition] = true;\n      var axis = new Axis2D(axisType, createScaleByModel(axisModel), [0, 0], axisModel.get('type'), axisPosition);\n      var isCategory = axis.type === 'category';\n      axis.onBand = isCategory && axisModel.get('boundaryGap');\n      axis.inverse = axisModel.get('inverse'); // Inject axis into axisModel\n\n      axisModel.axis = axis; // Inject axisModel into axis\n\n      axis.model = axisModel; // Inject grid info axis\n\n      axis.grid = this; // Index of axis, can be used as key\n\n      axis.index = idx;\n\n      this._axesList.push(axis);\n\n      axesMap[axisType][idx] = axis;\n      axesCount[axisType]++;\n    };\n  }\n};\n/**\n * Update cartesian properties from series\n * @param  {module:echarts/model/Option} option\n * @private\n */\n\n\ngridProto._updateScale = function (ecModel, gridModel) {\n  // Reset scale\n  each(this._axesList, function (axis) {\n    axis.scale.setExtent(Infinity, -Infinity);\n  });\n  ecModel.eachSeries(function (seriesModel) {\n    if (isCartesian2D(seriesModel)) {\n      var axesModels = findAxesModels(seriesModel, ecModel);\n      var xAxisModel = axesModels[0];\n      var yAxisModel = axesModels[1];\n\n      if (!isAxisUsedInTheGrid(xAxisModel, gridModel, ecModel) || !isAxisUsedInTheGrid(yAxisModel, gridModel, ecModel)) {\n        return;\n      }\n\n      var cartesian = this.getCartesian(xAxisModel.componentIndex, yAxisModel.componentIndex);\n      var data = seriesModel.getData();\n      var xAxis = cartesian.getAxis('x');\n      var yAxis = cartesian.getAxis('y');\n\n      if (data.type === 'list') {\n        unionExtent(data, xAxis, seriesModel);\n        unionExtent(data, yAxis, seriesModel);\n      }\n    }\n  }, this);\n\n  function unionExtent(data, axis, seriesModel) {\n    each(data.mapDimension(axis.dim, true), function (dim) {\n      axis.scale.unionExtentFromData( // For example, the extent of the orginal dimension\n      // is [0.1, 0.5], the extent of the `stackResultDimension`\n      // is [7, 9], the final extent should not include [0.1, 0.5].\n      data, getStackedDimension(data, dim));\n    });\n  }\n};\n/**\n * @param {string} [dim] 'x' or 'y' or 'auto' or null/undefined\n * @return {Object} {baseAxes: [], otherAxes: []}\n */\n\n\ngridProto.getTooltipAxes = function (dim) {\n  var baseAxes = [];\n  var otherAxes = [];\n  each(this.getCartesians(), function (cartesian) {\n    var baseAxis = dim != null && dim !== 'auto' ? cartesian.getAxis(dim) : cartesian.getBaseAxis();\n    var otherAxis = cartesian.getOtherAxis(baseAxis);\n    indexOf(baseAxes, baseAxis) < 0 && baseAxes.push(baseAxis);\n    indexOf(otherAxes, otherAxis) < 0 && otherAxes.push(otherAxis);\n  });\n  return {\n    baseAxes: baseAxes,\n    otherAxes: otherAxes\n  };\n};\n/**\n * @inner\n */\n\n\nfunction updateAxisTransform(axis, coordBase) {\n  var axisExtent = axis.getExtent();\n  var axisExtentSum = axisExtent[0] + axisExtent[1]; // Fast transform\n\n  axis.toGlobalCoord = axis.dim === 'x' ? function (coord) {\n    return coord + coordBase;\n  } : function (coord) {\n    return axisExtentSum - coord + coordBase;\n  };\n  axis.toLocalCoord = axis.dim === 'x' ? function (coord) {\n    return coord - coordBase;\n  } : function (coord) {\n    return axisExtentSum - coord + coordBase;\n  };\n}\n\nvar axesTypes = ['xAxis', 'yAxis'];\n/**\n * @inner\n */\n\nfunction findAxesModels(seriesModel, ecModel) {\n  return map(axesTypes, function (axisType) {\n    var axisModel = seriesModel.getReferringComponents(axisType)[0];\n    return axisModel;\n  });\n}\n/**\n * @inner\n */\n\n\nfunction isCartesian2D(seriesModel) {\n  return seriesModel.get('coordinateSystem') === 'cartesian2d';\n}\n\nGrid.create = function (ecModel, api) {\n  var grids = [];\n  ecModel.eachComponent('grid', function (gridModel, idx) {\n    var grid = new Grid(gridModel, ecModel, api);\n    grid.name = 'grid_' + idx; // dataSampling requires axis extent, so resize\n    // should be performed in create stage.\n\n    grid.resize(gridModel, api, true);\n    gridModel.coordinateSystem = grid;\n    grids.push(grid);\n  }); // Inject the coordinateSystems into seriesModel\n\n  ecModel.eachSeries(function (seriesModel) {\n    if (!isCartesian2D(seriesModel)) {\n      return;\n    }\n\n    var axesModels = findAxesModels(seriesModel, ecModel);\n    var xAxisModel = axesModels[0];\n    var yAxisModel = axesModels[1];\n    var gridModel = xAxisModel.getCoordSysModel();\n    var grid = gridModel.coordinateSystem;\n    seriesModel.coordinateSystem = grid.getCartesian(xAxisModel.componentIndex, yAxisModel.componentIndex);\n  });\n  return grids;\n}; // For deciding which dimensions to use when creating list data\n\n\nGrid.dimensions = Grid.prototype.dimensions = Cartesian2D.prototype.dimensions;\nCoordinateSystem.register('cartesian2d', Grid);\nvar _default = Grid;\nmodule.exports = _default;","\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n\nvar echarts = require(\"../echarts\");\n\nvar zrUtil = require(\"zrender/lib/core/util\");\n\nvar _barGrid = require(\"../layout/barGrid\");\n\nvar layout = _barGrid.layout;\nvar largeLayout = _barGrid.largeLayout;\n\nrequire(\"../coord/cartesian/Grid\");\n\nrequire(\"./bar/BarSeries\");\n\nrequire(\"./bar/BarView\");\n\nrequire(\"../component/gridSimple\");\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n// In case developer forget to include grid component\necharts.registerLayout(echarts.PRIORITY.VISUAL.LAYOUT, zrUtil.curry(layout, 'bar')); // Use higher prority to avoid to be blocked by other overall layout, which do not\n// only exist in this module, but probably also exist in other modules, like `barPolar`.\n\necharts.registerLayout(echarts.PRIORITY.VISUAL.PROGRESSIVE_LAYOUT, largeLayout);\necharts.registerVisual({\n  seriesType: 'bar',\n  reset: function (seriesModel) {\n    // Visual coding for legend\n    seriesModel.getData().setVisual('legendSymbol', 'roundRect');\n  }\n});","\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n\nvar zrUtil = require(\"zrender/lib/core/util\");\n\nvar ComponentModel = require(\"../../model/Component\");\n\nvar axisModelCreator = require(\"../axisModelCreator\");\n\nvar axisModelCommonMixin = require(\"../axisModelCommonMixin\");\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\nvar AxisModel = ComponentModel.extend({\n  type: 'cartesian2dAxis',\n\n  /**\n   * @type {module:echarts/coord/cartesian/Axis2D}\n   */\n  axis: null,\n\n  /**\n   * @override\n   */\n  init: function () {\n    AxisModel.superApply(this, 'init', arguments);\n    this.resetRange();\n  },\n\n  /**\n   * @override\n   */\n  mergeOption: function () {\n    AxisModel.superApply(this, 'mergeOption', arguments);\n    this.resetRange();\n  },\n\n  /**\n   * @override\n   */\n  restoreData: function () {\n    AxisModel.superApply(this, 'restoreData', arguments);\n    this.resetRange();\n  },\n\n  /**\n   * @override\n   * @return {module:echarts/model/Component}\n   */\n  getCoordSysModel: function () {\n    return this.ecModel.queryComponents({\n      mainType: 'grid',\n      index: this.option.gridIndex,\n      id: this.option.gridId\n    })[0];\n  }\n});\n\nfunction getAxisType(axisDim, option) {\n  // Default axis with data is category axis\n  return option.type || (option.data ? 'category' : 'value');\n}\n\nzrUtil.merge(AxisModel.prototype, axisModelCommonMixin);\nvar extraOption = {\n  // gridIndex: 0,\n  // gridId: '',\n  // Offset is for multiple axis on the same position\n  offset: 0\n};\naxisModelCreator('x', AxisModel, getAxisType, extraOption);\naxisModelCreator('y', AxisModel, getAxisType, extraOption);\nvar _default = AxisModel;\nmodule.exports = _default;","\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n\nvar SeriesModel = require(\"../../model/Series\");\n\nvar createListFromArray = require(\"../helper/createListFromArray\");\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\nvar _default = SeriesModel.extend({\n  type: 'series.__base_bar__',\n  getInitialData: function (option, ecModel) {\n    return createListFromArray(this.getSource(), this, {\n      useEncodeDefaulter: true\n    });\n  },\n  getMarkerPosition: function (value) {\n    var coordSys = this.coordinateSystem;\n\n    if (coordSys) {\n      // PENDING if clamp ?\n      var pt = coordSys.dataToPoint(coordSys.clampData(value));\n      var data = this.getData();\n      var offset = data.getLayout('offset');\n      var size = data.getLayout('size');\n      var offsetIndex = coordSys.getBaseAxis().isHorizontal() ? 0 : 1;\n      pt[offsetIndex] += offset + size / 2;\n      return pt;\n    }\n\n    return [NaN, NaN];\n  },\n  defaultOption: {\n    zlevel: 0,\n    // 一级层叠\n    z: 2,\n    // 二级层叠\n    coordinateSystem: 'cartesian2d',\n    legendHoverLink: true,\n    // stack: null\n    // Cartesian coordinate system\n    // xAxisIndex: 0,\n    // yAxisIndex: 0,\n    // 最小高度改为0\n    barMinHeight: 0,\n    // 最小角度为0，仅对极坐标系下的柱状图有效\n    barMinAngle: 0,\n    // cursor: null,\n    large: false,\n    largeThreshold: 400,\n    progressive: 3e3,\n    progressiveChunkMode: 'mod',\n    // barMaxWidth: null,\n    // In cartesian, the default value is 1. Otherwise null.\n    // barMinWidth: null,\n    // 默认自适应\n    // barWidth: null,\n    // 柱间距离，默认为柱形宽度的30%，可设固定值\n    // barGap: '30%',\n    // 类目间柱形距离，默认为类目间距的20%，可设固定值\n    // barCategoryGap: '20%',\n    // label: {\n    //      show: false\n    // },\n    itemStyle: {},\n    emphasis: {}\n  }\n});\n\nmodule.exports = _default;","\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n\nvar graphic = require(\"../../util/graphic\");\n\nvar _labelHelper = require(\"../helper/labelHelper\");\n\nvar getDefaultLabel = _labelHelper.getDefaultLabel;\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\nfunction setLabel(normalStyle, hoverStyle, itemModel, color, seriesModel, dataIndex, labelPositionOutside) {\n  var labelModel = itemModel.getModel('label');\n  var hoverLabelModel = itemModel.getModel('emphasis.label');\n  graphic.setLabelStyle(normalStyle, hoverStyle, labelModel, hoverLabelModel, {\n    labelFetcher: seriesModel,\n    labelDataIndex: dataIndex,\n    defaultText: getDefaultLabel(seriesModel.getData(), dataIndex),\n    isRectText: true,\n    autoColor: color\n  });\n  fixPosition(normalStyle);\n  fixPosition(hoverStyle);\n}\n\nfunction fixPosition(style, labelPositionOutside) {\n  if (style.textPosition === 'outside') {\n    style.textPosition = labelPositionOutside;\n  }\n}\n\nexports.setLabel = setLabel;","\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n\nvar _dataProvider = require(\"../../data/helper/dataProvider\");\n\nvar retrieveRawValue = _dataProvider.retrieveRawValue;\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n\n/**\n * @param {module:echarts/data/List} data\n * @param {number} dataIndex\n * @return {string} label string. Not null/undefined\n */\nfunction getDefaultLabel(data, dataIndex) {\n  var labelDims = data.mapDimension('defaultedLabel', true);\n  var len = labelDims.length; // Simple optimization (in lots of cases, label dims length is 1)\n\n  if (len === 1) {\n    return retrieveRawValue(data, dataIndex, labelDims[0]);\n  } else if (len) {\n    var vals = [];\n\n    for (var i = 0; i < labelDims.length; i++) {\n      var val = retrieveRawValue(data, dataIndex, labelDims[i]);\n      vals.push(val);\n    }\n\n    return vals.join(' ');\n  }\n}\n\nexports.getDefaultLabel = getDefaultLabel;","\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n\nvar graphic = require(\"../../util/graphic\");\n\nvar _number = require(\"../../util/number\");\n\nvar round = _number.round;\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\nfunction createGridClipPath(cartesian, hasAnimation, seriesModel) {\n  var rect = cartesian.getArea();\n  var isHorizontal = cartesian.getBaseAxis().isHorizontal();\n  var x = rect.x;\n  var y = rect.y;\n  var width = rect.width;\n  var height = rect.height;\n  var lineWidth = seriesModel.get('lineStyle.width') || 2; // Expand the clip path a bit to avoid the border is clipped and looks thinner\n\n  x -= lineWidth / 2;\n  y -= lineWidth / 2;\n  width += lineWidth;\n  height += lineWidth; // fix: https://github.com/apache/incubator-echarts/issues/11369\n\n  x = Math.floor(x);\n  width = Math.round(width);\n  var clipPath = new graphic.Rect({\n    shape: {\n      x: x,\n      y: y,\n      width: width,\n      height: height\n    }\n  });\n\n  if (hasAnimation) {\n    clipPath.shape[isHorizontal ? 'width' : 'height'] = 0;\n    graphic.initProps(clipPath, {\n      shape: {\n        width: width,\n        height: height\n      }\n    }, seriesModel);\n  }\n\n  return clipPath;\n}\n\nfunction createPolarClipPath(polar, hasAnimation, seriesModel) {\n  var sectorArea = polar.getArea(); // Avoid float number rounding error for symbol on the edge of axis extent.\n\n  var clipPath = new graphic.Sector({\n    shape: {\n      cx: round(polar.cx, 1),\n      cy: round(polar.cy, 1),\n      r0: round(sectorArea.r0, 1),\n      r: round(sectorArea.r, 1),\n      startAngle: sectorArea.startAngle,\n      endAngle: sectorArea.endAngle,\n      clockwise: sectorArea.clockwise\n    }\n  });\n\n  if (hasAnimation) {\n    clipPath.shape.endAngle = sectorArea.startAngle;\n    graphic.initProps(clipPath, {\n      shape: {\n        endAngle: sectorArea.endAngle\n      }\n    }, seriesModel);\n  }\n\n  return clipPath;\n}\n\nfunction createClipPath(coordSys, hasAnimation, seriesModel) {\n  if (!coordSys) {\n    return null;\n  } else if (coordSys.type === 'polar') {\n    return createPolarClipPath(coordSys, hasAnimation, seriesModel);\n  } else if (coordSys.type === 'cartesian2d') {\n    return createGridClipPath(coordSys, hasAnimation, seriesModel);\n  }\n\n  return null;\n}\n\nexports.createGridClipPath = createGridClipPath;\nexports.createPolarClipPath = createPolarClipPath;\nexports.createClipPath = createClipPath;","\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n\nvar _util = require(\"zrender/lib/core/util\");\n\nvar retrieve = _util.retrieve;\nvar defaults = _util.defaults;\nvar extend = _util.extend;\nvar each = _util.each;\n\nvar formatUtil = require(\"../../util/format\");\n\nvar graphic = require(\"../../util/graphic\");\n\nvar Model = require(\"../../model/Model\");\n\nvar _number = require(\"../../util/number\");\n\nvar isRadianAroundZero = _number.isRadianAroundZero;\nvar remRadian = _number.remRadian;\n\nvar _symbol = require(\"../../util/symbol\");\n\nvar createSymbol = _symbol.createSymbol;\n\nvar matrixUtil = require(\"zrender/lib/core/matrix\");\n\nvar _vector = require(\"zrender/lib/core/vector\");\n\nvar v2ApplyTransform = _vector.applyTransform;\n\nvar _axisHelper = require(\"../../coord/axisHelper\");\n\nvar shouldShowAllLabels = _axisHelper.shouldShowAllLabels;\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\nvar PI = Math.PI;\n/**\n * A final axis is translated and rotated from a \"standard axis\".\n * So opt.position and opt.rotation is required.\n *\n * A standard axis is and axis from [0, 0] to [0, axisExtent[1]],\n * for example: (0, 0) ------------> (0, 50)\n *\n * nameDirection or tickDirection or labelDirection is 1 means tick\n * or label is below the standard axis, whereas is -1 means above\n * the standard axis. labelOffset means offset between label and axis,\n * which is useful when 'onZero', where axisLabel is in the grid and\n * label in outside grid.\n *\n * Tips: like always,\n * positive rotation represents anticlockwise, and negative rotation\n * represents clockwise.\n * The direction of position coordinate is the same as the direction\n * of screen coordinate.\n *\n * Do not need to consider axis 'inverse', which is auto processed by\n * axis extent.\n *\n * @param {module:zrender/container/Group} group\n * @param {Object} axisModel\n * @param {Object} opt Standard axis parameters.\n * @param {Array.<number>} opt.position [x, y]\n * @param {number} opt.rotation by radian\n * @param {number} [opt.nameDirection=1] 1 or -1 Used when nameLocation is 'middle' or 'center'.\n * @param {number} [opt.tickDirection=1] 1 or -1\n * @param {number} [opt.labelDirection=1] 1 or -1\n * @param {number} [opt.labelOffset=0] Usefull when onZero.\n * @param {string} [opt.axisLabelShow] default get from axisModel.\n * @param {string} [opt.axisName] default get from axisModel.\n * @param {number} [opt.axisNameAvailableWidth]\n * @param {number} [opt.labelRotate] by degree, default get from axisModel.\n * @param {number} [opt.strokeContainThreshold] Default label interval when label\n * @param {number} [opt.nameTruncateMaxWidth]\n */\n\nvar AxisBuilder = function (axisModel, opt) {\n  /**\n   * @readOnly\n   */\n  this.opt = opt;\n  /**\n   * @readOnly\n   */\n\n  this.axisModel = axisModel; // Default value\n\n  defaults(opt, {\n    labelOffset: 0,\n    nameDirection: 1,\n    tickDirection: 1,\n    labelDirection: 1,\n    silent: true\n  });\n  /**\n   * @readOnly\n   */\n\n  this.group = new graphic.Group(); // FIXME Not use a seperate text group?\n\n  var dumbGroup = new graphic.Group({\n    position: opt.position.slice(),\n    rotation: opt.rotation\n  }); // this.group.add(dumbGroup);\n  // this._dumbGroup = dumbGroup;\n\n  dumbGroup.updateTransform();\n  this._transform = dumbGroup.transform;\n  this._dumbGroup = dumbGroup;\n};\n\nAxisBuilder.prototype = {\n  constructor: AxisBuilder,\n  hasBuilder: function (name) {\n    return !!builders[name];\n  },\n  add: function (name) {\n    builders[name].call(this);\n  },\n  getGroup: function () {\n    return this.group;\n  }\n};\nvar builders = {\n  /**\n   * @private\n   */\n  axisLine: function () {\n    var opt = this.opt;\n    var axisModel = this.axisModel;\n\n    if (!axisModel.get('axisLine.show')) {\n      return;\n    }\n\n    var extent = this.axisModel.axis.getExtent();\n    var matrix = this._transform;\n    var pt1 = [extent[0], 0];\n    var pt2 = [extent[1], 0];\n\n    if (matrix) {\n      v2ApplyTransform(pt1, pt1, matrix);\n      v2ApplyTransform(pt2, pt2, matrix);\n    }\n\n    var lineStyle = extend({\n      lineCap: 'round'\n    }, axisModel.getModel('axisLine.lineStyle').getLineStyle());\n    this.group.add(new graphic.Line({\n      // Id for animation\n      anid: 'line',\n      subPixelOptimize: true,\n      shape: {\n        x1: pt1[0],\n        y1: pt1[1],\n        x2: pt2[0],\n        y2: pt2[1]\n      },\n      style: lineStyle,\n      strokeContainThreshold: opt.strokeContainThreshold || 5,\n      silent: true,\n      z2: 1\n    }));\n    var arrows = axisModel.get('axisLine.symbol');\n    var arrowSize = axisModel.get('axisLine.symbolSize');\n    var arrowOffset = axisModel.get('axisLine.symbolOffset') || 0;\n\n    if (typeof arrowOffset === 'number') {\n      arrowOffset = [arrowOffset, arrowOffset];\n    }\n\n    if (arrows != null) {\n      if (typeof arrows === 'string') {\n        // Use the same arrow for start and end point\n        arrows = [arrows, arrows];\n      }\n\n      if (typeof arrowSize === 'string' || typeof arrowSize === 'number') {\n        // Use the same size for width and height\n        arrowSize = [arrowSize, arrowSize];\n      }\n\n      var symbolWidth = arrowSize[0];\n      var symbolHeight = arrowSize[1];\n      each([{\n        rotate: opt.rotation + Math.PI / 2,\n        offset: arrowOffset[0],\n        r: 0\n      }, {\n        rotate: opt.rotation - Math.PI / 2,\n        offset: arrowOffset[1],\n        r: Math.sqrt((pt1[0] - pt2[0]) * (pt1[0] - pt2[0]) + (pt1[1] - pt2[1]) * (pt1[1] - pt2[1]))\n      }], function (point, index) {\n        if (arrows[index] !== 'none' && arrows[index] != null) {\n          var symbol = createSymbol(arrows[index], -symbolWidth / 2, -symbolHeight / 2, symbolWidth, symbolHeight, lineStyle.stroke, true); // Calculate arrow position with offset\n\n          var r = point.r + point.offset;\n          var pos = [pt1[0] + r * Math.cos(opt.rotation), pt1[1] - r * Math.sin(opt.rotation)];\n          symbol.attr({\n            rotation: point.rotate,\n            position: pos,\n            silent: true,\n            z2: 11\n          });\n          this.group.add(symbol);\n        }\n      }, this);\n    }\n  },\n\n  /**\n   * @private\n   */\n  axisTickLabel: function () {\n    var axisModel = this.axisModel;\n    var opt = this.opt;\n    var ticksEls = buildAxisMajorTicks(this, axisModel, opt);\n    var labelEls = buildAxisLabel(this, axisModel, opt);\n    fixMinMaxLabelShow(axisModel, labelEls, ticksEls);\n    buildAxisMinorTicks(this, axisModel, opt);\n  },\n\n  /**\n   * @private\n   */\n  axisName: function () {\n    var opt = this.opt;\n    var axisModel = this.axisModel;\n    var name = retrieve(opt.axisName, axisModel.get('name'));\n\n    if (!name) {\n      return;\n    }\n\n    var nameLocation = axisModel.get('nameLocation');\n    var nameDirection = opt.nameDirection;\n    var textStyleModel = axisModel.getModel('nameTextStyle');\n    var gap = axisModel.get('nameGap') || 0;\n    var extent = this.axisModel.axis.getExtent();\n    var gapSignal = extent[0] > extent[1] ? -1 : 1;\n    var pos = [nameLocation === 'start' ? extent[0] - gapSignal * gap : nameLocation === 'end' ? extent[1] + gapSignal * gap : (extent[0] + extent[1]) / 2, // 'middle'\n    // Reuse labelOffset.\n    isNameLocationCenter(nameLocation) ? opt.labelOffset + nameDirection * gap : 0];\n    var labelLayout;\n    var nameRotation = axisModel.get('nameRotate');\n\n    if (nameRotation != null) {\n      nameRotation = nameRotation * PI / 180; // To radian.\n    }\n\n    var axisNameAvailableWidth;\n\n    if (isNameLocationCenter(nameLocation)) {\n      labelLayout = innerTextLayout(opt.rotation, nameRotation != null ? nameRotation : opt.rotation, // Adapt to axis.\n      nameDirection);\n    } else {\n      labelLayout = endTextLayout(opt, nameLocation, nameRotation || 0, extent);\n      axisNameAvailableWidth = opt.axisNameAvailableWidth;\n\n      if (axisNameAvailableWidth != null) {\n        axisNameAvailableWidth = Math.abs(axisNameAvailableWidth / Math.sin(labelLayout.rotation));\n        !isFinite(axisNameAvailableWidth) && (axisNameAvailableWidth = null);\n      }\n    }\n\n    var textFont = textStyleModel.getFont();\n    var truncateOpt = axisModel.get('nameTruncate', true) || {};\n    var ellipsis = truncateOpt.ellipsis;\n    var maxWidth = retrieve(opt.nameTruncateMaxWidth, truncateOpt.maxWidth, axisNameAvailableWidth); // FIXME\n    // truncate rich text? (consider performance)\n\n    var truncatedText = ellipsis != null && maxWidth != null ? formatUtil.truncateText(name, maxWidth, textFont, ellipsis, {\n      minChar: 2,\n      placeholder: truncateOpt.placeholder\n    }) : name;\n    var tooltipOpt = axisModel.get('tooltip', true);\n    var mainType = axisModel.mainType;\n    var formatterParams = {\n      componentType: mainType,\n      name: name,\n      $vars: ['name']\n    };\n    formatterParams[mainType + 'Index'] = axisModel.componentIndex;\n    var textEl = new graphic.Text({\n      // Id for animation\n      anid: 'name',\n      __fullText: name,\n      __truncatedText: truncatedText,\n      position: pos,\n      rotation: labelLayout.rotation,\n      silent: isLabelSilent(axisModel),\n      z2: 1,\n      tooltip: tooltipOpt && tooltipOpt.show ? extend({\n        content: name,\n        formatter: function () {\n          return name;\n        },\n        formatterParams: formatterParams\n      }, tooltipOpt) : null\n    });\n    graphic.setTextStyle(textEl.style, textStyleModel, {\n      text: truncatedText,\n      textFont: textFont,\n      textFill: textStyleModel.getTextColor() || axisModel.get('axisLine.lineStyle.color'),\n      textAlign: textStyleModel.get('align') || labelLayout.textAlign,\n      textVerticalAlign: textStyleModel.get('verticalAlign') || labelLayout.textVerticalAlign\n    });\n\n    if (axisModel.get('triggerEvent')) {\n      textEl.eventData = makeAxisEventDataBase(axisModel);\n      textEl.eventData.targetType = 'axisName';\n      textEl.eventData.name = name;\n    } // FIXME\n\n\n    this._dumbGroup.add(textEl);\n\n    textEl.updateTransform();\n    this.group.add(textEl);\n    textEl.decomposeTransform();\n  }\n};\n\nvar makeAxisEventDataBase = AxisBuilder.makeAxisEventDataBase = function (axisModel) {\n  var eventData = {\n    componentType: axisModel.mainType,\n    componentIndex: axisModel.componentIndex\n  };\n  eventData[axisModel.mainType + 'Index'] = axisModel.componentIndex;\n  return eventData;\n};\n/**\n * @public\n * @static\n * @param {Object} opt\n * @param {number} axisRotation in radian\n * @param {number} textRotation in radian\n * @param {number} direction\n * @return {Object} {\n *  rotation, // according to axis\n *  textAlign,\n *  textVerticalAlign\n * }\n */\n\n\nvar innerTextLayout = AxisBuilder.innerTextLayout = function (axisRotation, textRotation, direction) {\n  var rotationDiff = remRadian(textRotation - axisRotation);\n  var textAlign;\n  var textVerticalAlign;\n\n  if (isRadianAroundZero(rotationDiff)) {\n    // Label is parallel with axis line.\n    textVerticalAlign = direction > 0 ? 'top' : 'bottom';\n    textAlign = 'center';\n  } else if (isRadianAroundZero(rotationDiff - PI)) {\n    // Label is inverse parallel with axis line.\n    textVerticalAlign = direction > 0 ? 'bottom' : 'top';\n    textAlign = 'center';\n  } else {\n    textVerticalAlign = 'middle';\n\n    if (rotationDiff > 0 && rotationDiff < PI) {\n      textAlign = direction > 0 ? 'right' : 'left';\n    } else {\n      textAlign = direction > 0 ? 'left' : 'right';\n    }\n  }\n\n  return {\n    rotation: rotationDiff,\n    textAlign: textAlign,\n    textVerticalAlign: textVerticalAlign\n  };\n};\n\nfunction endTextLayout(opt, textPosition, textRotate, extent) {\n  var rotationDiff = remRadian(textRotate - opt.rotation);\n  var textAlign;\n  var textVerticalAlign;\n  var inverse = extent[0] > extent[1];\n  var onLeft = textPosition === 'start' && !inverse || textPosition !== 'start' && inverse;\n\n  if (isRadianAroundZero(rotationDiff - PI / 2)) {\n    textVerticalAlign = onLeft ? 'bottom' : 'top';\n    textAlign = 'center';\n  } else if (isRadianAroundZero(rotationDiff - PI * 1.5)) {\n    textVerticalAlign = onLeft ? 'top' : 'bottom';\n    textAlign = 'center';\n  } else {\n    textVerticalAlign = 'middle';\n\n    if (rotationDiff < PI * 1.5 && rotationDiff > PI / 2) {\n      textAlign = onLeft ? 'left' : 'right';\n    } else {\n      textAlign = onLeft ? 'right' : 'left';\n    }\n  }\n\n  return {\n    rotation: rotationDiff,\n    textAlign: textAlign,\n    textVerticalAlign: textVerticalAlign\n  };\n}\n\nvar isLabelSilent = AxisBuilder.isLabelSilent = function (axisModel) {\n  var tooltipOpt = axisModel.get('tooltip');\n  return axisModel.get('silent') // Consider mouse cursor, add these restrictions.\n  || !(axisModel.get('triggerEvent') || tooltipOpt && tooltipOpt.show);\n};\n\nfunction fixMinMaxLabelShow(axisModel, labelEls, tickEls) {\n  if (shouldShowAllLabels(axisModel.axis)) {\n    return;\n  } // If min or max are user set, we need to check\n  // If the tick on min(max) are overlap on their neighbour tick\n  // If they are overlapped, we need to hide the min(max) tick label\n\n\n  var showMinLabel = axisModel.get('axisLabel.showMinLabel');\n  var showMaxLabel = axisModel.get('axisLabel.showMaxLabel'); // FIXME\n  // Have not consider onBand yet, where tick els is more than label els.\n\n  labelEls = labelEls || [];\n  tickEls = tickEls || [];\n  var firstLabel = labelEls[0];\n  var nextLabel = labelEls[1];\n  var lastLabel = labelEls[labelEls.length - 1];\n  var prevLabel = labelEls[labelEls.length - 2];\n  var firstTick = tickEls[0];\n  var nextTick = tickEls[1];\n  var lastTick = tickEls[tickEls.length - 1];\n  var prevTick = tickEls[tickEls.length - 2];\n\n  if (showMinLabel === false) {\n    ignoreEl(firstLabel);\n    ignoreEl(firstTick);\n  } else if (isTwoLabelOverlapped(firstLabel, nextLabel)) {\n    if (showMinLabel) {\n      ignoreEl(nextLabel);\n      ignoreEl(nextTick);\n    } else {\n      ignoreEl(firstLabel);\n      ignoreEl(firstTick);\n    }\n  }\n\n  if (showMaxLabel === false) {\n    ignoreEl(lastLabel);\n    ignoreEl(lastTick);\n  } else if (isTwoLabelOverlapped(prevLabel, lastLabel)) {\n    if (showMaxLabel) {\n      ignoreEl(prevLabel);\n      ignoreEl(prevTick);\n    } else {\n      ignoreEl(lastLabel);\n      ignoreEl(lastTick);\n    }\n  }\n}\n\nfunction ignoreEl(el) {\n  el && (el.ignore = true);\n}\n\nfunction isTwoLabelOverlapped(current, next, labelLayout) {\n  // current and next has the same rotation.\n  var firstRect = current && current.getBoundingRect().clone();\n  var nextRect = next && next.getBoundingRect().clone();\n\n  if (!firstRect || !nextRect) {\n    return;\n  } // When checking intersect of two rotated labels, we use mRotationBack\n  // to avoid that boundingRect is enlarge when using `boundingRect.applyTransform`.\n\n\n  var mRotationBack = matrixUtil.identity([]);\n  matrixUtil.rotate(mRotationBack, mRotationBack, -current.rotation);\n  firstRect.applyTransform(matrixUtil.mul([], mRotationBack, current.getLocalTransform()));\n  nextRect.applyTransform(matrixUtil.mul([], mRotationBack, next.getLocalTransform()));\n  return firstRect.intersect(nextRect);\n}\n\nfunction isNameLocationCenter(nameLocation) {\n  return nameLocation === 'middle' || nameLocation === 'center';\n}\n\nfunction createTicks(ticksCoords, tickTransform, tickEndCoord, tickLineStyle, aniid) {\n  var tickEls = [];\n  var pt1 = [];\n  var pt2 = [];\n\n  for (var i = 0; i < ticksCoords.length; i++) {\n    var tickCoord = ticksCoords[i].coord;\n    pt1[0] = tickCoord;\n    pt1[1] = 0;\n    pt2[0] = tickCoord;\n    pt2[1] = tickEndCoord;\n\n    if (tickTransform) {\n      v2ApplyTransform(pt1, pt1, tickTransform);\n      v2ApplyTransform(pt2, pt2, tickTransform);\n    } // Tick line, Not use group transform to have better line draw\n\n\n    var tickEl = new graphic.Line({\n      // Id for animation\n      anid: aniid + '_' + ticksCoords[i].tickValue,\n      subPixelOptimize: true,\n      shape: {\n        x1: pt1[0],\n        y1: pt1[1],\n        x2: pt2[0],\n        y2: pt2[1]\n      },\n      style: tickLineStyle,\n      z2: 2,\n      silent: true\n    });\n    tickEls.push(tickEl);\n  }\n\n  return tickEls;\n}\n\nfunction buildAxisMajorTicks(axisBuilder, axisModel, opt) {\n  var axis = axisModel.axis;\n  var tickModel = axisModel.getModel('axisTick');\n\n  if (!tickModel.get('show') || axis.scale.isBlank()) {\n    return;\n  }\n\n  var lineStyleModel = tickModel.getModel('lineStyle');\n  var tickEndCoord = opt.tickDirection * tickModel.get('length');\n  var ticksCoords = axis.getTicksCoords();\n  var ticksEls = createTicks(ticksCoords, axisBuilder._transform, tickEndCoord, defaults(lineStyleModel.getLineStyle(), {\n    stroke: axisModel.get('axisLine.lineStyle.color')\n  }), 'ticks');\n\n  for (var i = 0; i < ticksEls.length; i++) {\n    axisBuilder.group.add(ticksEls[i]);\n  }\n\n  return ticksEls;\n}\n\nfunction buildAxisMinorTicks(axisBuilder, axisModel, opt) {\n  var axis = axisModel.axis;\n  var minorTickModel = axisModel.getModel('minorTick');\n\n  if (!minorTickModel.get('show') || axis.scale.isBlank()) {\n    return;\n  }\n\n  var minorTicksCoords = axis.getMinorTicksCoords();\n\n  if (!minorTicksCoords.length) {\n    return;\n  }\n\n  var lineStyleModel = minorTickModel.getModel('lineStyle');\n  var tickEndCoord = opt.tickDirection * minorTickModel.get('length');\n  var minorTickLineStyle = defaults(lineStyleModel.getLineStyle(), defaults(axisModel.getModel('axisTick').getLineStyle(), {\n    stroke: axisModel.get('axisLine.lineStyle.color')\n  }));\n\n  for (var i = 0; i < minorTicksCoords.length; i++) {\n    var minorTicksEls = createTicks(minorTicksCoords[i], axisBuilder._transform, tickEndCoord, minorTickLineStyle, 'minorticks_' + i);\n\n    for (var k = 0; k < minorTicksEls.length; k++) {\n      axisBuilder.group.add(minorTicksEls[k]);\n    }\n  }\n}\n\nfunction buildAxisLabel(axisBuilder, axisModel, opt) {\n  var axis = axisModel.axis;\n  var show = retrieve(opt.axisLabelShow, axisModel.get('axisLabel.show'));\n\n  if (!show || axis.scale.isBlank()) {\n    return;\n  }\n\n  var labelModel = axisModel.getModel('axisLabel');\n  var labelMargin = labelModel.get('margin');\n  var labels = axis.getViewLabels(); // Special label rotate.\n\n  var labelRotation = (retrieve(opt.labelRotate, labelModel.get('rotate')) || 0) * PI / 180;\n  var labelLayout = innerTextLayout(opt.rotation, labelRotation, opt.labelDirection);\n  var rawCategoryData = axisModel.getCategories && axisModel.getCategories(true);\n  var labelEls = [];\n  var silent = isLabelSilent(axisModel);\n  var triggerEvent = axisModel.get('triggerEvent');\n  each(labels, function (labelItem, index) {\n    var tickValue = labelItem.tickValue;\n    var formattedLabel = labelItem.formattedLabel;\n    var rawLabel = labelItem.rawLabel;\n    var itemLabelModel = labelModel;\n\n    if (rawCategoryData && rawCategoryData[tickValue] && rawCategoryData[tickValue].textStyle) {\n      itemLabelModel = new Model(rawCategoryData[tickValue].textStyle, labelModel, axisModel.ecModel);\n    }\n\n    var textColor = itemLabelModel.getTextColor() || axisModel.get('axisLine.lineStyle.color');\n    var tickCoord = axis.dataToCoord(tickValue);\n    var pos = [tickCoord, opt.labelOffset + opt.labelDirection * labelMargin];\n    var textEl = new graphic.Text({\n      // Id for animation\n      anid: 'label_' + tickValue,\n      position: pos,\n      rotation: labelLayout.rotation,\n      silent: silent,\n      z2: 10\n    });\n    graphic.setTextStyle(textEl.style, itemLabelModel, {\n      text: formattedLabel,\n      textAlign: itemLabelModel.getShallow('align', true) || labelLayout.textAlign,\n      textVerticalAlign: itemLabelModel.getShallow('verticalAlign', true) || itemLabelModel.getShallow('baseline', true) || labelLayout.textVerticalAlign,\n      textFill: typeof textColor === 'function' ? textColor( // (1) In category axis with data zoom, tick is not the original\n      // index of axis.data. So tick should not be exposed to user\n      // in category axis.\n      // (2) Compatible with previous version, which always use formatted label as\n      // input. But in interval scale the formatted label is like '223,445', which\n      // maked user repalce ','. So we modify it to return original val but remain\n      // it as 'string' to avoid error in replacing.\n      axis.type === 'category' ? rawLabel : axis.type === 'value' ? tickValue + '' : tickValue, index) : textColor\n    }); // Pack data for mouse event\n\n    if (triggerEvent) {\n      textEl.eventData = makeAxisEventDataBase(axisModel);\n      textEl.eventData.targetType = 'axisLabel';\n      textEl.eventData.value = rawLabel;\n    } // FIXME\n\n\n    axisBuilder._dumbGroup.add(textEl);\n\n    textEl.updateTransform();\n    labelEls.push(textEl);\n    axisBuilder.group.add(textEl);\n    textEl.decomposeTransform();\n  });\n  return labelEls;\n}\n\nvar _default = AxisBuilder;\nmodule.exports = _default;","\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n\nvar _config = require(\"../../config\");\n\nvar __DEV__ = _config.__DEV__;\n\nvar echarts = require(\"../../echarts\");\n\nvar axisPointerModelHelper = require(\"../axisPointer/modelHelper\");\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n\n/**\n * Base class of AxisView.\n */\nvar AxisView = echarts.extendComponentView({\n  type: 'axis',\n\n  /**\n   * @private\n   */\n  _axisPointer: null,\n\n  /**\n   * @protected\n   * @type {string}\n   */\n  axisPointerClass: null,\n\n  /**\n   * @override\n   */\n  render: function (axisModel, ecModel, api, payload) {\n    // FIXME\n    // This process should proformed after coordinate systems updated\n    // (axis scale updated), and should be performed each time update.\n    // So put it here temporarily, although it is not appropriate to\n    // put a model-writing procedure in `view`.\n    this.axisPointerClass && axisPointerModelHelper.fixValue(axisModel);\n    AxisView.superApply(this, 'render', arguments);\n    updateAxisPointer(this, axisModel, ecModel, api, payload, true);\n  },\n\n  /**\n   * Action handler.\n   * @public\n   * @param {module:echarts/coord/cartesian/AxisModel} axisModel\n   * @param {module:echarts/model/Global} ecModel\n   * @param {module:echarts/ExtensionAPI} api\n   * @param {Object} payload\n   */\n  updateAxisPointer: function (axisModel, ecModel, api, payload, force) {\n    updateAxisPointer(this, axisModel, ecModel, api, payload, false);\n  },\n\n  /**\n   * @override\n   */\n  remove: function (ecModel, api) {\n    var axisPointer = this._axisPointer;\n    axisPointer && axisPointer.remove(api);\n    AxisView.superApply(this, 'remove', arguments);\n  },\n\n  /**\n   * @override\n   */\n  dispose: function (ecModel, api) {\n    disposeAxisPointer(this, api);\n    AxisView.superApply(this, 'dispose', arguments);\n  }\n});\n\nfunction updateAxisPointer(axisView, axisModel, ecModel, api, payload, forceRender) {\n  var Clazz = AxisView.getAxisPointerClass(axisView.axisPointerClass);\n\n  if (!Clazz) {\n    return;\n  }\n\n  var axisPointerModel = axisPointerModelHelper.getAxisPointerModel(axisModel);\n  axisPointerModel ? (axisView._axisPointer || (axisView._axisPointer = new Clazz())).render(axisModel, axisPointerModel, api, forceRender) : disposeAxisPointer(axisView, api);\n}\n\nfunction disposeAxisPointer(axisView, ecModel, api) {\n  var axisPointer = axisView._axisPointer;\n  axisPointer && axisPointer.dispose(ecModel, api);\n  axisView._axisPointer = null;\n}\n\nvar axisPointerClazz = [];\n\nAxisView.registerAxisPointerClass = function (type, clazz) {\n  axisPointerClazz[type] = clazz;\n};\n\nAxisView.getAxisPointerClass = function (type) {\n  return type && axisPointerClazz[type];\n};\n\nvar _default = AxisView;\nmodule.exports = _default;","\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n\nvar zrUtil = require(\"zrender/lib/core/util\");\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n\n/**\n * Can only be called after coordinate system creation stage.\n * (Can be called before coordinate system update stage).\n *\n * @param {Object} opt {labelInside}\n * @return {Object} {\n *  position, rotation, labelDirection, labelOffset,\n *  tickDirection, labelRotate, z2\n * }\n */\nfunction layout(gridModel, axisModel, opt) {\n  opt = opt || {};\n  var grid = gridModel.coordinateSystem;\n  var axis = axisModel.axis;\n  var layout = {};\n  var otherAxisOnZeroOf = axis.getAxesOnZeroOf()[0];\n  var rawAxisPosition = axis.position;\n  var axisPosition = otherAxisOnZeroOf ? 'onZero' : rawAxisPosition;\n  var axisDim = axis.dim;\n  var rect = grid.getRect();\n  var rectBound = [rect.x, rect.x + rect.width, rect.y, rect.y + rect.height];\n  var idx = {\n    left: 0,\n    right: 1,\n    top: 0,\n    bottom: 1,\n    onZero: 2\n  };\n  var axisOffset = axisModel.get('offset') || 0;\n  var posBound = axisDim === 'x' ? [rectBound[2] - axisOffset, rectBound[3] + axisOffset] : [rectBound[0] - axisOffset, rectBound[1] + axisOffset];\n\n  if (otherAxisOnZeroOf) {\n    var onZeroCoord = otherAxisOnZeroOf.toGlobalCoord(otherAxisOnZeroOf.dataToCoord(0));\n    posBound[idx.onZero] = Math.max(Math.min(onZeroCoord, posBound[1]), posBound[0]);\n  } // Axis position\n\n\n  layout.position = [axisDim === 'y' ? posBound[idx[axisPosition]] : rectBound[0], axisDim === 'x' ? posBound[idx[axisPosition]] : rectBound[3]]; // Axis rotation\n\n  layout.rotation = Math.PI / 2 * (axisDim === 'x' ? 0 : 1); // Tick and label direction, x y is axisDim\n\n  var dirMap = {\n    top: -1,\n    bottom: 1,\n    left: -1,\n    right: 1\n  };\n  layout.labelDirection = layout.tickDirection = layout.nameDirection = dirMap[rawAxisPosition];\n  layout.labelOffset = otherAxisOnZeroOf ? posBound[idx[rawAxisPosition]] - posBound[idx.onZero] : 0;\n\n  if (axisModel.get('axisTick.inside')) {\n    layout.tickDirection = -layout.tickDirection;\n  }\n\n  if (zrUtil.retrieve(opt.labelInside, axisModel.get('axisLabel.inside'))) {\n    layout.labelDirection = -layout.labelDirection;\n  } // Special label rotation\n\n\n  var labelRotate = axisModel.get('axisLabel.rotate');\n  layout.labelRotate = axisPosition === 'top' ? -labelRotate : labelRotate; // Over splitLine and splitArea\n\n  layout.z2 = 1;\n  return layout;\n}\n\nexports.layout = layout;","\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n\nvar zrUtil = require(\"zrender/lib/core/util\");\n\nvar modelUtil = require(\"../../util/model\");\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n\n/**\n * @param {Object} finder contains {seriesIndex, dataIndex, dataIndexInside}\n * @param {module:echarts/model/Global} ecModel\n * @return {Object} {point: [x, y], el: ...} point Will not be null.\n */\nfunction _default(finder, ecModel) {\n  var point = [];\n  var seriesIndex = finder.seriesIndex;\n  var seriesModel;\n\n  if (seriesIndex == null || !(seriesModel = ecModel.getSeriesByIndex(seriesIndex))) {\n    return {\n      point: []\n    };\n  }\n\n  var data = seriesModel.getData();\n  var dataIndex = modelUtil.queryDataIndex(data, finder);\n\n  if (dataIndex == null || dataIndex < 0 || zrUtil.isArray(dataIndex)) {\n    return {\n      point: []\n    };\n  }\n\n  var el = data.getItemGraphicEl(dataIndex);\n  var coordSys = seriesModel.coordinateSystem;\n\n  if (seriesModel.getTooltipPosition) {\n    point = seriesModel.getTooltipPosition(dataIndex) || [];\n  } else if (coordSys && coordSys.dataToPoint) {\n    point = coordSys.dataToPoint(data.getValues(zrUtil.map(coordSys.dimensions, function (dim) {\n      return data.mapDimension(dim);\n    }), dataIndex, true)) || [];\n  } else if (el) {\n    // Use graphic bounding rect\n    var rect = el.getBoundingRect().clone();\n    rect.applyTransform(el.transform);\n    point = [rect.x + rect.width / 2, rect.y + rect.height / 2];\n  }\n\n  return {\n    point: point,\n    el: el\n  };\n}\n\nmodule.exports = _default;","\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n\nvar zrUtil = require(\"zrender/lib/core/util\");\n\nvar env = require(\"zrender/lib/core/env\");\n\nvar _model = require(\"../../util/model\");\n\nvar makeInner = _model.makeInner;\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\nvar inner = makeInner();\nvar each = zrUtil.each;\n/**\n * @param {string} key\n * @param {module:echarts/ExtensionAPI} api\n * @param {Function} handler\n *      param: {string} currTrigger\n *      param: {Array.<number>} point\n */\n\nfunction register(key, api, handler) {\n  if (env.node) {\n    return;\n  }\n\n  var zr = api.getZr();\n  inner(zr).records || (inner(zr).records = {});\n  initGlobalListeners(zr, api);\n  var record = inner(zr).records[key] || (inner(zr).records[key] = {});\n  record.handler = handler;\n}\n\nfunction initGlobalListeners(zr, api) {\n  if (inner(zr).initialized) {\n    return;\n  }\n\n  inner(zr).initialized = true;\n  useHandler('click', zrUtil.curry(doEnter, 'click'));\n  useHandler('mousemove', zrUtil.curry(doEnter, 'mousemove')); // useHandler('mouseout', onLeave);\n\n  useHandler('globalout', onLeave);\n\n  function useHandler(eventType, cb) {\n    zr.on(eventType, function (e) {\n      var dis = makeDispatchAction(api);\n      each(inner(zr).records, function (record) {\n        record && cb(record, e, dis.dispatchAction);\n      });\n      dispatchTooltipFinally(dis.pendings, api);\n    });\n  }\n}\n\nfunction dispatchTooltipFinally(pendings, api) {\n  var showLen = pendings.showTip.length;\n  var hideLen = pendings.hideTip.length;\n  var actuallyPayload;\n\n  if (showLen) {\n    actuallyPayload = pendings.showTip[showLen - 1];\n  } else if (hideLen) {\n    actuallyPayload = pendings.hideTip[hideLen - 1];\n  }\n\n  if (actuallyPayload) {\n    actuallyPayload.dispatchAction = null;\n    api.dispatchAction(actuallyPayload);\n  }\n}\n\nfunction onLeave(record, e, dispatchAction) {\n  record.handler('leave', null, dispatchAction);\n}\n\nfunction doEnter(currTrigger, record, e, dispatchAction) {\n  record.handler(currTrigger, e, dispatchAction);\n}\n\nfunction makeDispatchAction(api) {\n  var pendings = {\n    showTip: [],\n    hideTip: []\n  }; // FIXME\n  // better approach?\n  // 'showTip' and 'hideTip' can be triggered by axisPointer and tooltip,\n  // which may be conflict, (axisPointer call showTip but tooltip call hideTip);\n  // So we have to add \"final stage\" to merge those dispatched actions.\n\n  var dispatchAction = function (payload) {\n    var pendingList = pendings[payload.type];\n\n    if (pendingList) {\n      pendingList.push(payload);\n    } else {\n      payload.dispatchAction = dispatchAction;\n      api.dispatchAction(payload);\n    }\n  };\n\n  return {\n    dispatchAction: dispatchAction,\n    pendings: pendings\n  };\n}\n/**\n * @param {string} key\n * @param {module:echarts/ExtensionAPI} api\n */\n\n\nfunction unregister(key, api) {\n  if (env.node) {\n    return;\n  }\n\n  var zr = api.getZr();\n  var record = (inner(zr).records || {})[key];\n\n  if (record) {\n    inner(zr).records[key] = null;\n  }\n}\n\nexports.register = register;\nexports.unregister = unregister;","\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n\nvar zrUtil = require(\"zrender/lib/core/util\");\n\nvar graphic = require(\"../../util/graphic\");\n\nvar textContain = require(\"zrender/lib/contain/text\");\n\nvar formatUtil = require(\"../../util/format\");\n\nvar matrix = require(\"zrender/lib/core/matrix\");\n\nvar axisHelper = require(\"../../coord/axisHelper\");\n\nvar AxisBuilder = require(\"../axis/AxisBuilder\");\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n\n/**\n * @param {module:echarts/model/Model} axisPointerModel\n */\nfunction buildElStyle(axisPointerModel) {\n  var axisPointerType = axisPointerModel.get('type');\n  var styleModel = axisPointerModel.getModel(axisPointerType + 'Style');\n  var style;\n\n  if (axisPointerType === 'line') {\n    style = styleModel.getLineStyle();\n    style.fill = null;\n  } else if (axisPointerType === 'shadow') {\n    style = styleModel.getAreaStyle();\n    style.stroke = null;\n  }\n\n  return style;\n}\n/**\n * @param {Function} labelPos {align, verticalAlign, position}\n */\n\n\nfunction buildLabelElOption(elOption, axisModel, axisPointerModel, api, labelPos) {\n  var value = axisPointerModel.get('value');\n  var text = getValueLabel(value, axisModel.axis, axisModel.ecModel, axisPointerModel.get('seriesDataIndices'), {\n    precision: axisPointerModel.get('label.precision'),\n    formatter: axisPointerModel.get('label.formatter')\n  });\n  var labelModel = axisPointerModel.getModel('label');\n  var paddings = formatUtil.normalizeCssArray(labelModel.get('padding') || 0);\n  var font = labelModel.getFont();\n  var textRect = textContain.getBoundingRect(text, font);\n  var position = labelPos.position;\n  var width = textRect.width + paddings[1] + paddings[3];\n  var height = textRect.height + paddings[0] + paddings[2]; // Adjust by align.\n\n  var align = labelPos.align;\n  align === 'right' && (position[0] -= width);\n  align === 'center' && (position[0] -= width / 2);\n  var verticalAlign = labelPos.verticalAlign;\n  verticalAlign === 'bottom' && (position[1] -= height);\n  verticalAlign === 'middle' && (position[1] -= height / 2); // Not overflow ec container\n\n  confineInContainer(position, width, height, api);\n  var bgColor = labelModel.get('backgroundColor');\n\n  if (!bgColor || bgColor === 'auto') {\n    bgColor = axisModel.get('axisLine.lineStyle.color');\n  }\n\n  elOption.label = {\n    shape: {\n      x: 0,\n      y: 0,\n      width: width,\n      height: height,\n      r: labelModel.get('borderRadius')\n    },\n    position: position.slice(),\n    // TODO: rich\n    style: {\n      text: text,\n      textFont: font,\n      textFill: labelModel.getTextColor(),\n      textPosition: 'inside',\n      textPadding: paddings,\n      fill: bgColor,\n      stroke: labelModel.get('borderColor') || 'transparent',\n      lineWidth: labelModel.get('borderWidth') || 0,\n      shadowBlur: labelModel.get('shadowBlur'),\n      shadowColor: labelModel.get('shadowColor'),\n      shadowOffsetX: labelModel.get('shadowOffsetX'),\n      shadowOffsetY: labelModel.get('shadowOffsetY')\n    },\n    // Lable should be over axisPointer.\n    z2: 10\n  };\n} // Do not overflow ec container\n\n\nfunction confineInContainer(position, width, height, api) {\n  var viewWidth = api.getWidth();\n  var viewHeight = api.getHeight();\n  position[0] = Math.min(position[0] + width, viewWidth) - width;\n  position[1] = Math.min(position[1] + height, viewHeight) - height;\n  position[0] = Math.max(position[0], 0);\n  position[1] = Math.max(position[1], 0);\n}\n/**\n * @param {number} value\n * @param {module:echarts/coord/Axis} axis\n * @param {module:echarts/model/Global} ecModel\n * @param {Object} opt\n * @param {Array.<Object>} seriesDataIndices\n * @param {number|string} opt.precision 'auto' or a number\n * @param {string|Function} opt.formatter label formatter\n */\n\n\nfunction getValueLabel(value, axis, ecModel, seriesDataIndices, opt) {\n  value = axis.scale.parse(value);\n  var text = axis.scale.getLabel( // If `precision` is set, width can be fixed (like '12.00500'), which\n  // helps to debounce when when moving label.\n  value, {\n    precision: opt.precision\n  });\n  var formatter = opt.formatter;\n\n  if (formatter) {\n    var params = {\n      value: axisHelper.getAxisRawValue(axis, value),\n      axisDimension: axis.dim,\n      axisIndex: axis.index,\n      seriesData: []\n    };\n    zrUtil.each(seriesDataIndices, function (idxItem) {\n      var series = ecModel.getSeriesByIndex(idxItem.seriesIndex);\n      var dataIndex = idxItem.dataIndexInside;\n      var dataParams = series && series.getDataParams(dataIndex);\n      dataParams && params.seriesData.push(dataParams);\n    });\n\n    if (zrUtil.isString(formatter)) {\n      text = formatter.replace('{value}', text);\n    } else if (zrUtil.isFunction(formatter)) {\n      text = formatter(params);\n    }\n  }\n\n  return text;\n}\n/**\n * @param {module:echarts/coord/Axis} axis\n * @param {number} value\n * @param {Object} layoutInfo {\n *  rotation, position, labelOffset, labelDirection, labelMargin\n * }\n */\n\n\nfunction getTransformedPosition(axis, value, layoutInfo) {\n  var transform = matrix.create();\n  matrix.rotate(transform, transform, layoutInfo.rotation);\n  matrix.translate(transform, transform, layoutInfo.position);\n  return graphic.applyTransform([axis.dataToCoord(value), (layoutInfo.labelOffset || 0) + (layoutInfo.labelDirection || 1) * (layoutInfo.labelMargin || 0)], transform);\n}\n\nfunction buildCartesianSingleLabelElOption(value, elOption, layoutInfo, axisModel, axisPointerModel, api) {\n  var textLayout = AxisBuilder.innerTextLayout(layoutInfo.rotation, 0, layoutInfo.labelDirection);\n  layoutInfo.labelMargin = axisPointerModel.get('label.margin');\n  buildLabelElOption(elOption, axisModel, axisPointerModel, api, {\n    position: getTransformedPosition(axisModel.axis, value, layoutInfo),\n    align: textLayout.textAlign,\n    verticalAlign: textLayout.textVerticalAlign\n  });\n}\n/**\n * @param {Array.<number>} p1\n * @param {Array.<number>} p2\n * @param {number} [xDimIndex=0] or 1\n */\n\n\nfunction makeLineShape(p1, p2, xDimIndex) {\n  xDimIndex = xDimIndex || 0;\n  return {\n    x1: p1[xDimIndex],\n    y1: p1[1 - xDimIndex],\n    x2: p2[xDimIndex],\n    y2: p2[1 - xDimIndex]\n  };\n}\n/**\n * @param {Array.<number>} xy\n * @param {Array.<number>} wh\n * @param {number} [xDimIndex=0] or 1\n */\n\n\nfunction makeRectShape(xy, wh, xDimIndex) {\n  xDimIndex = xDimIndex || 0;\n  return {\n    x: xy[xDimIndex],\n    y: xy[1 - xDimIndex],\n    width: wh[xDimIndex],\n    height: wh[1 - xDimIndex]\n  };\n}\n\nfunction makeSectorShape(cx, cy, r0, r, startAngle, endAngle) {\n  return {\n    cx: cx,\n    cy: cy,\n    r0: r0,\n    r: r,\n    startAngle: startAngle,\n    endAngle: endAngle,\n    clockwise: true\n  };\n}\n\nexports.buildElStyle = buildElStyle;\nexports.buildLabelElOption = buildLabelElOption;\nexports.getValueLabel = getValueLabel;\nexports.getTransformedPosition = getTransformedPosition;\nexports.buildCartesianSingleLabelElOption = buildCartesianSingleLabelElOption;\nexports.makeLineShape = makeLineShape;\nexports.makeRectShape = makeRectShape;\nexports.makeSectorShape = makeSectorShape;","\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n\nvar createDimensions = require(\"../../data/helper/createDimensions\");\n\nvar List = require(\"../../data/List\");\n\nvar _util = require(\"zrender/lib/core/util\");\n\nvar extend = _util.extend;\nvar isArray = _util.isArray;\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n\n/**\n * [Usage]:\n * (1)\n * createListSimply(seriesModel, ['value']);\n * (2)\n * createListSimply(seriesModel, {\n *     coordDimensions: ['value'],\n *     dimensionsCount: 5\n * });\n *\n * @param {module:echarts/model/Series} seriesModel\n * @param {Object|Array.<string|Object>} opt opt or coordDimensions\n *        The options in opt, see `echarts/data/helper/createDimensions`\n * @param {Array.<string>} [nameList]\n * @return {module:echarts/data/List}\n */\nfunction _default(seriesModel, opt, nameList) {\n  opt = isArray(opt) && {\n    coordDimensions: opt\n  } || extend({}, opt);\n  var source = seriesModel.getSource();\n  var dimensionsInfo = createDimensions(source, opt);\n  var list = new List(dimensionsInfo, seriesModel);\n  list.initData(source, nameList);\n  return list;\n}\n\nmodule.exports = _default;","\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n\n/**\n * LegendVisualProvider is an bridge that pick encoded color from data and\n * provide to the legend component.\n * @param {Function} getDataWithEncodedVisual Function to get data after filtered. It stores all the encoding info\n * @param {Function} getRawData Function to get raw data before filtered.\n */\nfunction LegendVisualProvider(getDataWithEncodedVisual, getRawData) {\n  this.getAllNames = function () {\n    var rawData = getRawData(); // We find the name from the raw data. In case it's filtered by the legend component.\n    // Normally, the name can be found in rawData, but can't be found in filtered data will display as gray.\n\n    return rawData.mapArray(rawData.getName);\n  };\n\n  this.containName = function (name) {\n    var rawData = getRawData();\n    return rawData.indexOfName(name) >= 0;\n  };\n\n  this.indexOfName = function (name) {\n    // Only get data when necessary.\n    // Because LegendVisualProvider constructor may be new in the stage that data is not prepared yet.\n    // Invoking Series#getData immediately will throw an error.\n    var dataWithEncodedVisual = getDataWithEncodedVisual();\n    return dataWithEncodedVisual.indexOfName(name);\n  };\n\n  this.getItemVisual = function (dataIndex, key) {\n    // Get encoded visual properties from final filtered data.\n    var dataWithEncodedVisual = getDataWithEncodedVisual();\n    return dataWithEncodedVisual.getItemVisual(dataIndex, key);\n  };\n}\n\nvar _default = LegendVisualProvider;\nmodule.exports = _default;","\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n\nvar _util = require(\"zrender/lib/core/util\");\n\nvar createHashMap = _util.createHashMap;\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n// Pick color from palette for each data item.\n// Applicable for charts that require applying color palette\n// in data level (like pie, funnel, chord).\nfunction _default(seriesType) {\n  return {\n    getTargetSeries: function (ecModel) {\n      // Pie and funnel may use diferrent scope\n      var paletteScope = {};\n      var seiresModelMap = createHashMap();\n      ecModel.eachSeriesByType(seriesType, function (seriesModel) {\n        seriesModel.__paletteScope = paletteScope;\n        seiresModelMap.set(seriesModel.uid, seriesModel);\n      });\n      return seiresModelMap;\n    },\n    reset: function (seriesModel, ecModel) {\n      var dataAll = seriesModel.getRawData();\n      var idxMap = {};\n      var data = seriesModel.getData();\n      data.each(function (idx) {\n        var rawIdx = data.getRawIndex(idx);\n        idxMap[rawIdx] = idx;\n      });\n      dataAll.each(function (rawIdx) {\n        var filteredIdx = idxMap[rawIdx]; // If series.itemStyle.normal.color is a function. itemVisual may be encoded\n\n        var singleDataColor = filteredIdx != null && data.getItemVisual(filteredIdx, 'color', true);\n        var singleDataBorderColor = filteredIdx != null && data.getItemVisual(filteredIdx, 'borderColor', true);\n        var itemModel;\n\n        if (!singleDataColor || !singleDataBorderColor) {\n          // FIXME Performance\n          itemModel = dataAll.getItemModel(rawIdx);\n        }\n\n        if (!singleDataColor) {\n          var color = itemModel.get('itemStyle.color') || seriesModel.getColorFromPalette(dataAll.getName(rawIdx) || rawIdx + '', seriesModel.__paletteScope, dataAll.count()); // Data is not filtered\n\n          if (filteredIdx != null) {\n            data.setItemVisual(filteredIdx, 'color', color);\n          }\n        }\n\n        if (!singleDataBorderColor) {\n          var borderColor = itemModel.get('itemStyle.borderColor'); // Data is not filtered\n\n          if (filteredIdx != null) {\n            data.setItemVisual(filteredIdx, 'borderColor', borderColor);\n          }\n        }\n      });\n    }\n  };\n}\n\nmodule.exports = _default;","\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\nfunction _default(seriesType) {\n  return {\n    seriesType: seriesType,\n    reset: function (seriesModel, ecModel) {\n      var legendModels = ecModel.findComponents({\n        mainType: 'legend'\n      });\n\n      if (!legendModels || !legendModels.length) {\n        return;\n      }\n\n      var data = seriesModel.getData();\n      data.filterSelf(function (idx) {\n        var name = data.getName(idx); // If in any legend component the status is not selected.\n\n        for (var i = 0; i < legendModels.length; i++) {\n          if (!legendModels[i].isSelected(name)) {\n            return false;\n          }\n        }\n\n        return true;\n      });\n    }\n  };\n}\n\nmodule.exports = _default;"],"sourceRoot":""}
(this["webpackJsonpreact-admin"]=this["webpackJsonpreact-admin"]||[]).push([[60],{1800:function(e,t,a){"use strict";a.r(t);a(54);var n=a(55),r=a.n(n),c=(a(76),a(78)),i=a.n(c),l=a(62),o=(a(86),a(87)),s=a.n(o),u=(a(349),a(351)),d=a.n(u),m=(a(197),a(198)),p=a.n(m),f=(a(447),a(393)),g=a.n(f),h=(a(57),a(59)),y=a.n(h),E=(a(398),a(307)),b=a.n(E),v=(a(69),a(70)),O=a.n(v),j=(a(58),a(60)),S=a.n(j),x=(a(51),a(50)),C=a.n(x),N=(a(72),a(66)),I=a.n(N),P=a(1777),k=(a(65),a(67)),w=a.n(k),T=a(53),A=(a(63),a(61)),F=a.n(A),z=a(0),D=a.n(z),R=a(73),U=a.n(R),L=a(71),B=a(1850),H=a(434),J=a(315),_=a(56),q=a(1286),M=F.a.Option,V=function(e){var t=e.changeSearch,a=(e.loading,e.onSuccess),n=e.editRecord,r=e.onEditRecordChange,c=e.onTypeChange,i=e.onSearch,l=w.a.useForm(),o=Object(T.a)(l,1)[0],u=w.a.useForm(),m=Object(T.a)(u,1)[0],f=Object(z.useState)(!1),h=Object(T.a)(f,2),E=h[0],v=h[1],j=Object(z.useState)([]),x=Object(T.a)(j,2),N=x[0],k=x[1],A=Object(z.useState)([]),R=Object(T.a)(A,2),U=R[0],L=R[1],V=Object(z.useState)(""),W=Object(T.a)(V,2),Z=W[0],G=W[1],K=Object(z.useState)(!1),Q=Object(T.a)(K,2),X=Q[0],Y=Q[1],$=Object(z.useState)(null),ee=Object(T.a)($,2),te=ee[0],ae=ee[1],ne=Object(z.useState)(""),re=Object(T.a)(ne,2),ce=re[0],ie=re[1];Object(z.useEffect)((function(){n&&le(n)}),[n]);var le=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;v(!0),e?(Y(!0),ae(e),m.setFieldsValue({pageName:e.sectionName,position:1===e.sectionType,url:e.url}),Array.isArray(e.products)&&L(e.products.map((function(e){return e.productId})))):(Y(!1),ae(null))},oe=function(){Z.trim()&&(L([].concat(Object(P.a)(U),[Z.trim()])),G(""),m.setFieldsValue({pid:""}))};return D.a.createElement(D.a.Fragment,null,D.a.createElement(w.a,{form:o,name:"advanced_search",className:"ant-advanced-search-form",onFinish:function(e){t(e)}},D.a.createElement(y.a,{justify:"space-between",align:"middle"},D.a.createElement(S.a,null,D.a.createElement(C.a,{type:"primary",icon:D.a.createElement(B.a,null),onClick:function(){return le()}},"Create Page")),D.a.createElement(S.a,null,D.a.createElement(b.a,null,D.a.createElement(O.a,{placeholder:"Search by name",style:{width:200,fontWeight:"normal",borderRadius:"5px",border:"1px solid #e5ecfc",color:"#333"},prefix:D.a.createElement(H.a,{style:{color:"#d9d9d9"}}),className:"custom-input",onBlur:function(e){var t=e.target.value;i(t)}}),D.a.createElement(F.a,{style:{width:200},placeholder:"All",value:ce,onChange:function(e){ie(e),c(e)}},D.a.createElement(M,{value:""},"All"),D.a.createElement(M,{value:"1"},"Home List"),D.a.createElement(M,{value:"2"},"Empty")))))),D.a.createElement(s.a,{title:X?"Edit Collection Page":"Create Collection Page",visible:E,onOk:function(){m.validateFields().then((function(e){if(U.length<10)I.a.error("PIDs\u6570\u91cf\u5fc5\u987b\u5927\u4e8e\u7b49\u4e8e10\u4e2a\uff01");else{var t={sectionName:e.pageName,sectionType:e.position?1:2,productIds:U,url:e.url||""};X?(t.id=te.id,Object(_.pc)(JSON.stringify(t)).then((function(e){I.a.success("Update successfully"),v(!1),m.resetFields(),L([]),G(""),Y(!1),ae(null),a()})).catch((function(e){I.a.error("Update failed")}))):Object(_.oc)(JSON.stringify(t)).then((function(e){I.a.success("Create successfully"),v(!1),m.resetFields(),L([]),G(""),Y(!1),ae(null),a()})).catch((function(e){I.a.error("Create failed")}))}}))},onCancel:function(){v(!1),m.resetFields(),k([]),L([]),G(""),Y(!1),ae(null),r(null)},width:600,okText:X?"Update":"Create",maskClosable:!0,afterClose:function(){r(null)}},D.a.createElement(w.a,{form:m,layout:"vertical"},D.a.createElement(w.a.Item,{name:"pageName",label:"Page Name",rules:[{required:!0,message:"Enter page name"}]},D.a.createElement(O.a,{placeholder:"Enter page name"})),D.a.createElement(w.a.Item,{name:"position",valuePropName:"checked"},D.a.createElement(g.a,null,"Homepage Featured")),D.a.createElement(w.a.Item,{name:"pid",label:"Add PIDs",rules:[{required:!1,message:"Enter PID"}]},D.a.createElement(O.a.Group,{compact:!0},D.a.createElement(O.a,{style:{width:"calc(100% - 80px)"},placeholder:"Enter PID",value:Z,onChange:function(e){return G(e.target.value)},onPressEnter:oe}),D.a.createElement(C.a,{type:"primary",onClick:oe,style:{width:"80px"}},"+ Add")),D.a.createElement("div",{style:{marginTop:"8px"}},D.a.createElement(p.a,{fileList:N,onChange:function(e){var t=e.file;if("application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"===t.type||"application/vnd.ms-excel"===t.type)if(t.size/1024/1024<5){k([t]);var a=new FileReader;a.onload=function(e){try{var t=new Uint8Array(e.target.result),a=q.a(t,{type:"array"});if(0===a.SheetNames.length)return void I.a.error("Excel\u6587\u4ef6\u4e3a\u7a7a\uff01");var n=a.SheetNames[0],r=a.Sheets[n];if(!r||!r["!ref"])return void I.a.error("\u5de5\u4f5c\u8868\u4e3a\u7a7a\uff01");var c=q.b.sheet_to_json(r);if(0===c.length)return void I.a.error("\u672a\u627e\u5230\u6570\u636e\uff01");var i=c.map((function(e){var t=e.pid||e.PID||e.Pid||e.pid||e.PID||e.Pid;return t?String(t).trim():null})).filter((function(e){return null!==e}));if(0===i.length)return void I.a.error("\u672a\u627e\u5230pid\u5217\u6570\u636e\uff01\u8bf7\u786e\u4fddExcel\u6587\u4ef6\u4e2d\u5305\u542bpid\u5217\u3002");var l=Object(P.a)(new Set(i));L((function(e){var t=Object(P.a)(e);return l.forEach((function(e){t.includes(e)||t.push(e)})),t})),I.a.success("\u6210\u529f\u5bfc\u5165 ".concat(l.length," \u4e2aPID"))}catch(o){console.error("Excel\u8bfb\u53d6\u9519\u8bef:",o),I.a.error("\u6587\u4ef6\u8bfb\u53d6\u5931\u8d25\uff01\u8bf7\u786e\u4fdd\u6587\u4ef6\u683c\u5f0f\u6b63\u786e\u3002")}},a.onerror=function(){I.a.error("\u6587\u4ef6\u8bfb\u53d6\u5931\u8d25\uff01\u8bf7\u91cd\u8bd5\u3002")};try{a.readAsArrayBuffer(t)}catch(n){console.error("\u6587\u4ef6\u8bfb\u53d6\u9519\u8bef:",n),I.a.error("\u6587\u4ef6\u8bfb\u53d6\u5931\u8d25\uff01\u8bf7\u91cd\u8bd5\u3002")}}else I.a.error("\u6587\u4ef6\u5927\u5c0f\u4e0d\u80fd\u8d85\u8fc75MB\uff01");else I.a.error("\u53ea\u80fd\u4e0a\u4f20Excel\u6587\u4ef6\uff01")},beforeUpload:function(){return!1},accept:".xlsx,.xls",style:{marginBottom:"8px"}},D.a.createElement(C.a,{icon:D.a.createElement(J.a,null)},"Batch Upload PIDs")),D.a.createElement("div",{style:{padding:"8px",border:"1px solid #d9d9d9",borderRadius:"4px",marginTop:"10px",minHeight:"40px",display:"flex",flexWrap:"wrap",gap:"8px",alignItems:"flex-start"}},U.length>0?U.map((function(e,t){return D.a.createElement(d.a,{key:"".concat(e,"-").concat(t),closable:!0,onClose:function(){return t=e,void L((function(e){return e.filter((function(e,a){return e!==t}))}));var t},style:{margin:0}},e)})):D.a.createElement("span",{style:{color:"#999"}},"No PIDs added yet")))))))},W=function(){var e=Object(z.useState)([]),t=Object(T.a)(e,2),a=t[0],n=t[1],c=Object(z.useState)(!1),o=Object(T.a)(c,2),s=o[0],u=o[1],d=Object(z.useState)(null),m=Object(T.a)(d,2),p=m[0],f=m[1],g=Object(z.useState)({search:{}}),h=Object(T.a)(g,2),E=h[0],v=h[1],O=Object(z.useState)({current:1,pageSize:20,total:0}),j=Object(T.a)(O,2),x=j[0],N=j[1];Object(z.useEffect)((function(){I(1,20)}),[]);var I=function(e,t,a,r){u(!0),Object(_.zb)({page:e,pageSize:t,sectionType:a,sectionName:r}).then((function(e){n(null===e||void 0===e?void 0:e.records),N({current:e.current,pageSize:e.size,total:e.total})})).finally((function(){u(!1)}))},P=function(e){f(e)};return D.a.createElement(r.a,{className:"animated fadeIn"},D.a.createElement("style",null,"\n          .custom-input .ant-input {\n            border: none !important;\n          }\n        "),D.a.createElement("div",{className:"web-bread-c"},D.a.createElement(L.a,{arr:["Products Collection"]}),D.a.createElement("h3",null,"Product Collection Management"),D.a.createElement("img",{src:U.a,className:"aset"})),D.a.createElement("div",{className:"base-wr"},D.a.createElement("div",{className:"base-style"},D.a.createElement(V,{changeSearch:function(e){v(Object(l.a)(Object(l.a)({},E),{},{search:Object(l.a)({},e)})),I(1,x.pageSize)},loading:s,onSuccess:function(){return I(1,x.pageSize)},editRecord:p,onEditRecordChange:f,onTypeChange:function(e){I(1,20,e)},onSearch:function(e){return I(1,20,E.search.sectionType,e)}})),D.a.createElement(y.a,null,D.a.createElement(S.a,{span:24},D.a.createElement("div",{className:"base-style"},D.a.createElement(i.a,{columns:[{title:"Page Name",dataIndex:"sectionName",key:"sectionName",align:"center",render:function(e){return e||"-"}},{title:"Product Count",dataIndex:"products",key:"products",align:"center",render:function(e,t){return Array.isArray(t.products)?t.products.length:"0"}},{title:"Position",dataIndex:"sectionType",key:"sectionType",align:"center",render:function(e){return 1===e?"Homepage Featured":"-"}},{title:"URL",dataIndex:"id",key:"id",align:"center",render:function(e,t){return 2===t.sectionType&&e?D.a.createElement("a",{href:"https://anystarr.com/hotsale/".concat(e),target:"_blank",rel:"noopener noreferrer"},"https://anystarr.com/hotsale/".concat(e)):"-"}},{title:"Created At",dataIndex:"createTime",key:"createTime",align:"center",render:function(e){return e?new Date(e).toLocaleString("zh-CN",{timeZone:"Asia/Shanghai",year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1}):"-"}},{title:"Last Updated",dataIndex:"updateTime",key:"updateTime",align:"center",render:function(e){return e?new Date(e).toLocaleString("zh-CN",{timeZone:"Asia/Shanghai",year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1}):"-"}},{title:"Action",dataIndex:"action",key:"action",align:"center",render:function(e,t){return D.a.createElement(b.a,null,D.a.createElement(C.a,{type:"link",onClick:function(){return P(t)}},"Edit"))}}],rowKey:function(e){return e.id||e.sectionId},dataSource:a,onChange:function(e){I(e.current,e.pageSize,E.search.sectionType)},bordered:!0,loading:s,pagination:x,scroll:{scrollToFirstRowOnChange:!0,x:1e3}}))))))};t.default=W}}]);
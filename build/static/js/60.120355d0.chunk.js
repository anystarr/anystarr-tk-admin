(this["webpackJsonpreact-admin"]=this["webpackJsonpreact-admin"]||[]).push([[60],{1964:function(e,t,a){"use strict";a.r(t);a(58);var n=a(59),r=a.n(n),l=(a(83),a(84)),c=a.n(l),o=a(68),i=(a(94),a(95)),s=a.n(i),d=(a(410),a(419)),m=a.n(d),u=(a(220),a(221)),p=a.n(u),g=(a(529),a(460)),h=a.n(g),y=(a(63),a(66)),E=a.n(y),f=(a(530),a(455)),b=a.n(f),S=(a(74),a(75)),v=a.n(S),x=(a(64),a(67)),C=a.n(x),N=(a(56),a(55)),O=a.n(N),I=(a(77),a(70)),j=a.n(I),P=(a(69),a(72)),k=a.n(P),w=(a(62),a(65)),T=a.n(w),A=a(0),F=a.n(A),z=a(78),D=a.n(z),R=a(76),U=a(2014),L=a(516),B=a(372),H=a(60),J=a(1469);const{Option:_}=T.a,q=e=>{let{changeSearch:t,loading:a,onSuccess:n,editRecord:r,onEditRecordChange:l,onTypeChange:c,onSearch:o}=e;const[i]=k.a.useForm(),[d]=k.a.useForm(),[u,g]=Object(A.useState)(!1),[y,f]=Object(A.useState)([]),[S,x]=Object(A.useState)([]),[N,I]=Object(A.useState)(""),[P,w]=Object(A.useState)(!1),[z,D]=Object(A.useState)(null),[R,q]=Object(A.useState)("");Object(A.useEffect)(()=>{r&&M(r)},[r]);const M=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;g(!0),e?(w(!0),D(e),d.setFieldsValue({pageName:e.sectionName,position:1===e.sectionType,url:e.url}),Array.isArray(e.products)&&x(e.products.map(e=>e.productId))):(w(!1),D(null))},V=()=>{N.trim()&&(x([...S,N.trim()]),I(""),d.setFieldsValue({pid:""}))};return F.a.createElement(F.a.Fragment,null,F.a.createElement(k.a,{form:i,name:"advanced_search",className:"ant-advanced-search-form",onFinish:e=>{t(e)}},F.a.createElement(E.a,{justify:"space-between",align:"middle"},F.a.createElement(C.a,null,F.a.createElement(O.a,{type:"primary",icon:F.a.createElement(U.a,null),onClick:()=>M()},"Create Page")),F.a.createElement(C.a,null,F.a.createElement(b.a,null,F.a.createElement(v.a,{placeholder:"Search by name",style:{width:200,fontWeight:"normal",borderRadius:"5px",border:"1px solid #e5ecfc",color:"#333"},prefix:F.a.createElement(L.a,{style:{color:"#d9d9d9"}}),className:"custom-input",onBlur:e=>{const t=e.target.value;o(t)}}),F.a.createElement(T.a,{style:{width:200},placeholder:"All",value:R,onChange:e=>{q(e),c(e)}},F.a.createElement(_,{value:""},"All"),F.a.createElement(_,{value:"1"},"Home List"),F.a.createElement(_,{value:"2"},"Empty")))))),F.a.createElement(s.a,{title:P?"Edit Collection Page":"Create Collection Page",visible:u,onOk:()=>{d.validateFields().then(e=>{if(1===e.position&&S.length<10)return void j.a.error("PIDs\u6570\u91cf\u5fc5\u987b\u5927\u4e8e\u7b49\u4e8e10\u4e2a\uff01");const t={sectionName:e.pageName,sectionType:e.position?1:2,productIds:S,url:e.url||""};P?(t.id=z.id,Object(H.pc)(JSON.stringify(t)).then(e=>{j.a.success("Update successfully"),g(!1),d.resetFields(),x([]),I(""),w(!1),D(null),n()}).catch(e=>{j.a.error("Update failed")})):Object(H.oc)(JSON.stringify(t)).then(e=>{j.a.success("Create successfully"),g(!1),d.resetFields(),x([]),I(""),w(!1),D(null),n()}).catch(e=>{j.a.error("Create failed")})})},onCancel:()=>{g(!1),d.resetFields(),f([]),x([]),I(""),w(!1),D(null),l(null)},width:600,okText:P?"Update":"Create",maskClosable:!0,afterClose:()=>{l(null)}},F.a.createElement(k.a,{form:d,layout:"vertical"},F.a.createElement(k.a.Item,{name:"pageName",label:"Page Name",rules:[{required:!0,message:"Enter page name"}]},F.a.createElement(v.a,{placeholder:"Enter page name"})),F.a.createElement(k.a.Item,{name:"position",valuePropName:"checked"},F.a.createElement(h.a,null,"Homepage Featured")),F.a.createElement(k.a.Item,{name:"pid",label:"Add PIDs",rules:[{required:!1,message:"Enter PID"}]},F.a.createElement(v.a.Group,{compact:!0},F.a.createElement(v.a,{style:{width:"calc(100% - 80px)"},placeholder:"Enter PID",value:N,onChange:e=>I(e.target.value),onPressEnter:V}),F.a.createElement(O.a,{type:"primary",onClick:V,style:{width:"80px"}},"+ Add")),F.a.createElement("div",{style:{marginTop:"8px"}},F.a.createElement(p.a,{fileList:y,onChange:e=>{const{file:t}=e;if(!("application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"===t.type||"application/vnd.ms-excel"===t.type))return void j.a.error("\u53ea\u80fd\u4e0a\u4f20Excel\u6587\u4ef6\uff01");if(!(t.size/1024/1024<5))return void j.a.error("\u6587\u4ef6\u5927\u5c0f\u4e0d\u80fd\u8d85\u8fc75MB\uff01");f([t]);const a=new FileReader;a.onload=e=>{try{const t=new Uint8Array(e.target.result),a=J.a(t,{type:"array"});if(0===a.SheetNames.length)return void j.a.error("Excel\u6587\u4ef6\u4e3a\u7a7a\uff01");const n=a.SheetNames[0],r=a.Sheets[n];if(!r||!r["!ref"])return void j.a.error("\u5de5\u4f5c\u8868\u4e3a\u7a7a\uff01");const l=J.b.sheet_to_json(r);if(0===l.length)return void j.a.error("\u672a\u627e\u5230\u6570\u636e\uff01");const c=l.map(e=>{const t=e.pid||e.PID||e.Pid||e.pid||e.PID||e.Pid;return t?String(t).trim():null}).filter(e=>null!==e);if(0===c.length)return void j.a.error("\u672a\u627e\u5230pid\u5217\u6570\u636e\uff01\u8bf7\u786e\u4fddExcel\u6587\u4ef6\u4e2d\u5305\u542bpid\u5217\u3002");const o=[...new Set(c)];x(e=>{const t=[...e];return o.forEach(e=>{t.includes(e)||t.push(e)}),t}),j.a.success("\u6210\u529f\u5bfc\u5165 ".concat(o.length," \u4e2aPID"))}catch(t){console.error("Excel\u8bfb\u53d6\u9519\u8bef:",t),j.a.error("\u6587\u4ef6\u8bfb\u53d6\u5931\u8d25\uff01\u8bf7\u786e\u4fdd\u6587\u4ef6\u683c\u5f0f\u6b63\u786e\u3002")}},a.onerror=()=>{j.a.error("\u6587\u4ef6\u8bfb\u53d6\u5931\u8d25\uff01\u8bf7\u91cd\u8bd5\u3002")};try{a.readAsArrayBuffer(t)}catch(n){console.error("\u6587\u4ef6\u8bfb\u53d6\u9519\u8bef:",n),j.a.error("\u6587\u4ef6\u8bfb\u53d6\u5931\u8d25\uff01\u8bf7\u91cd\u8bd5\u3002")}},beforeUpload:()=>!1,accept:".xlsx,.xls",style:{marginBottom:"8px"}},F.a.createElement(O.a,{icon:F.a.createElement(B.a,null)},"Batch Upload PIDs")),F.a.createElement("div",{style:{padding:"8px",border:"1px solid #d9d9d9",borderRadius:"4px",marginTop:"10px",minHeight:"40px",display:"flex",flexWrap:"wrap",gap:"8px",alignItems:"flex-start"}},S.length>0?S.map((e,t)=>F.a.createElement(m.a,{key:"".concat(e,"-").concat(t),closable:!0,onClose:()=>{return t=e,void x(e=>e.filter((e,a)=>e!==t));var t},style:{margin:0}},e)):F.a.createElement("span",{style:{color:"#999"}},"No PIDs added yet")))))))};var M=()=>{const[e,t]=Object(A.useState)([]),[a,n]=Object(A.useState)(!1),[l,i]=Object(A.useState)(null),[s,d]=Object(A.useState)({search:{}}),[m,u]=Object(A.useState)({current:1,pageSize:20,total:0});Object(A.useEffect)(()=>{p(1,20)},[]);const p=(e,a,r,l)=>{n(!0),Object(H.zb)({page:e,pageSize:a,sectionType:r,sectionName:l}).then(e=>{t(null===e||void 0===e?void 0:e.records),u({current:e.current,pageSize:e.size,total:e.total})}).finally(()=>{n(!1)})},g=e=>{i(e)};return F.a.createElement(r.a,{className:"animated fadeIn"},F.a.createElement("style",null,"\n          .custom-input .ant-input {\n            border: none !important;\n          }\n        "),F.a.createElement("div",{className:"web-bread-c"},F.a.createElement(R.a,{arr:["Products Collection"]}),F.a.createElement("h3",null,"Product Collection Management"),F.a.createElement("img",{src:D.a,className:"aset"})),F.a.createElement("div",{className:"base-wr"},F.a.createElement("div",{className:"base-style"},F.a.createElement(q,{changeSearch:e=>{d(Object(o.a)(Object(o.a)({},s),{},{search:Object(o.a)({},e)})),p(1,m.pageSize)},loading:a,onSuccess:()=>p(1,m.pageSize),editRecord:l,onEditRecordChange:i,onTypeChange:e=>{p(1,20,e)},onSearch:e=>p(1,20,s.search.sectionType,e)})),F.a.createElement(E.a,null,F.a.createElement(C.a,{span:24},F.a.createElement("div",{className:"base-style"},F.a.createElement(c.a,{columns:[{title:"Page Name",dataIndex:"sectionName",key:"sectionName",align:"center",render:e=>e||"-"},{title:"Product Count",dataIndex:"products",key:"products",align:"center",render:(e,t)=>Array.isArray(t.products)?t.products.length:"0"},{title:"Position",dataIndex:"sectionType",key:"sectionType",align:"center",render:e=>1===e?"Homepage Featured":"-"},{title:"URL",dataIndex:"id",key:"id",align:"center",render:(e,t)=>2===t.sectionType&&e?F.a.createElement("a",{href:"https://anystarr.com/hotsale/".concat(e),target:"_blank",rel:"noopener noreferrer"},"https://anystarr.com/hotsale/".concat(e)):"-"},{title:"Created At",dataIndex:"createTime",key:"createTime",align:"center",render:e=>e?new Date(e).toLocaleString("zh-CN",{timeZone:"Asia/Shanghai",year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1}):"-"},{title:"Last Updated",dataIndex:"updateTime",key:"updateTime",align:"center",render:e=>e?new Date(e).toLocaleString("zh-CN",{timeZone:"Asia/Shanghai",year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1}):"-"},{title:"Action",dataIndex:"action",key:"action",align:"center",render:(e,t)=>F.a.createElement(b.a,null,F.a.createElement(O.a,{type:"link",onClick:()=>g(t)},"Edit"))}],rowKey:e=>e.id||e.sectionId,dataSource:e,onChange:e=>{p(e.current,e.pageSize,s.search.sectionType)},bordered:!0,loading:a,pagination:m,scroll:{scrollToFirstRowOnChange:!0,x:1e3}}))))))};t.default=M}}]);